[
  {
    "path": "posts/2021-12-22-fuel-efficiency-analysis/",
    "title": "Fuel Efficiency Statistical Analysis",
    "description": "This is an Inferential Statistics project where concepts including Hypothesis Testing and Confidence intervals are used to analyse Cars data to test which fuel type is more efficient.",
    "author": [
      {
        "name": "Blaise Appolinary",
        "url": "https://ca.linkedin.com/in/blaise-appolinary-038a42179"
      },
      {
        "name": "Zibo Shang",
        "url": {}
      }
    ],
    "date": "2021-12-22",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nPreliminary Results\r\nImporting data from Kaggle\r\nTidying up data\r\nObtaining sample statistics\r\nData Visualisation\r\n\r\nMethods\r\nNeed for further investigation\r\nAssumptions and Hypotheses\r\nExpectations and Further Studies\r\n\r\nHypothesis Testing\r\nHypothesis Testing for City MPG, Bootstrap Sampling Method (5% Significance Level)\r\nHypothesis Testing for City MPG, Asymptotic Method (5% Significance Level)\r\nHypothesis Testing for Highway MPG, Asymptotic Method (5% Significance Level)\r\n\r\nConfidence Intervals\r\n90% Confidence Interval for City MPG\r\n90% Confidence Interval for Highway MPG\r\n\r\nResults\r\nReferences\r\n\r\nIntroduction\r\nAs human civilization expands, metropolitan cities are growing rapidly. As a result, the bigger commuting zone has resulted in the rising demands for a form of transport that is cost-efficient, yet provides a sense of privacy for the passenger; the car.\r\nGiven that, choosing the right car could be a difficult decision to make, as the car types range from family vehicles like sedans and coupes to the high-end, exotic, sport vehicles. In all car types, however, a critical factor to consider is the fuel efficiency. A more efficient car would allow customers to save money on fuel as well as reduce carbon footprints.\r\nAccording to a research conducted by the Universal Technical Institute, they found that diesel cars have 20% more thermal efficiency than gasoline cars. This would suggest that diesel-based cars are more efficient gasoline-based cars, as the former are able to transfer heat to energy more efficiently. (Baures, 2019; Chevrolet, 2021; Gas vs. Diesel Engines: What’s the Difference?, 2021). As a follow up to this reserach paper, we have decided to investigate this claim by taking a different measure of fuel efficiency, MPG.\r\nMPG (miles per gallon), is defined as the distance (measured in miles) that a vehicle can travel per gallon of fuel. If a car has a high MPG value, it would suggest that the car is more fuel-efficient.\r\nFor this project, we will be comparing the means as well as the standard deviations of MPG between diesel-based cars and gasoline-based cars, which would allow us to determine which fuel type is more efficient. Our results will be based on a dataset of Vehicle Fuel Economy Estimates, from 1984-2017, obtained from Kaggle.\r\n\r\nPreliminary Results\r\nImporting data from Kaggle\r\n\r\n\r\ndf <- read.csv(\"https://raw.githubusercontent.com/Zibo-S/STAT201_GP_7/main/database.csv\", header = TRUE) \r\n     \r\nhead(df) %>% paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Vehicle.ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Year\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Make\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Model\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Class\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Drive\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Transmission\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Transmission.Descriptor\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Engine.Index\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Engine.Descriptor\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Engine.Cylinders\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Engine.Displacement\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Turbocharger\"],\"name\":[13],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"Supercharger\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Fuel.Type\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Fuel.Type.1\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Fuel.Type.2\"],\"name\":[17],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"City.MPG..FT1.\"],\"name\":[18],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Unrounded.City.MPG..FT1.\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"City.MPG..FT2.\"],\"name\":[20],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Unrounded.City.MPG..FT2.\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"City.Gasoline.Consumption..CD.\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"City.Electricity.Consumption\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"City.Utility.Factor\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.MPG..FT1.\"],\"name\":[25],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Unrounded.Highway.MPG..FT1.\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.MPG..FT2.\"],\"name\":[27],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Unrounded.Highway.MPG..FT2.\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.Gasoline.Consumption..CD.\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.Electricity.Consumption\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.Utility.Factor\"],\"name\":[31],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Unadjusted.City.MPG..FT1.\"],\"name\":[32],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Unadjusted.Highway.MPG..FT1.\"],\"name\":[33],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Unadjusted.City.MPG..FT2.\"],\"name\":[34],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Unadjusted.Highway.MPG..FT2.\"],\"name\":[35],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Combined.MPG..FT1.\"],\"name\":[36],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Unrounded.Combined.MPG..FT1.\"],\"name\":[37],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Combined.MPG..FT2.\"],\"name\":[38],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Unrounded.Combined.MPG..FT2.\"],\"name\":[39],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Combined.Electricity.Consumption\"],\"name\":[40],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Combined.Gasoline.Consumption..CD.\"],\"name\":[41],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Combined.Utility.Factor\"],\"name\":[42],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Annual.Fuel.Cost..FT1.\"],\"name\":[43],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Annual.Fuel.Cost..FT2.\"],\"name\":[44],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Gas.Guzzler.Tax\"],\"name\":[45],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Save.or.Spend..5.Year.\"],\"name\":[46],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Annual.Consumption.in.Barrels..FT1.\"],\"name\":[47],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Annual.Consumption.in.Barrels..FT2.\"],\"name\":[48],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Tailpipe.CO2..FT1.\"],\"name\":[49],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Tailpipe.CO2.in.Grams.Mile..FT1.\"],\"name\":[50],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Tailpipe.CO2..FT2.\"],\"name\":[51],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Tailpipe.CO2.in.Grams.Mile..FT2.\"],\"name\":[52],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fuel.Economy.Score\"],\"name\":[53],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"GHG.Score\"],\"name\":[54],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"GHG.Score..Alt.Fuel.\"],\"name\":[55],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"My.MPG.Data\"],\"name\":[56],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"X2D.Passenger.Volume\"],\"name\":[57],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"X2D.Luggage.Volume\"],\"name\":[58],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"X4D.Passenger.Volume\"],\"name\":[59],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"X4D.Luggage.Volume\"],\"name\":[60],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Hatchback.Passenger.Volume\"],\"name\":[61],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Hatchback.Luggage.Volume\"],\"name\":[62],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Start.Stop.Technology\"],\"name\":[63],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Alternative.Fuel.Technology\"],\"name\":[64],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Electric.Motor\"],\"name\":[65],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Manufacturer.Code\"],\"name\":[66],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Gasoline.Electricity.Blended..CD.\"],\"name\":[67],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Vehicle.Charger\"],\"name\":[68],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Alternate.Charger\"],\"name\":[69],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Hours.to.Charge..120V.\"],\"name\":[70],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Hours.to.Charge..240V.\"],\"name\":[71],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Hours.to.Charge..AC.240V.\"],\"name\":[72],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Composite.City.MPG\"],\"name\":[73],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Composite.Highway.MPG\"],\"name\":[74],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Composite.Combined.MPG\"],\"name\":[75],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Range..FT1.\"],\"name\":[76],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"City.Range..FT1.\"],\"name\":[77],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.Range..FT1.\"],\"name\":[78],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Range..FT2.\"],\"name\":[79],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"City.Range..FT2.\"],\"name\":[80],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Highway.Range..FT2.\"],\"name\":[81],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"26587\",\"2\":\"1984\",\"3\":\"Alfa Romeo\",\"4\":\"GT V6 2.5\",\"5\":\"Minicompact Cars\",\"6\":\"\",\"7\":\"Manual 5-Speed\",\"8\":\"\",\"9\":\"9001\",\"10\":\"(FFS)\",\"11\":\"6\",\"12\":\"2.5\",\"13\":\"NA\",\"14\":\"\",\"15\":\"Regular\",\"16\":\"Regular Gasoline\",\"17\":\"\",\"18\":\"17\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"24\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"21\",\"33\":\"34\",\"34\":\"0\",\"35\":\"0\",\"36\":\"20\",\"37\":\"0\",\"38\":\"0\",\"39\":\"0\",\"40\":\"0\",\"41\":\"0\",\"42\":\"0\",\"43\":\"1750\",\"44\":\"0\",\"45\":\"\",\"46\":\"-2000\",\"47\":\"16.48050\",\"48\":\"0\",\"49\":\"-1\",\"50\":\"444.3500\",\"51\":\"-1\",\"52\":\"0\",\"53\":\"-1\",\"54\":\"-1\",\"55\":\"-1\",\"56\":\"N\",\"57\":\"74\",\"58\":\"7\",\"59\":\"0\",\"60\":\"0\",\"61\":\"0\",\"62\":\"0\",\"63\":\"\",\"64\":\"\",\"65\":\"\",\"66\":\"\",\"67\":\"False\",\"68\":\"\",\"69\":\"\",\"70\":\"0\",\"71\":\"0\",\"72\":\"0\",\"73\":\"0\",\"74\":\"0\",\"75\":\"0\",\"76\":\"0\",\"77\":\"0\",\"78\":\"0\",\"79\":\"\",\"80\":\"0\",\"81\":\"0\",\"_rn_\":\"1\"},{\"1\":\"27705\",\"2\":\"1984\",\"3\":\"Alfa Romeo\",\"4\":\"GT V6 2.5\",\"5\":\"Minicompact Cars\",\"6\":\"\",\"7\":\"Manual 5-Speed\",\"8\":\"\",\"9\":\"9005\",\"10\":\"(FFS) CA model\",\"11\":\"6\",\"12\":\"2.5\",\"13\":\"NA\",\"14\":\"\",\"15\":\"Regular\",\"16\":\"Regular Gasoline\",\"17\":\"\",\"18\":\"17\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"24\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"21\",\"33\":\"34\",\"34\":\"0\",\"35\":\"0\",\"36\":\"20\",\"37\":\"0\",\"38\":\"0\",\"39\":\"0\",\"40\":\"0\",\"41\":\"0\",\"42\":\"0\",\"43\":\"1750\",\"44\":\"0\",\"45\":\"\",\"46\":\"-2000\",\"47\":\"16.48050\",\"48\":\"0\",\"49\":\"-1\",\"50\":\"444.3500\",\"51\":\"-1\",\"52\":\"0\",\"53\":\"-1\",\"54\":\"-1\",\"55\":\"-1\",\"56\":\"N\",\"57\":\"74\",\"58\":\"7\",\"59\":\"0\",\"60\":\"0\",\"61\":\"0\",\"62\":\"0\",\"63\":\"\",\"64\":\"\",\"65\":\"\",\"66\":\"\",\"67\":\"False\",\"68\":\"\",\"69\":\"\",\"70\":\"0\",\"71\":\"0\",\"72\":\"0\",\"73\":\"0\",\"74\":\"0\",\"75\":\"0\",\"76\":\"0\",\"77\":\"0\",\"78\":\"0\",\"79\":\"\",\"80\":\"0\",\"81\":\"0\",\"_rn_\":\"2\"},{\"1\":\"26561\",\"2\":\"1984\",\"3\":\"Alfa Romeo\",\"4\":\"Spider Veloce 2000\",\"5\":\"Two Seaters\",\"6\":\"\",\"7\":\"Manual 5-Speed\",\"8\":\"\",\"9\":\"9002\",\"10\":\"(FFS)\",\"11\":\"4\",\"12\":\"2.0\",\"13\":\"NA\",\"14\":\"\",\"15\":\"Regular\",\"16\":\"Regular Gasoline\",\"17\":\"\",\"18\":\"18\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"25\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"23\",\"33\":\"35\",\"34\":\"0\",\"35\":\"0\",\"36\":\"21\",\"37\":\"0\",\"38\":\"0\",\"39\":\"0\",\"40\":\"0\",\"41\":\"0\",\"42\":\"0\",\"43\":\"1650\",\"44\":\"0\",\"45\":\"\",\"46\":\"-1500\",\"47\":\"15.69571\",\"48\":\"0\",\"49\":\"-1\",\"50\":\"423.1905\",\"51\":\"-1\",\"52\":\"0\",\"53\":\"-1\",\"54\":\"-1\",\"55\":\"-1\",\"56\":\"N\",\"57\":\"0\",\"58\":\"0\",\"59\":\"0\",\"60\":\"0\",\"61\":\"0\",\"62\":\"0\",\"63\":\"\",\"64\":\"\",\"65\":\"\",\"66\":\"\",\"67\":\"False\",\"68\":\"\",\"69\":\"\",\"70\":\"0\",\"71\":\"0\",\"72\":\"0\",\"73\":\"0\",\"74\":\"0\",\"75\":\"0\",\"76\":\"0\",\"77\":\"0\",\"78\":\"0\",\"79\":\"\",\"80\":\"0\",\"81\":\"0\",\"_rn_\":\"3\"},{\"1\":\"27681\",\"2\":\"1984\",\"3\":\"Alfa Romeo\",\"4\":\"Spider Veloce 2000\",\"5\":\"Two Seaters\",\"6\":\"\",\"7\":\"Manual 5-Speed\",\"8\":\"\",\"9\":\"9006\",\"10\":\"(FFS) CA model\",\"11\":\"4\",\"12\":\"2.0\",\"13\":\"NA\",\"14\":\"\",\"15\":\"Regular\",\"16\":\"Regular Gasoline\",\"17\":\"\",\"18\":\"18\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"25\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"23\",\"33\":\"35\",\"34\":\"0\",\"35\":\"0\",\"36\":\"21\",\"37\":\"0\",\"38\":\"0\",\"39\":\"0\",\"40\":\"0\",\"41\":\"0\",\"42\":\"0\",\"43\":\"1650\",\"44\":\"0\",\"45\":\"\",\"46\":\"-1500\",\"47\":\"15.69571\",\"48\":\"0\",\"49\":\"-1\",\"50\":\"423.1905\",\"51\":\"-1\",\"52\":\"0\",\"53\":\"-1\",\"54\":\"-1\",\"55\":\"-1\",\"56\":\"N\",\"57\":\"0\",\"58\":\"0\",\"59\":\"0\",\"60\":\"0\",\"61\":\"0\",\"62\":\"0\",\"63\":\"\",\"64\":\"\",\"65\":\"\",\"66\":\"\",\"67\":\"False\",\"68\":\"\",\"69\":\"\",\"70\":\"0\",\"71\":\"0\",\"72\":\"0\",\"73\":\"0\",\"74\":\"0\",\"75\":\"0\",\"76\":\"0\",\"77\":\"0\",\"78\":\"0\",\"79\":\"\",\"80\":\"0\",\"81\":\"0\",\"_rn_\":\"4\"},{\"1\":\"27550\",\"2\":\"1984\",\"3\":\"AM General\",\"4\":\"DJ Po Vehicle 2WD\",\"5\":\"Special Purpose Vehicle 2WD\",\"6\":\"2-Wheel Drive\",\"7\":\"Automatic 3-Speed\",\"8\":\"\",\"9\":\"1830\",\"10\":\"(FFS)\",\"11\":\"4\",\"12\":\"2.5\",\"13\":\"NA\",\"14\":\"\",\"15\":\"Regular\",\"16\":\"Regular Gasoline\",\"17\":\"\",\"18\":\"18\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"17\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"22\",\"33\":\"24\",\"34\":\"0\",\"35\":\"0\",\"36\":\"17\",\"37\":\"0\",\"38\":\"0\",\"39\":\"0\",\"40\":\"0\",\"41\":\"0\",\"42\":\"0\",\"43\":\"2050\",\"44\":\"0\",\"45\":\"\",\"46\":\"-3500\",\"47\":\"19.38882\",\"48\":\"0\",\"49\":\"-1\",\"50\":\"522.7647\",\"51\":\"-1\",\"52\":\"0\",\"53\":\"-1\",\"54\":\"-1\",\"55\":\"-1\",\"56\":\"N\",\"57\":\"0\",\"58\":\"0\",\"59\":\"0\",\"60\":\"0\",\"61\":\"0\",\"62\":\"0\",\"63\":\"\",\"64\":\"\",\"65\":\"\",\"66\":\"\",\"67\":\"False\",\"68\":\"\",\"69\":\"\",\"70\":\"0\",\"71\":\"0\",\"72\":\"0\",\"73\":\"0\",\"74\":\"0\",\"75\":\"0\",\"76\":\"0\",\"77\":\"0\",\"78\":\"0\",\"79\":\"\",\"80\":\"0\",\"81\":\"0\",\"_rn_\":\"5\"},{\"1\":\"28426\",\"2\":\"1984\",\"3\":\"AM General\",\"4\":\"DJ Po Vehicle 2WD\",\"5\":\"Special Purpose Vehicle 2WD\",\"6\":\"2-Wheel Drive\",\"7\":\"Automatic 3-Speed\",\"8\":\"\",\"9\":\"1880\",\"10\":\"(FFS) CA model\",\"11\":\"4\",\"12\":\"2.5\",\"13\":\"NA\",\"14\":\"\",\"15\":\"Regular\",\"16\":\"Regular Gasoline\",\"17\":\"\",\"18\":\"18\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"17\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"22\",\"33\":\"24\",\"34\":\"0\",\"35\":\"0\",\"36\":\"17\",\"37\":\"0\",\"38\":\"0\",\"39\":\"0\",\"40\":\"0\",\"41\":\"0\",\"42\":\"0\",\"43\":\"2050\",\"44\":\"0\",\"45\":\"\",\"46\":\"-3500\",\"47\":\"19.38882\",\"48\":\"0\",\"49\":\"-1\",\"50\":\"522.7647\",\"51\":\"-1\",\"52\":\"0\",\"53\":\"-1\",\"54\":\"-1\",\"55\":\"-1\",\"56\":\"N\",\"57\":\"0\",\"58\":\"0\",\"59\":\"0\",\"60\":\"0\",\"61\":\"0\",\"62\":\"0\",\"63\":\"\",\"64\":\"\",\"65\":\"\",\"66\":\"\",\"67\":\"False\",\"68\":\"\",\"69\":\"\",\"70\":\"0\",\"71\":\"0\",\"72\":\"0\",\"73\":\"0\",\"74\":\"0\",\"75\":\"0\",\"76\":\"0\",\"77\":\"0\",\"78\":\"0\",\"79\":\"\",\"80\":\"0\",\"81\":\"0\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nTidying up data\r\n\r\n\r\ntable(df %>% select('Fuel.Type'))\r\n\r\n\r\n\r\n                        CNG                      Diesel \r\n                         60                        1014 \r\n                Electricity             Gasoline or E85 \r\n                        133                        1223 \r\n    Gasoline or natural gas         Gasoline or propane \r\n                         20                           8 \r\n                   Midgrade                     Premium \r\n                         77                       10133 \r\n    Premium and Electricity  Premium Gas or Electricity \r\n                         25                          18 \r\n             Premium or E85                     Regular \r\n                        122                       25258 \r\nRegular Gas and Electricity  Regular Gas or Electricity \r\n                         20                           2 \r\n\r\nThe dataset that we obtained contains a plethora of different Fuel Types. However, for the purpose of the project, we will only be focusing on two categories of Fuel Types, which are “Diesel” and “Gasoline or E85”. There are a several categories of Fuel Types that are marked as “Gasoline” cars, but we have specifically chosen the “Gasoline or E85” tag as the number of examples in that category are similar in number to the diesel tags (Diesel - 1014 Examples, Gasoline or E85 - 1223). Hence, we will filter the dataset for only the examples that have one of the two Fuel Types.\r\nThe factors that we are interested in are: - MPG in the City (mean, interquartile): - MPG in the Highway (mean, interquartile);\r\nThe dataset that we are working with has two different types of MPG, City and Highway, which represents the MPG when driving on the corresponding terrains. We have decided to explore them both. The chosen factors have corresponding columns in the dataset, called City.MPG..FT1 (MPG in the city) in the unit miles and Highway.MPG..FT1 (MPG on the highway) in the unit miles. Hence, we will select only these columns as well as the Fuel.Types column before we move on with the rest of the investigation. We will also rename the columns for simplicity.\r\n\r\n\r\ntidy_data <- df %>%\r\n       filter(Fuel.Type == \"Diesel\" | Fuel.Type == \"Gasoline or E85\") %>%\r\n       select('Fuel.Type','City.MPG..FT1.', 'Highway.MPG..FT1.') %>%\r\n       rename(Fuel_Type = Fuel.Type, City_MPG = City.MPG..FT1., Highway_MPG = Highway.MPG..FT1.)\r\nhead(tidy_data) %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=F)\r\n\r\n\r\n\r\nFuel_Type\r\n\r\n\r\nCity_MPG\r\n\r\n\r\nHighway_MPG\r\n\r\n\r\nDiesel\r\n\r\n\r\n21\r\n\r\n\r\n31\r\n\r\n\r\nDiesel\r\n\r\n\r\n21\r\n\r\n\r\n29\r\n\r\n\r\nDiesel\r\n\r\n\r\n21\r\n\r\n\r\n31\r\n\r\n\r\nDiesel\r\n\r\n\r\n21\r\n\r\n\r\n31\r\n\r\n\r\nDiesel\r\n\r\n\r\n21\r\n\r\n\r\n29\r\n\r\n\r\nDiesel\r\n\r\n\r\n21\r\n\r\n\r\n31\r\n\r\n\r\nObtaining sample statistics\r\nTo start our analysis, we will calculate the Mean and IQR for each factor that we are interested in.\r\n\r\n\r\nfiltered_data <- tidy_data %>% filter(Fuel_Type == \"Diesel\") %>% select(Fuel_Type, City_MPG)\r\n\r\n#City_MPG_Mean\r\ndiesel_mean <- mean(as.numeric(as.vector(filtered_data$City_MPG)))\r\npaste(\"Mean of Diesel in City: \",diesel_mean)\r\n\r\n\r\n[1] \"Mean of Diesel in City:  21.2258382642998\"\r\n\r\ndiesel_IQR <- IQR(as.numeric(as.vector(filtered_data$City_MPG)))\r\npaste(\"IQR of Diesel in City: \",diesel_IQR)\r\n\r\n\r\n[1] \"IQR of Diesel in City:  10\"\r\n\r\n\r\n\r\nfiltered_data2 <- tidy_data %>% filter(Fuel_Type == \"Gasoline or E85\") %>% select(Fuel_Type, City_MPG)\r\n\r\ngasoline_mean <- mean(as.numeric(as.vector(filtered_data2$City_MPG)))\r\npaste(\"Mean of Gasoline in City: \",gasoline_mean)\r\n\r\n\r\n[1] \"Mean of Gasoline in City:  15.4096484055601\"\r\n\r\ngasoline_IQR <- IQR(as.numeric(as.vector(filtered_data2$City_MPG)))\r\npaste(\"IQR of Gasoline in City: \",gasoline_IQR)\r\n\r\n\r\n[1] \"IQR of Gasoline in City:  4\"\r\n\r\n\r\n\r\nfiltered_data3 <- tidy_data %>% filter(Fuel_Type == \"Diesel\") %>% select(Fuel_Type, Highway_MPG)\r\n\r\n#City_MPG_Mean\r\ndiesel_H_mean <- mean(as.numeric(as.vector(filtered_data3$Highway_MPG)))\r\n\r\npaste(\"Mean of Diesel on Highway: \",diesel_H_mean)\r\n\r\n\r\n[1] \"Mean of Diesel on Highway:  27.1341222879684\"\r\n\r\ndiesel_H_IQR <- IQR(as.numeric(as.vector(filtered_data3$Highway_MPG)))\r\npaste(\"IQR of Diesel on Highway: \",diesel_H_IQR)\r\n\r\n\r\n[1] \"IQR of Diesel on Highway:  12\"\r\n\r\n\r\n\r\nfiltered_data4 <- tidy_data %>% filter(Fuel_Type == \"Gasoline or E85\") %>% select(Fuel_Type, Highway_MPG)\r\n\r\ngasoline_H_mean <- mean(as.numeric(as.vector(filtered_data4$Highway_MPG)))\r\n\r\npaste(\"Mean of Gasoline on Highway: \",gasoline_H_mean)\r\n\r\n\r\n[1] \"Mean of Gasoline on Highway:  21.6116107931316\"\r\n\r\ngasoline_H_IQR <- IQR(as.numeric(as.vector(filtered_data4$Highway_MPG)))\r\n\r\npaste(\"IQR of Gasoline on Highway: \",gasoline_H_IQR)\r\n\r\n\r\n[1] \"IQR of Gasoline on Highway:  7\"\r\n\r\nSummary of means\r\n\r\n\r\nsummary_means <- tibble(\"Diesel in City\"=diesel_mean , \r\n                              \"Diesel on Highway\"=diesel_H_mean, \r\n                              \"Gasoline in City\"= gasoline_mean, \r\n                              \"Gasoline on Highway\"=gasoline_H_mean\r\n                             )\r\n\r\nsummary_means\r\n\r\n\r\n# A tibble: 1 x 4\r\n  `Diesel in City` `Diesel on Highw~ `Gasoline in Ci~ `Gasoline on Hi~\r\n             <dbl>             <dbl>            <dbl>            <dbl>\r\n1             21.2              27.1             15.4             21.6\r\n\r\nFrom our calculations, we discovered that the diesel cars outperform better than gasoline cars in terms of efficiency for both the city and the highway MPG. However, we will discuss further why we can’t draw a conclusion from here.\r\nSummary of Inter-Quartile Range\r\n\r\n\r\nsummary_IQR <- tibble(\"Diesel in City\"=diesel_IQR , \r\n                             \"Diesel on Highway\"=diesel_H_IQR, \r\n                              \"Gasoline in City\"= gasoline_IQR, \r\n                              \"Gasoline on Highway\"=gasoline_H_IQR\r\n                             )\r\n\r\nsummary_IQR\r\n\r\n\r\n# A tibble: 1 x 4\r\n  `Diesel in City` `Diesel on Highw~ `Gasoline in Ci~ `Gasoline on Hi~\r\n             <dbl>             <dbl>            <dbl>            <dbl>\r\n1               10                12                4                7\r\n\r\nAs we can see from the table, diesel has a higher IQR range for both the city and highway MPG values. This result suggests that, although the MPG of diesel cars are better on average, the MPG may vary a lot from diesel car to car. Additionally, as the difference in their means is smaller than the difference in IQR values, it also suggests that some gasoline cars might actually be more efficient than diesel cars.\r\nData Visualisation\r\n\r\n\r\noptions(repr.plot.width=10, repr.plot.height=10)\r\n\r\nCity_Histogram <- tidy_data %>%\r\n     select(Fuel_Type, City_MPG) %>%\r\n     ggplot() +\r\n     geom_histogram(aes(x= City_MPG ,fill = Fuel_Type),position=\"dodge\", stat=\"count\",color=\"darkblue\")+\r\n     geom_vline(aes(xintercept = diesel_mean), color = \"pink\", linetype = 2, lwd = 1)+\r\n    annotate(\"text\", x = diesel_mean+3, y = 200, label = \"mean_Diesel\", color=\"red\", size=5, angle=45)+\r\n     geom_vline(aes(xintercept = gasoline_mean), color = \"darkblue\", linetype = 2, lwd = 1)+\r\n    annotate(\"text\", x = gasoline_mean-3, y = 200, label = \"mean_Gasoline\", color=\"blue\", size=5, angle=45)+\r\n     ggtitle(\"Distribution of MPG For Diesel And Gasoline or E85 in City\") +\r\n     xlab(\"MPG\") +\r\n     ylab(\"Count\") + \r\n    theme(text = element_text(size = 15)) +\r\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))+\r\n    guides(fill=guide_legend(title=\"Fuel Type\"))\r\n    \r\nCity_Histogram\r\n\r\n\r\n\r\n\r\nFigure 1: Histogram of the Distribution of MPG For Diesel And Gasoline or E85 In City\r\n\r\n\r\n\r\n\r\n\r\nHighway_Histogram <- tidy_data %>%\r\n     select(Fuel_Type, Highway_MPG) %>%\r\n     ggplot() +\r\n     geom_histogram(aes(x= Highway_MPG ,fill = Fuel_Type),position=\"dodge\", stat=\"count\",color=\"darkblue\")+\r\n     ggtitle(\"Distribution of MPG For Diesel And Gasoline or E85 On Highway \") + \r\n     xlab(\"MPG\") +\r\n     ylab(\"Count\") + \r\n    theme(text = element_text(size = 15)) +\r\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))+\r\n    geom_vline(aes(xintercept = diesel_H_mean), color = \"pink\", linetype = 2, lwd = 1)+\r\n    annotate(\"text\", x = diesel_H_mean+3, y = 150, label = \"mean_Diesel\", color=\"red\", size=5,angle=45)+\r\n\r\n     geom_vline(aes(xintercept = gasoline_H_mean), color = \"darkblue\", linetype = 2, lwd = 1)+\r\n    annotate(\"text\", x = gasoline_H_mean-3, y = 150, label = \"mean_Gasoline\", color=\"blue\", size=5,angle=45)+\r\nguides(fill=guide_legend(title=\"Fuel Type\"))\r\nHighway_Histogram\r\n\r\n\r\n\r\n\r\nFrom these histograms, we can see that the distribution of MPG for the diesel and gasoline fuel types are not uniformly distributed; they are unimodal but the distribution is skewed to the right. This is logical as there will be more cars that are less efficient for both fuel types (car manufacturers might focus on lowering the price of the car instead of focusing on efficiency). However, the distribution for the diesel fuel type is much more spread out for both the cases of Highway MPG and City MPG. This observation is captured by the difference in their IQR values. \r\nDiesel: (City: 10, Highway: 12) \r\nMethods\r\nNeed for further investigation\r\nBack when we compared the means of the dataset, we found that the mean of diesel (City: 21, Highway: 27) is higher than the mean of gasoline (City: 15, Highway: 21) in both the city and highway MPG. This would suggest that diesel-based cars are more efficient than gasoline-based cars due to a higher MPG. ​ However, the dataset that we are working with is only a sample of all the diesel and gasoline cars available. Hence, drawing a conclusion here isn’t justified. To explore the dataset further, we will be performing two sample z-test hypothesis tests using bootstrap sampling and asymptotic theory in order to get a more robust conclusion. We will also create confidence intervals to quantify the difference\r\nAssumptions and Hypotheses\r\nAn assumption for our hypothesis tests are that the dataset was sampled randomly and each example was independent to one another. This is a fair assumption, as the cars are from different car manufacturers and were produced in different years. As discussed before, our dataset is asymmetrically distributed, which means we would need to have a huge sample size to work with, to have the law of big numbers kick in and utilize a Normal Distribution rather than a t-Distribution. This isn’t a problem either, as our dataset has more than 1000 examples for both the diesel and gasoline fuel types. Hence, the approach that we will be taking is justified.\r\nWe will be performing 2 two sample z-tests; the first for the difference in City MPG and the second for the difference in Highway MPG. In each case, we will test be testing the following null and alternative hypotheses:\r\n\\(H_0\\): The difference in mean City MPG between Diesel and Gasoline are the same, \\(\\mu_{Diesel, City} - \\mu_{Gasoline, City} = 0\\). \\(\\mu_{Diesel, City} = \\mu_{Gasoline, City}\\). \\(H_A\\): The difference in mean City MPG between Diesel and Gasoline are different, \\(\\mu_{Diesel, City} - \\mu_{Gasoline, City} \\neq 0\\) \\(\\mu_{Diesel, City} \\neq \\mu_{Gasoline, City}\\). \r\n\\(H_0\\): The difference in mean Highway MPG between Diesel and Gasoline are the same, \\(\\mu_{Diesel, Highway} - \\mu_{Gasoline, Highway} = 0\\). \\(\\mu_{Diesel, Highway} = \\mu_{Gasoline, Highway}\\). \\(H_A\\): The difference in mean Highway MPG between Diesel and Gasoline are different, \\(\\mu_{Diesel, Highway} -\\mu_{Gasoline, Highway} \\neq 0\\). \\(\\mu_{Diesel, Highway} \\neq \\mu_{Gasoline, Highway}\\). \r\nExpectations and Further Studies\r\nWe expect to find a relation between the factors we have chosen for fuel type and fuel efficiency. From the plot visualization above, we expect diesel fuel has better efficiency on both city roads and highways.\r\nKnowing these factors can help a vehicle customer decide the type of car to save money on fuel spending. The report also gives the customer an option to compare the results with their driving habits, whether they drive more city roads or highways (if a car is more efficient on a highway than in the city and vice versa). This result could lead to future questions regarding the generality of the studies as we are only comparing cars from a specific time range and a selected number of gasoline and diesel cars brands. The project can be repeated with a dataset based on more recent cars and a wider variety of car brands.\r\nHypothesis Testing\r\nHypothesis Testing for City MPG, Bootstrap Sampling Method (5% Significance Level)\r\nThe first method of hypothesis test that we will perform is a null hypothesis simulation by using bootstrap sampling. The bootstrap sample size is 1000, and we calculate the difference in means of the samples. First, we calculate the observed difference in means between Diesel and Gasoline fuel efficiency and store it in the variable obs_diff_means.\r\n\r\n\r\nobs_diff_means <- tidy_data %>% \r\n    select(-Highway_MPG) %>%\r\n    specify(City_MPG~Fuel_Type) %>% \r\n    calculate(stat = \"diff in means\",order= c( \"Diesel\", \"Gasoline or E85\"))%>%\r\n    as.numeric()\r\ncat(\"The observed difference in means is \",obs_diff_means)\r\n\r\n\r\nThe observed difference in means is  5.81619\r\n\r\nTo create the null model, we will obtain bootstrap samples of diesel and gasoline fuel types separately, and calculate the difference in means of each sample. AS our \\(H_0\\) states that the difference in means is 0, we will recenter the null distribution to 0.\r\n\r\n\r\ndiesel_data <- tidy_data %>% filter(Fuel_Type == \"Diesel\")\r\ngasoline_data <- tidy_data %>% filter(Fuel_Type == \"Gasoline or E85\")\r\nsamp_diesel <- diesel_data %>% \r\n                specify(response = City_MPG) %>%\r\n                generate(type = \"bootstrap\", reps = 1000) %>%\r\n                calculate(stat = \"mean\")\r\nsamp_gasoline <- gasoline_data %>% \r\n                specify(response = City_MPG) %>%\r\n                generate(type = \"bootstrap\", reps = 1000) %>%\r\n                calculate(stat = \"mean\")\r\nnull_model_manual <- samp_diesel %>% inner_join(samp_gasoline, by = \"replicate\")\r\nnull_model_manual <- null_model_manual %>% mutate(diff = stat.x - stat.y) %>% select(replicate, diff)\r\nnull_model_manual <- null_model_manual %>% mutate(diff = diff + (0 - obs_diff_means))\r\n\r\nnull_model_manual %>% rmarkdown::paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"replicate\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"diff\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"-0.0859552528\"},{\"1\":\"2\",\"2\":\"0.1266754400\"},{\"1\":\"3\",\"2\":\"-0.1411748199\"},{\"1\":\"4\",\"2\":\"0.0473751776\"},{\"1\":\"5\",\"2\":\"0.0717856792\"},{\"1\":\"6\",\"2\":\"0.0483976576\"},{\"1\":\"7\",\"2\":\"0.2676696325\"},{\"1\":\"8\",\"2\":\"0.0083709506\"},{\"1\":\"9\",\"2\":\"0.3380651259\"},{\"1\":\"10\",\"2\":\"-0.1586763238\"},{\"1\":\"11\",\"2\":\"0.0975395969\"},{\"1\":\"12\",\"2\":\"0.0329628859\"},{\"1\":\"13\",\"2\":\"-0.0428546546\"},{\"1\":\"14\",\"2\":\"0.0753304917\"},{\"1\":\"15\",\"2\":\"-0.1422110083\"},{\"1\":\"16\",\"2\":\"0.2405311735\"},{\"1\":\"17\",\"2\":\"0.1289292505\"},{\"1\":\"18\",\"2\":\"0.0414749517\"},{\"1\":\"19\",\"2\":\"0.2620403476\"},{\"1\":\"20\",\"2\":\"0.1698494180\"},{\"1\":\"21\",\"2\":\"-0.1419061996\"},{\"1\":\"22\",\"2\":\"0.2263011220\"},{\"1\":\"23\",\"2\":\"0.0413951208\"},{\"1\":\"24\",\"2\":\"-0.1731700591\"},{\"1\":\"25\",\"2\":\"0.2787612832\"},{\"1\":\"26\",\"2\":\"0.2684566518\"},{\"1\":\"27\",\"2\":\"0.3585743983\"},{\"1\":\"28\",\"2\":\"0.1830884381\"},{\"1\":\"29\",\"2\":\"0.1764802173\"},{\"1\":\"30\",\"2\":\"0.2364186749\"},{\"1\":\"31\",\"2\":\"0.3638803279\"},{\"1\":\"32\",\"2\":\"-0.1067701404\"},{\"1\":\"33\",\"2\":\"-0.0990063881\"},{\"1\":\"34\",\"2\":\"-0.2946153685\"},{\"1\":\"35\",\"2\":\"-0.1718726061\"},{\"1\":\"36\",\"2\":\"0.1572780743\"},{\"1\":\"37\",\"2\":\"-0.0426675763\"},{\"1\":\"38\",\"2\":\"-0.1806169070\"},{\"1\":\"39\",\"2\":\"0.0170459035\"},{\"1\":\"40\",\"2\":\"-0.0094248792\"},{\"1\":\"41\",\"2\":\"0.0827958862\"},{\"1\":\"42\",\"2\":\"-0.0158161858\"},{\"1\":\"43\",\"2\":\"-0.0436731225\"},{\"1\":\"44\",\"2\":\"-0.1097545242\"},{\"1\":\"45\",\"2\":\"-0.0085451270\"},{\"1\":\"46\",\"2\":\"-0.2169810712\"},{\"1\":\"47\",\"2\":\"0.0215527182\"},{\"1\":\"48\",\"2\":\"0.0704817752\"},{\"1\":\"49\",\"2\":\"0.0548962118\"},{\"1\":\"50\",\"2\":\"0.0154734776\"},{\"1\":\"51\",\"2\":\"-0.2302515398\"},{\"1\":\"52\",\"2\":\"-0.1134686749\"},{\"1\":\"53\",\"2\":\"0.2284847781\"},{\"1\":\"54\",\"2\":\"0.1357447090\"},{\"1\":\"55\",\"2\":\"0.1014150221\"},{\"1\":\"56\",\"2\":\"-0.1599503920\"},{\"1\":\"57\",\"2\":\"0.3349186612\"},{\"1\":\"58\",\"2\":\"-0.2424358249\"},{\"1\":\"59\",\"2\":\"-0.1290171451\"},{\"1\":\"60\",\"2\":\"-0.2357808345\"},{\"1\":\"61\",\"2\":\"0.4222907101\"},{\"1\":\"62\",\"2\":\"0.2191784357\"},{\"1\":\"63\",\"2\":\"-0.3016993489\"},{\"1\":\"64\",\"2\":\"0.5459390286\"},{\"1\":\"65\",\"2\":\"-0.0292116421\"},{\"1\":\"66\",\"2\":\"-0.1992295919\"},{\"1\":\"67\",\"2\":\"0.0123649125\"},{\"1\":\"68\",\"2\":\"-0.0675659330\"},{\"1\":\"69\",\"2\":\"-0.3690298213\"},{\"1\":\"70\",\"2\":\"-0.2445380374\"},{\"1\":\"71\",\"2\":\"0.1893620144\"},{\"1\":\"72\",\"2\":\"-0.3758702773\"},{\"1\":\"73\",\"2\":\"0.1336045970\"},{\"1\":\"74\",\"2\":\"0.1367188067\"},{\"1\":\"75\",\"2\":\"-0.2492061265\"},{\"1\":\"76\",\"2\":\"-0.0415265595\"},{\"1\":\"77\",\"2\":\"0.1398144699\"},{\"1\":\"78\",\"2\":\"0.1425295253\"},{\"1\":\"79\",\"2\":\"0.2612170415\"},{\"1\":\"80\",\"2\":\"-0.2158884368\"},{\"1\":\"81\",\"2\":\"0.7657149861\"},{\"1\":\"82\",\"2\":\"0.1485031311\"},{\"1\":\"83\",\"2\":\"0.1887749754\"},{\"1\":\"84\",\"2\":\"0.3049079042\"},{\"1\":\"85\",\"2\":\"0.0049995081\"},{\"1\":\"86\",\"2\":\"0.1334417098\"},{\"1\":\"87\",\"2\":\"0.1387540903\"},{\"1\":\"88\",\"2\":\"0.1979256880\"},{\"1\":\"89\",\"2\":\"-0.4615070130\"},{\"1\":\"90\",\"2\":\"0.0816161636\"},{\"1\":\"91\",\"2\":\"-0.1028761686\"},{\"1\":\"92\",\"2\":\"0.1530405879\"},{\"1\":\"93\",\"2\":\"0.2128556707\"},{\"1\":\"94\",\"2\":\"-0.0210914733\"},{\"1\":\"95\",\"2\":\"0.2339455312\"},{\"1\":\"96\",\"2\":\"-0.2269808938\"},{\"1\":\"97\",\"2\":\"0.2334213892\"},{\"1\":\"98\",\"2\":\"0.0946003700\"},{\"1\":\"99\",\"2\":\"0.0272634467\"},{\"1\":\"100\",\"2\":\"0.3973544538\"},{\"1\":\"101\",\"2\":\"-0.2364993122\"},{\"1\":\"102\",\"2\":\"-0.1778639521\"},{\"1\":\"103\",\"2\":\"0.0724291642\"},{\"1\":\"104\",\"2\":\"0.1085748015\"},{\"1\":\"105\",\"2\":\"0.4048198484\"},{\"1\":\"106\",\"2\":\"-0.0464704279\"},{\"1\":\"107\",\"2\":\"-0.0648823261\"},{\"1\":\"108\",\"2\":\"0.1975192763\"},{\"1\":\"109\",\"2\":\"-0.1334288078\"},{\"1\":\"110\",\"2\":\"-0.1721959614\"},{\"1\":\"111\",\"2\":\"0.3015816186\"},{\"1\":\"112\",\"2\":\"-0.0589837129\"},{\"1\":\"113\",\"2\":\"0.0986580353\"},{\"1\":\"114\",\"2\":\"0.0226888967\"},{\"1\":\"115\",\"2\":\"-0.2414859183\"},{\"1\":\"116\",\"2\":\"-0.4428072399\"},{\"1\":\"117\",\"2\":\"-0.0697520083\"},{\"1\":\"118\",\"2\":\"-0.1264698151\"},{\"1\":\"119\",\"2\":\"0.2897295589\"},{\"1\":\"120\",\"2\":\"0.2945476332\"},{\"1\":\"121\",\"2\":\"-0.0131204833\"},{\"1\":\"122\",\"2\":\"0.3034782062\"},{\"1\":\"123\",\"2\":\"0.4088823519\"},{\"1\":\"124\",\"2\":\"-0.2922502786\"},{\"1\":\"125\",\"2\":\"-0.0173579696\"},{\"1\":\"126\",\"2\":\"-0.4280449827\"},{\"1\":\"127\",\"2\":\"-0.0292737327\"},{\"1\":\"128\",\"2\":\"-0.3502348962\"},{\"1\":\"129\",\"2\":\"-0.0050188610\"},{\"1\":\"130\",\"2\":\"0.2508664470\"},{\"1\":\"131\",\"2\":\"0.1223000640\"},{\"1\":\"132\",\"2\":\"-0.2598679807\"},{\"1\":\"133\",\"2\":\"0.1142613388\"},{\"1\":\"134\",\"2\":\"-0.0854496574\"},{\"1\":\"135\",\"2\":\"0.1825078500\"},{\"1\":\"136\",\"2\":\"-0.1149983631\"},{\"1\":\"137\",\"2\":\"0.3438500406\"},{\"1\":\"138\",\"2\":\"0.4547463879\"},{\"1\":\"139\",\"2\":\"-0.0703196944\"},{\"1\":\"140\",\"2\":\"-0.4654453352\"},{\"1\":\"141\",\"2\":\"-0.2014019588\"},{\"1\":\"142\",\"2\":\"-0.1207211871\"},{\"1\":\"143\",\"2\":\"-0.1927818392\"},{\"1\":\"144\",\"2\":\"0.3026798976\"},{\"1\":\"145\",\"2\":\"-0.2670769489\"},{\"1\":\"146\",\"2\":\"-0.2542128920\"},{\"1\":\"147\",\"2\":\"0.2785371117\"},{\"1\":\"148\",\"2\":\"-0.0606069403\"},{\"1\":\"149\",\"2\":\"-0.0244798496\"},{\"1\":\"150\",\"2\":\"0.3220852465\"},{\"1\":\"151\",\"2\":\"-0.1605366246\"},{\"1\":\"152\",\"2\":\"-0.0008176615\"},{\"1\":\"153\",\"2\":\"-0.0857867210\"},{\"1\":\"154\",\"2\":\"0.0786140396\"},{\"1\":\"155\",\"2\":\"0.6338344131\"},{\"1\":\"156\",\"2\":\"0.0339232753\"},{\"1\":\"157\",\"2\":\"0.4151623792\"},{\"1\":\"158\",\"2\":\"-0.4916040519\"},{\"1\":\"159\",\"2\":\"-0.1487095624\"},{\"1\":\"160\",\"2\":\"0.2639506436\"},{\"1\":\"161\",\"2\":\"-0.1243224457\"},{\"1\":\"162\",\"2\":\"-0.0888452910\"},{\"1\":\"163\",\"2\":\"0.0676409257\"},{\"1\":\"164\",\"2\":\"-0.2440703415\"},{\"1\":\"165\",\"2\":\"-0.0524811269\"},{\"1\":\"166\",\"2\":\"0.0580918652\"},{\"1\":\"167\",\"2\":\"0.1969007888\"},{\"1\":\"168\",\"2\":\"-0.0662757374\"},{\"1\":\"169\",\"2\":\"-0.1195850086\"},{\"1\":\"170\",\"2\":\"-0.0500345934\"},{\"1\":\"171\",\"2\":\"0.0908362242\"},{\"1\":\"172\",\"2\":\"0.2370234541\"},{\"1\":\"173\",\"2\":\"0.0775963978\"},{\"1\":\"174\",\"2\":\"-0.2359622682\"},{\"1\":\"175\",\"2\":\"-0.3099017677\"},{\"1\":\"176\",\"2\":\"0.0101369059\"},{\"1\":\"177\",\"2\":\"-0.1336037906\"},{\"1\":\"178\",\"2\":\"-0.1210268022\"},{\"1\":\"179\",\"2\":\"0.0043568294\"},{\"1\":\"180\",\"2\":\"-0.3683169882\"},{\"1\":\"181\",\"2\":\"-0.2864814913\"},{\"1\":\"182\",\"2\":\"-0.0743136562\"},{\"1\":\"183\",\"2\":\"0.0751490579\"},{\"1\":\"184\",\"2\":\"-0.1320990999\"},{\"1\":\"185\",\"2\":\"0.0501700639\"},{\"1\":\"186\",\"2\":\"0.3300868785\"},{\"1\":\"187\",\"2\":\"0.0170273570\"},{\"1\":\"188\",\"2\":\"0.2431776874\"},{\"1\":\"189\",\"2\":\"-0.0353279758\"},{\"1\":\"190\",\"2\":\"-0.2847340826\"},{\"1\":\"191\",\"2\":\"-0.2108961860\"},{\"1\":\"192\",\"2\":\"-0.0031327563\"},{\"1\":\"193\",\"2\":\"0.0512199606\"},{\"1\":\"194\",\"2\":\"0.1423424470\"},{\"1\":\"195\",\"2\":\"0.0101425505\"},{\"1\":\"196\",\"2\":\"-0.1315136737\"},{\"1\":\"197\",\"2\":\"-0.3887714273\"},{\"1\":\"198\",\"2\":\"-0.0681473274\"},{\"1\":\"199\",\"2\":\"0.0878220046\"},{\"1\":\"200\",\"2\":\"0.0339684321\"},{\"1\":\"201\",\"2\":\"-0.2985165976\"},{\"1\":\"202\",\"2\":\"0.3847710145\"},{\"1\":\"203\",\"2\":\"0.4154881536\"},{\"1\":\"204\",\"2\":\"-0.0521384186\"},{\"1\":\"205\",\"2\":\"-0.0015909725\"},{\"1\":\"206\",\"2\":\"-0.3397294782\"},{\"1\":\"207\",\"2\":\"0.4323082729\"},{\"1\":\"208\",\"2\":\"-0.3516339521\"},{\"1\":\"209\",\"2\":\"0.2190969921\"},{\"1\":\"210\",\"2\":\"-0.1228000148\"},{\"1\":\"211\",\"2\":\"0.3019178758\"},{\"1\":\"212\",\"2\":\"-0.2523969416\"},{\"1\":\"213\",\"2\":\"0.3237391160\"},{\"1\":\"214\",\"2\":\"-0.4674491703\"},{\"1\":\"215\",\"2\":\"0.0110473002\"},{\"1\":\"216\",\"2\":\"-0.0627978538\"},{\"1\":\"217\",\"2\":\"-0.1494578759\"},{\"1\":\"218\",\"2\":\"-0.0401589521\"},{\"1\":\"219\",\"2\":\"-0.0883324383\"},{\"1\":\"220\",\"2\":\"0.4780602231\"},{\"1\":\"221\",\"2\":\"-0.0471058493\"},{\"1\":\"222\",\"2\":\"0.1781139275\"},{\"1\":\"223\",\"2\":\"-0.5014159897\"},{\"1\":\"224\",\"2\":\"-0.2882482530\"},{\"1\":\"225\",\"2\":\"0.2058571657\"},{\"1\":\"226\",\"2\":\"-0.0616495796\"},{\"1\":\"227\",\"2\":\"0.0127084271\"},{\"1\":\"228\",\"2\":\"-0.2730118488\"},{\"1\":\"229\",\"2\":\"0.0712744391\"},{\"1\":\"230\",\"2\":\"-0.1726394661\"},{\"1\":\"231\",\"2\":\"-0.1091045881\"},{\"1\":\"232\",\"2\":\"0.1726951058\"},{\"1\":\"233\",\"2\":\"-0.1652869637\"},{\"1\":\"234\",\"2\":\"-0.1314935143\"},{\"1\":\"235\",\"2\":\"0.0105102562\"},{\"1\":\"236\",\"2\":\"-0.0123342703\"},{\"1\":\"237\",\"2\":\"-0.2633821511\"},{\"1\":\"238\",\"2\":\"0.2833672816\"},{\"1\":\"239\",\"2\":\"0.0739773990\"},{\"1\":\"240\",\"2\":\"-0.4377625750\"},{\"1\":\"241\",\"2\":\"-0.4214480511\"},{\"1\":\"242\",\"2\":\"-0.0024900776\"},{\"1\":\"243\",\"2\":\"-0.2291718073\"},{\"1\":\"244\",\"2\":\"-0.1299089928\"},{\"1\":\"245\",\"2\":\"-0.1061524592\"},{\"1\":\"246\",\"2\":\"0.1451389460\"},{\"1\":\"247\",\"2\":\"0.2851525898\"},{\"1\":\"248\",\"2\":\"0.1477483667\"},{\"1\":\"249\",\"2\":\"0.0078830954\"},{\"1\":\"250\",\"2\":\"0.0897992294\"},{\"1\":\"251\",\"2\":\"0.4150986758\"},{\"1\":\"252\",\"2\":\"-0.0530552639\"},{\"1\":\"253\",\"2\":\"-0.2264623964\"},{\"1\":\"254\",\"2\":\"0.7099406349\"},{\"1\":\"255\",\"2\":\"0.3113121128\"},{\"1\":\"256\",\"2\":\"0.3035910983\"},{\"1\":\"257\",\"2\":\"-0.0941060638\"},{\"1\":\"258\",\"2\":\"-0.0680473373\"},{\"1\":\"259\",\"2\":\"0.0047317925\"},{\"1\":\"260\",\"2\":\"-0.1766471363\"},{\"1\":\"261\",\"2\":\"-0.4287376565\"},{\"1\":\"262\",\"2\":\"0.1286284737\"},{\"1\":\"263\",\"2\":\"-0.0102110921\"},{\"1\":\"264\",\"2\":\"0.0793704168\"},{\"1\":\"265\",\"2\":\"-0.0133204636\"},{\"1\":\"266\",\"2\":\"0.1689067689\"},{\"1\":\"267\",\"2\":\"-0.1750110070\"},{\"1\":\"268\",\"2\":\"0.1338844081\"},{\"1\":\"269\",\"2\":\"-0.0759473665\"},{\"1\":\"270\",\"2\":\"-0.3529943022\"},{\"1\":\"271\",\"2\":\"-0.0035262660\"},{\"1\":\"272\",\"2\":\"0.1201591456\"},{\"1\":\"273\",\"2\":\"0.0390421265\"},{\"1\":\"274\",\"2\":\"0.1543388473\"},{\"1\":\"275\",\"2\":\"-0.1159087574\"},{\"1\":\"276\",\"2\":\"0.0130140422\"},{\"1\":\"277\",\"2\":\"-0.0615681360\"},{\"1\":\"278\",\"2\":\"-0.0663313771\"},{\"1\":\"279\",\"2\":\"-0.1992916826\"},{\"1\":\"280\",\"2\":\"-0.0829958665\"},{\"1\":\"281\",\"2\":\"0.0529859159\"},{\"1\":\"282\",\"2\":\"-0.0021667223\"},{\"1\":\"283\",\"2\":\"-0.3716634331\"},{\"1\":\"284\",\"2\":\"0.1879258654\"},{\"1\":\"285\",\"2\":\"-0.0285189683\"},{\"1\":\"286\",\"2\":\"0.0731226444\"},{\"1\":\"287\",\"2\":\"0.5286931447\"},{\"1\":\"288\",\"2\":\"0.2484336219\"},{\"1\":\"289\",\"2\":\"-0.2734940595\"},{\"1\":\"290\",\"2\":\"-0.0669055141\"},{\"1\":\"291\",\"2\":\"0.1280115989\"},{\"1\":\"292\",\"2\":\"0.1688946733\"},{\"1\":\"293\",\"2\":\"-0.0950051688\"},{\"1\":\"294\",\"2\":\"-0.2022696154\"},{\"1\":\"295\",\"2\":\"0.0822854526\"},{\"1\":\"296\",\"2\":\"0.2274042393\"},{\"1\":\"297\",\"2\":\"-0.1105213842\"},{\"1\":\"298\",\"2\":\"0.0992870056\"},{\"1\":\"299\",\"2\":\"0.3642730312\"},{\"1\":\"300\",\"2\":\"0.1885935416\"},{\"1\":\"301\",\"2\":\"-0.0523432372\"},{\"1\":\"302\",\"2\":\"-0.2522469563\"},{\"1\":\"303\",\"2\":\"0.1125631188\"},{\"1\":\"304\",\"2\":\"0.3229150035\"},{\"1\":\"305\",\"2\":\"-0.1271245894\"},{\"1\":\"306\",\"2\":\"0.1938180276\"},{\"1\":\"307\",\"2\":\"0.1817345390\"},{\"1\":\"308\",\"2\":\"0.0972839769\"},{\"1\":\"309\",\"2\":\"-0.1320370093\"},{\"1\":\"310\",\"2\":\"-0.0522174431\"},{\"1\":\"311\",\"2\":\"0.7091971596\"},{\"1\":\"312\",\"2\":\"0.0875034876\"},{\"1\":\"313\",\"2\":\"-0.1204091210\"},{\"1\":\"314\",\"2\":\"0.2315118996\"},{\"1\":\"315\",\"2\":\"-0.1270189546\"},{\"1\":\"316\",\"2\":\"0.0080701737\"},{\"1\":\"317\",\"2\":\"0.0926650765\"},{\"1\":\"318\",\"2\":\"-0.1198349840\"},{\"1\":\"319\",\"2\":\"-0.2607848260\"},{\"1\":\"320\",\"2\":\"-0.4717116542\"},{\"1\":\"321\",\"2\":\"-0.3247511132\"},{\"1\":\"322\",\"2\":\"-0.3143585873\"},{\"1\":\"323\",\"2\":\"-0.3230093491\"},{\"1\":\"324\",\"2\":\"-0.0909725011\"},{\"1\":\"325\",\"2\":\"-0.2601300517\"},{\"1\":\"326\",\"2\":\"-0.1111721266\"},{\"1\":\"327\",\"2\":\"-0.2336786219\"},{\"1\":\"328\",\"2\":\"0.1022834850\"},{\"1\":\"329\",\"2\":\"0.4767305152\"},{\"1\":\"330\",\"2\":\"-0.3966432335\"},{\"1\":\"331\",\"2\":\"-0.0434674976\"},{\"1\":\"332\",\"2\":\"0.0185264030\"},{\"1\":\"333\",\"2\":\"-0.2182293355\"},{\"1\":\"334\",\"2\":\"0.1459816050\"},{\"1\":\"335\",\"2\":\"-0.1527414238\"},{\"1\":\"336\",\"2\":\"0.3189452328\"},{\"1\":\"337\",\"2\":\"0.0294551665\"},{\"1\":\"338\",\"2\":\"0.0654064681\"},{\"1\":\"339\",\"2\":\"0.4279828920\"},{\"1\":\"340\",\"2\":\"0.3546925222\"},{\"1\":\"341\",\"2\":\"0.2898851887\"},{\"1\":\"342\",\"2\":\"0.1204962092\"},{\"1\":\"343\",\"2\":\"-0.1520866495\"},{\"1\":\"344\",\"2\":\"0.1423859911\"},{\"1\":\"345\",\"2\":\"-0.1846237709\"},{\"1\":\"346\",\"2\":\"0.1596197793\"},{\"1\":\"347\",\"2\":\"0.2826125172\"},{\"1\":\"348\",\"2\":\"-0.1423988930\"},{\"1\":\"349\",\"2\":\"0.0505885711\"},{\"1\":\"350\",\"2\":\"0.0503095663\"},{\"1\":\"351\",\"2\":\"0.2716781091\"},{\"1\":\"352\",\"2\":\"-0.1846302219\"},{\"1\":\"353\",\"2\":\"-0.0707244932\"},{\"1\":\"354\",\"2\":\"-0.1947784170\"},{\"1\":\"355\",\"2\":\"0.1433971819\"},{\"1\":\"356\",\"2\":\"0.2207766655\"},{\"1\":\"357\",\"2\":\"0.0280867528\"},{\"1\":\"358\",\"2\":\"-0.0199980325\"},{\"1\":\"359\",\"2\":\"0.2161755053\"},{\"1\":\"360\",\"2\":\"-0.2241650418\"},{\"1\":\"361\",\"2\":\"0.2382410763\"},{\"1\":\"362\",\"2\":\"0.3576454575\"},{\"1\":\"363\",\"2\":\"0.0825846167\"},{\"1\":\"364\",\"2\":\"0.1740127181\"},{\"1\":\"365\",\"2\":\"0.0086015731\"},{\"1\":\"366\",\"2\":\"0.0329814325\"},{\"1\":\"367\",\"2\":\"0.1238861983\"},{\"1\":\"368\",\"2\":\"0.4420573137\"},{\"1\":\"369\",\"2\":\"0.2384144463\"},{\"1\":\"370\",\"2\":\"-0.0002499754\"},{\"1\":\"371\",\"2\":\"0.3264856200\"},{\"1\":\"372\",\"2\":\"0.2511672239\"},{\"1\":\"373\",\"2\":\"0.0644888164\"},{\"1\":\"374\",\"2\":\"-0.4313277242\"},{\"1\":\"375\",\"2\":\"0.3378022485\"},{\"1\":\"376\",\"2\":\"0.1483031508\"},{\"1\":\"377\",\"2\":\"-0.0795316912\"},{\"1\":\"378\",\"2\":\"-0.0089507323\"},{\"1\":\"379\",\"2\":\"-0.1075515151\"},{\"1\":\"380\",\"2\":\"0.0592465903\"},{\"1\":\"381\",\"2\":\"-0.1209840645\"},{\"1\":\"382\",\"2\":\"0.1101351319\"},{\"1\":\"383\",\"2\":\"-0.2975795930\"},{\"1\":\"384\",\"2\":\"-0.0720985516\"},{\"1\":\"385\",\"2\":\"-0.3583316803\"},{\"1\":\"386\",\"2\":\"0.0335370230\"},{\"1\":\"387\",\"2\":\"0.0315573790\"},{\"1\":\"388\",\"2\":\"-0.1330852932\"},{\"1\":\"389\",\"2\":\"-0.2683131176\"},{\"1\":\"390\",\"2\":\"0.0462889941\"},{\"1\":\"391\",\"2\":\"0.1101786760\"},{\"1\":\"392\",\"2\":\"-0.0666297348\"},{\"1\":\"393\",\"2\":\"-0.1728329955\"},{\"1\":\"394\",\"2\":\"-0.2011213413\"},{\"1\":\"395\",\"2\":\"0.1226185811\"},{\"1\":\"396\",\"2\":\"-0.0848311698\"},{\"1\":\"397\",\"2\":\"0.1574788610\"},{\"1\":\"398\",\"2\":\"-0.4409533901\"},{\"1\":\"399\",\"2\":\"0.1238603944\"},{\"1\":\"400\",\"2\":\"0.0313082100\"},{\"1\":\"401\",\"2\":\"-0.0966090433\"},{\"1\":\"402\",\"2\":\"-0.1109406978\"},{\"1\":\"403\",\"2\":\"-0.2092044170\"},{\"1\":\"404\",\"2\":\"-0.0041697510\"},{\"1\":\"405\",\"2\":\"-0.0351279955\"},{\"1\":\"406\",\"2\":\"0.0283375345\"},{\"1\":\"407\",\"2\":\"-0.1326861389\"},{\"1\":\"408\",\"2\":\"0.0308155165\"},{\"1\":\"409\",\"2\":\"0.0771601504\"},{\"1\":\"410\",\"2\":\"-0.0554824445\"},{\"1\":\"411\",\"2\":\"-0.0046874420\"},{\"1\":\"412\",\"2\":\"-0.3214417614\"},{\"1\":\"413\",\"2\":\"0.2096721129\"},{\"1\":\"414\",\"2\":\"0.1146919416\"},{\"1\":\"415\",\"2\":\"-0.4031587215\"},{\"1\":\"416\",\"2\":\"-0.0041882976\"},{\"1\":\"417\",\"2\":\"-0.1670714655\"},{\"1\":\"418\",\"2\":\"-0.6088618700\"},{\"1\":\"419\",\"2\":\"0.0262409666\"},{\"1\":\"420\",\"2\":\"0.2659601233\"},{\"1\":\"421\",\"2\":\"-0.1183802884\"},{\"1\":\"422\",\"2\":\"0.1816901885\"},{\"1\":\"423\",\"2\":\"0.1317636491\"},{\"1\":\"424\",\"2\":\"0.0640219269\"},{\"1\":\"425\",\"2\":\"0.1239168404\"},{\"1\":\"426\",\"2\":\"0.1970451294\"},{\"1\":\"427\",\"2\":\"-0.3431138227\"},{\"1\":\"428\",\"2\":\"0.0723412696\"},{\"1\":\"429\",\"2\":\"0.1454824606\"},{\"1\":\"430\",\"2\":\"0.1067709467\"},{\"1\":\"431\",\"2\":\"-0.0181756311\"},{\"1\":\"432\",\"2\":\"0.4041021770\"},{\"1\":\"433\",\"2\":\"0.2083238585\"},{\"1\":\"434\",\"2\":\"-0.0050882091\"},{\"1\":\"435\",\"2\":\"0.0189505549\"},{\"1\":\"436\",\"2\":\"-0.2643554424\"},{\"1\":\"437\",\"2\":\"-0.0032529058\"},{\"1\":\"438\",\"2\":\"0.2558546659\"},{\"1\":\"439\",\"2\":\"-0.1018585268\"},{\"1\":\"440\",\"2\":\"0.0352529832\"},{\"1\":\"441\",\"2\":\"-0.1215888437\"},{\"1\":\"442\",\"2\":\"-0.1554806705\"},{\"1\":\"443\",\"2\":\"0.7414536634\"},{\"1\":\"444\",\"2\":\"-0.1308209999\"},{\"1\":\"445\",\"2\":\"-0.2305128044\"},{\"1\":\"446\",\"2\":\"-0.0061735861\"},{\"1\":\"447\",\"2\":\"0.1721032286\"},{\"1\":\"448\",\"2\":\"0.3591364398\"},{\"1\":\"449\",\"2\":\"-0.1735813089\"},{\"1\":\"450\",\"2\":\"0.1238297522\"},{\"1\":\"451\",\"2\":\"-0.0418257236\"},{\"1\":\"452\",\"2\":\"-0.1348077044\"},{\"1\":\"453\",\"2\":\"0.1036430287\"},{\"1\":\"454\",\"2\":\"0.1358076060\"},{\"1\":\"455\",\"2\":\"-0.1360317775\"},{\"1\":\"456\",\"2\":\"-0.1032188769\"},{\"1\":\"457\",\"2\":\"0.0314138448\"},{\"1\":\"458\",\"2\":\"-0.0994176379\"},{\"1\":\"459\",\"2\":\"-0.1292655077\"},{\"1\":\"460\",\"2\":\"-0.0594651171\"},{\"1\":\"461\",\"2\":\"0.3643101243\"},{\"1\":\"462\",\"2\":\"0.1185988153\"},{\"1\":\"463\",\"2\":\"0.3864119820\"},{\"1\":\"464\",\"2\":\"-0.2715966655\"},{\"1\":\"465\",\"2\":\"-0.1095674458\"},{\"1\":\"466\",\"2\":\"-0.1195785576\"},{\"1\":\"467\",\"2\":\"0.0785519489\"},{\"1\":\"468\",\"2\":\"-0.2641054670\"},{\"1\":\"469\",\"2\":\"0.0399662291\"},{\"1\":\"470\",\"2\":\"0.1255965139\"},{\"1\":\"471\",\"2\":\"-0.3822809369\"},{\"1\":\"472\",\"2\":\"-0.4746274963\"},{\"1\":\"473\",\"2\":\"0.1413433517\"},{\"1\":\"474\",\"2\":\"-0.1958533112\"},{\"1\":\"475\",\"2\":\"-0.2323287548\"},{\"1\":\"476\",\"2\":\"0.1365317283\"},{\"1\":\"477\",\"2\":\"0.2260317936\"},{\"1\":\"478\",\"2\":\"-0.3157810280\"},{\"1\":\"479\",\"2\":\"0.2734497090\"},{\"1\":\"480\",\"2\":\"0.0548018663\"},{\"1\":\"481\",\"2\":\"0.5822161045\"},{\"1\":\"482\",\"2\":\"0.0906918835\"},{\"1\":\"483\",\"2\":\"-0.1854978784\"},{\"1\":\"484\",\"2\":\"0.0939133408\"},{\"1\":\"485\",\"2\":\"0.0989999371\"},{\"1\":\"486\",\"2\":\"-0.1583207136\"},{\"1\":\"487\",\"2\":\"-0.5099812760\"},{\"1\":\"488\",\"2\":\"-0.0559630423\"},{\"1\":\"489\",\"2\":\"0.2109389238\"},{\"1\":\"490\",\"2\":\"-0.0255345845\"},{\"1\":\"491\",\"2\":\"0.1207147361\"},{\"1\":\"492\",\"2\":\"0.4408469489\"},{\"1\":\"493\",\"2\":\"-0.4326695277\"},{\"1\":\"494\",\"2\":\"0.0397412513\"},{\"1\":\"495\",\"2\":\"0.0105110626\"},{\"1\":\"496\",\"2\":\"-0.0513691395\"},{\"1\":\"497\",\"2\":\"0.1717605203\"},{\"1\":\"498\",\"2\":\"-0.2073997558\"},{\"1\":\"499\",\"2\":\"-0.1056033197\"},{\"1\":\"500\",\"2\":\"-0.2166004635\"},{\"1\":\"501\",\"2\":\"-0.2088536450\"},{\"1\":\"502\",\"2\":\"0.3275959946\"},{\"1\":\"503\",\"2\":\"-0.0444843330\"},{\"1\":\"504\",\"2\":\"0.0831587537\"},{\"1\":\"505\",\"2\":\"-0.1010473163\"},{\"1\":\"506\",\"2\":\"0.2070755942\"},{\"1\":\"507\",\"2\":\"-0.4062866395\"},{\"1\":\"508\",\"2\":\"-0.2352816900\"},{\"1\":\"509\",\"2\":\"-0.4087589769\"},{\"1\":\"510\",\"2\":\"-0.0359521079\"},{\"1\":\"511\",\"2\":\"-0.0011240830\"},{\"1\":\"512\",\"2\":\"0.0817411513\"},{\"1\":\"513\",\"2\":\"-0.1108528032\"},{\"1\":\"514\",\"2\":\"-0.1327425850\"},{\"1\":\"515\",\"2\":\"0.2586576159\"},{\"1\":\"516\",\"2\":\"-0.0861173336\"},{\"1\":\"517\",\"2\":\"0.1109535997\"},{\"1\":\"518\",\"2\":\"-0.0620737315\"},{\"1\":\"519\",\"2\":\"-0.0869857966\"},{\"1\":\"520\",\"2\":\"0.2455048777\"},{\"1\":\"521\",\"2\":\"-0.4025845844\"},{\"1\":\"522\",\"2\":\"0.1048985503\"},{\"1\":\"523\",\"2\":\"-0.1365938190\"},{\"1\":\"524\",\"2\":\"0.2997963104\"},{\"1\":\"525\",\"2\":\"0.1203591260\"},{\"1\":\"526\",\"2\":\"-0.1326175973\"},{\"1\":\"527\",\"2\":\"-0.0755256338\"},{\"1\":\"528\",\"2\":\"0.1692252859\"},{\"1\":\"529\",\"2\":\"-0.0297978747\"},{\"1\":\"530\",\"2\":\"-0.2762953967\"},{\"1\":\"531\",\"2\":\"-0.2682808627\"},{\"1\":\"532\",\"2\":\"0.0993055522\"},{\"1\":\"533\",\"2\":\"0.0112093810\"},{\"1\":\"534\",\"2\":\"0.0221454018\"},{\"1\":\"535\",\"2\":\"0.0227759849\"},{\"1\":\"536\",\"2\":\"-0.0167523840\"},{\"1\":\"537\",\"2\":\"-0.3027363437\"},{\"1\":\"538\",\"2\":\"-0.2457242110\"},{\"1\":\"539\",\"2\":\"0.0133196573\"},{\"1\":\"540\",\"2\":\"-0.2216556113\"},{\"1\":\"541\",\"2\":\"-0.1354269983\"},{\"1\":\"542\",\"2\":\"-0.4190507063\"},{\"1\":\"543\",\"2\":\"0.0841070475\"},{\"1\":\"544\",\"2\":\"-0.1686326023\"},{\"1\":\"545\",\"2\":\"0.1059597362\"},{\"1\":\"546\",\"2\":\"-0.1435657137\"},{\"1\":\"547\",\"2\":\"-0.1990860577\"},{\"1\":\"548\",\"2\":\"-0.0608819132\"},{\"1\":\"549\",\"2\":\"-0.0703938806\"},{\"1\":\"550\",\"2\":\"0.3424711440\"},{\"1\":\"551\",\"2\":\"0.0880389188\"},{\"1\":\"552\",\"2\":\"-0.0189191063\"},{\"1\":\"553\",\"2\":\"0.0240863399\"},{\"1\":\"554\",\"2\":\"-0.1787501552\"},{\"1\":\"555\",\"2\":\"0.3089526676\"},{\"1\":\"556\",\"2\":\"0.1072781549\"},{\"1\":\"557\",\"2\":\"-0.0020223817\"},{\"1\":\"558\",\"2\":\"-0.1107657150\"},{\"1\":\"559\",\"2\":\"-0.0723348187\"},{\"1\":\"560\",\"2\":\"0.0675852860\"},{\"1\":\"561\",\"2\":\"-0.0458196855\"},{\"1\":\"562\",\"2\":\"-0.0235065582\"},{\"1\":\"563\",\"2\":\"0.2190848965\"},{\"1\":\"564\",\"2\":\"0.0191311823\"},{\"1\":\"565\",\"2\":\"-0.3617394095\"},{\"1\":\"566\",\"2\":\"-0.2482263842\"},{\"1\":\"567\",\"2\":\"0.0484549101\"},{\"1\":\"568\",\"2\":\"-0.2370363561\"},{\"1\":\"569\",\"2\":\"-0.0494282014\"},{\"1\":\"570\",\"2\":\"-0.3427203130\"},{\"1\":\"571\",\"2\":\"0.4814615014\"},{\"1\":\"572\",\"2\":\"-0.0620301874\"},{\"1\":\"573\",\"2\":\"0.0539342097\"},{\"1\":\"574\",\"2\":\"-0.0407459911\"},{\"1\":\"575\",\"2\":\"-0.2884667799\"},{\"1\":\"576\",\"2\":\"0.3244196942\"},{\"1\":\"577\",\"2\":\"0.1676085095\"},{\"1\":\"578\",\"2\":\"-0.5566299122\"},{\"1\":\"579\",\"2\":\"-0.1653313142\"},{\"1\":\"580\",\"2\":\"-0.3591243442\"},{\"1\":\"581\",\"2\":\"-0.1091424876\"},{\"1\":\"582\",\"2\":\"0.2676518923\"},{\"1\":\"583\",\"2\":\"0.3465400985\"},{\"1\":\"584\",\"2\":\"0.0783455176\"},{\"1\":\"585\",\"2\":\"-0.6104471979\"},{\"1\":\"586\",\"2\":\"-0.0632792580\"},{\"1\":\"587\",\"2\":\"-0.2385595933\"},{\"1\":\"588\",\"2\":\"0.0667740755\"},{\"1\":\"589\",\"2\":\"-0.1630275086\"},{\"1\":\"590\",\"2\":\"0.0496281817\"},{\"1\":\"591\",\"2\":\"-0.0974710553\"},{\"1\":\"592\",\"2\":\"-0.2027873064\"},{\"1\":\"593\",\"2\":\"-0.1548944378\"},{\"1\":\"594\",\"2\":\"-0.2466289607\"},{\"1\":\"595\",\"2\":\"0.3044781078\"},{\"1\":\"596\",\"2\":\"-0.0818354968\"},{\"1\":\"597\",\"2\":\"-0.0458019453\"},{\"1\":\"598\",\"2\":\"0.1663352477\"},{\"1\":\"599\",\"2\":\"-0.1013964755\"},{\"1\":\"600\",\"2\":\"0.1028382691\"},{\"1\":\"601\",\"2\":\"-0.1744054214\"},{\"1\":\"602\",\"2\":\"0.0609810970\"},{\"1\":\"603\",\"2\":\"0.1447833358\"},{\"1\":\"604\",\"2\":\"0.0677909109\"},{\"1\":\"605\",\"2\":\"0.2259559947\"},{\"1\":\"606\",\"2\":\"0.2959450764\"},{\"1\":\"607\",\"2\":\"-0.1991166998\"},{\"1\":\"608\",\"2\":\"-0.0406830941\"},{\"1\":\"609\",\"2\":\"0.2653109936\"},{\"1\":\"610\",\"2\":\"0.1285413854\"},{\"1\":\"611\",\"2\":\"-0.2281904522\"},{\"1\":\"612\",\"2\":\"0.1483595969\"},{\"1\":\"613\",\"2\":\"-0.0360335515\"},{\"1\":\"614\",\"2\":\"-0.1705549938\"},{\"1\":\"615\",\"2\":\"-0.1249151293\"},{\"1\":\"616\",\"2\":\"0.0471622953\"},{\"1\":\"617\",\"2\":\"0.5254216924\"},{\"1\":\"618\",\"2\":\"-0.1227629217\"},{\"1\":\"619\",\"2\":\"0.1322813401\"},{\"1\":\"620\",\"2\":\"0.0559203046\"},{\"1\":\"621\",\"2\":\"-0.0147679019\"},{\"1\":\"622\",\"2\":\"-0.1861284616\"},{\"1\":\"623\",\"2\":\"0.5261280745\"},{\"1\":\"624\",\"2\":\"0.0439601910\"},{\"1\":\"625\",\"2\":\"0.1443148335\"},{\"1\":\"626\",\"2\":\"0.2803901552\"},{\"1\":\"627\",\"2\":\"-0.1625904548\"},{\"1\":\"628\",\"2\":\"-0.1509117651\"},{\"1\":\"629\",\"2\":\"-0.2212072683\"},{\"1\":\"630\",\"2\":\"-0.0561194786\"},{\"1\":\"631\",\"2\":\"0.2319924975\"},{\"1\":\"632\",\"2\":\"0.2708273863\"},{\"1\":\"633\",\"2\":\"0.2139104056\"},{\"1\":\"634\",\"2\":\"-0.1210517997\"},{\"1\":\"635\",\"2\":\"-0.4458408124\"},{\"1\":\"636\",\"2\":\"0.1099295069\"},{\"1\":\"637\",\"2\":\"-0.1018278847\"},{\"1\":\"638\",\"2\":\"0.0306590803\"},{\"1\":\"639\",\"2\":\"-0.2556732321\"},{\"1\":\"640\",\"2\":\"0.1310701689\"},{\"1\":\"641\",\"2\":\"-0.2583632901\"},{\"1\":\"642\",\"2\":\"0.3676315717\"},{\"1\":\"643\",\"2\":\"-0.2082496722\"},{\"1\":\"644\",\"2\":\"0.1004223778\"},{\"1\":\"645\",\"2\":\"0.0726847842\"},{\"1\":\"646\",\"2\":\"-0.1515044488\"},{\"1\":\"647\",\"2\":\"0.0410886993\"},{\"1\":\"648\",\"2\":\"-0.3181533752\"},{\"1\":\"649\",\"2\":\"0.2376475863\"},{\"1\":\"650\",\"2\":\"0.0995313364\"},{\"1\":\"651\",\"2\":\"-0.1043808593\"},{\"1\":\"652\",\"2\":\"-0.3001204720\"},{\"1\":\"653\",\"2\":\"0.2187163844\"},{\"1\":\"654\",\"2\":\"0.1874380101\"},{\"1\":\"655\",\"2\":\"-0.4242622903\"},{\"1\":\"656\",\"2\":\"-0.1481031705\"},{\"1\":\"657\",\"2\":\"0.0288366790\"},{\"1\":\"658\",\"2\":\"-0.0283375345\"},{\"1\":\"659\",\"2\":\"-0.0134833508\"},{\"1\":\"660\",\"2\":\"-0.2057765284\"},{\"1\":\"661\",\"2\":\"0.1502690864\"},{\"1\":\"662\",\"2\":\"0.3808875256\"},{\"1\":\"663\",\"2\":\"0.1115583789\"},{\"1\":\"664\",\"2\":\"0.3476948236\"},{\"1\":\"665\",\"2\":\"0.1156652329\"},{\"1\":\"666\",\"2\":\"-0.4199796472\"},{\"1\":\"667\",\"2\":\"0.0026279672\"},{\"1\":\"668\",\"2\":\"0.0680594329\"},{\"1\":\"669\",\"2\":\"-0.0130390397\"},{\"1\":\"670\",\"2\":\"-0.3355984331\"},{\"1\":\"671\",\"2\":\"0.2304636157\"},{\"1\":\"672\",\"2\":\"-0.0367689631\"},{\"1\":\"673\",\"2\":\"0.0907168811\"},{\"1\":\"674\",\"2\":\"-0.2350325210\"},{\"1\":\"675\",\"2\":\"0.2429527095\"},{\"1\":\"676\",\"2\":\"0.1928689274\"},{\"1\":\"677\",\"2\":\"-0.2614662106\"},{\"1\":\"678\",\"2\":\"0.0525303156\"},{\"1\":\"679\",\"2\":\"-0.0966348472\"},{\"1\":\"680\",\"2\":\"-0.1285736403\"},{\"1\":\"681\",\"2\":\"-0.0511385170\"},{\"1\":\"682\",\"2\":\"0.0847747238\"},{\"1\":\"683\",\"2\":\"-0.2415609109\"},{\"1\":\"684\",\"2\":\"0.2225111723\"},{\"1\":\"685\",\"2\":\"-0.1220944391\"},{\"1\":\"686\",\"2\":\"0.2389208481\"},{\"1\":\"687\",\"2\":\"-0.0945374729\"},{\"1\":\"688\",\"2\":\"0.2593502897\"},{\"1\":\"689\",\"2\":\"-0.2078868047\"},{\"1\":\"690\",\"2\":\"0.1717226208\"},{\"1\":\"691\",\"2\":\"-0.2083665962\"},{\"1\":\"692\",\"2\":\"-0.2733626208\"},{\"1\":\"693\",\"2\":\"0.2791225379\"},{\"1\":\"694\",\"2\":\"0.1790743169\"},{\"1\":\"695\",\"2\":\"-0.0315775383\"},{\"1\":\"696\",\"2\":\"0.0209285861\"},{\"1\":\"697\",\"2\":\"0.6056275108\"},{\"1\":\"698\",\"2\":\"0.3808826873\"},{\"1\":\"699\",\"2\":\"0.0241613325\"},{\"1\":\"700\",\"2\":\"-0.3796215211\"},{\"1\":\"701\",\"2\":\"0.4846765076\"},{\"1\":\"702\",\"2\":\"0.1003602871\"},{\"1\":\"703\",\"2\":\"-0.1115761191\"},{\"1\":\"704\",\"2\":\"0.2290645598\"},{\"1\":\"705\",\"2\":\"0.0999433927\"},{\"1\":\"706\",\"2\":\"0.1908288056\"},{\"1\":\"707\",\"2\":\"-0.3157939300\"},{\"1\":\"708\",\"2\":\"0.0973210700\"},{\"1\":\"709\",\"2\":\"-0.1000546720\"},{\"1\":\"710\",\"2\":\"0.1640266038\"},{\"1\":\"711\",\"2\":\"-0.0293301788\"},{\"1\":\"712\",\"2\":\"-0.1533591050\"},{\"1\":\"713\",\"2\":\"0.0233259308\"},{\"1\":\"714\",\"2\":\"0.1494393294\"},{\"1\":\"715\",\"2\":\"0.4510894896\"},{\"1\":\"716\",\"2\":\"0.0715800542\"},{\"1\":\"717\",\"2\":\"-0.1434778191\"},{\"1\":\"718\",\"2\":\"0.0884332348\"},{\"1\":\"719\",\"2\":\"0.1184246389\"},{\"1\":\"720\",\"2\":\"0.1109519870\"},{\"1\":\"721\",\"2\":\"0.3725931803\"},{\"1\":\"722\",\"2\":\"0.4818179179\"},{\"1\":\"723\",\"2\":\"0.2245214584\"},{\"1\":\"724\",\"2\":\"0.2206008764\"},{\"1\":\"725\",\"2\":\"0.3904511008\"},{\"1\":\"726\",\"2\":\"0.0964913130\"},{\"1\":\"727\",\"2\":\"-0.0960349062\"},{\"1\":\"728\",\"2\":\"-0.1084740050\"},{\"1\":\"729\",\"2\":\"0.1514367135\"},{\"1\":\"730\",\"2\":\"0.2670648533\"},{\"1\":\"731\",\"2\":\"-0.0566500715\"},{\"1\":\"732\",\"2\":\"-0.0023529943\"},{\"1\":\"733\",\"2\":\"-0.1104415533\"},{\"1\":\"734\",\"2\":\"0.1555629204\"},{\"1\":\"735\",\"2\":\"-0.5003798013\"},{\"1\":\"736\",\"2\":\"-0.3386013634\"},{\"1\":\"737\",\"2\":\"-0.2370726429\"},{\"1\":\"738\",\"2\":\"-0.0446399628\"},{\"1\":\"739\",\"2\":\"0.0866414756\"},{\"1\":\"740\",\"2\":\"0.1389726172\"},{\"1\":\"741\",\"2\":\"-0.1316007619\"},{\"1\":\"742\",\"2\":\"0.1661481693\"},{\"1\":\"743\",\"2\":\"-0.0102118985\"},{\"1\":\"744\",\"2\":\"0.1409941925\"},{\"1\":\"745\",\"2\":\"0.0325451851\"},{\"1\":\"746\",\"2\":\"0.1119260847\"},{\"1\":\"747\",\"2\":\"-0.0418757187\"},{\"1\":\"748\",\"2\":\"-0.1931874445\"},{\"1\":\"749\",\"2\":\"0.0836135477\"},{\"1\":\"750\",\"2\":\"0.2152514027\"},{\"1\":\"751\",\"2\":\"-0.2708539966\"},{\"1\":\"752\",\"2\":\"0.1879008678\"},{\"1\":\"753\",\"2\":\"0.0000000000\"},{\"1\":\"754\",\"2\":\"-0.1343972609\"},{\"1\":\"755\",\"2\":\"-0.1716290817\"},{\"1\":\"756\",\"2\":\"-0.1488466457\"},{\"1\":\"757\",\"2\":\"-0.2968611153\"},{\"1\":\"758\",\"2\":\"-0.0069589927\"},{\"1\":\"759\",\"2\":\"0.2286468589\"},{\"1\":\"760\",\"2\":\"-0.3267799458\"},{\"1\":\"761\",\"2\":\"-0.4240066703\"},{\"1\":\"762\",\"2\":\"0.2909084751\"},{\"1\":\"763\",\"2\":\"-0.1075515151\"},{\"1\":\"764\",\"2\":\"0.0090507224\"},{\"1\":\"765\",\"2\":\"0.1824264064\"},{\"1\":\"766\",\"2\":\"-0.2130798421\"},{\"1\":\"767\",\"2\":\"-0.1929068269\"},{\"1\":\"768\",\"2\":\"0.2877749125\"},{\"1\":\"769\",\"2\":\"-0.0719356644\"},{\"1\":\"770\",\"2\":\"0.1044864941\"},{\"1\":\"771\",\"2\":\"-0.0360899976\"},{\"1\":\"772\",\"2\":\"0.0531802516\"},{\"1\":\"773\",\"2\":\"-0.2665907064\"},{\"1\":\"774\",\"2\":\"0.2366113979\"},{\"1\":\"775\",\"2\":\"0.1966516198\"},{\"1\":\"776\",\"2\":\"-0.1345964349\"},{\"1\":\"777\",\"2\":\"-0.1095916370\"},{\"1\":\"778\",\"2\":\"0.0485742532\"},{\"1\":\"779\",\"2\":\"-0.2944847362\"},{\"1\":\"780\",\"2\":\"-0.2193526121\"},{\"1\":\"781\",\"2\":\"0.4830032852\"},{\"1\":\"782\",\"2\":\"-0.1397144797\"},{\"1\":\"783\",\"2\":\"0.1239861885\"},{\"1\":\"784\",\"2\":\"0.0871720686\"},{\"1\":\"785\",\"2\":\"0.0913345622\"},{\"1\":\"786\",\"2\":\"-0.0161597004\"},{\"1\":\"787\",\"2\":\"-0.1002659416\"},{\"1\":\"788\",\"2\":\"0.3104444563\"},{\"1\":\"789\",\"2\":\"0.2295080645\"},{\"1\":\"790\",\"2\":\"0.1554814768\"},{\"1\":\"791\",\"2\":\"-0.1184238325\"},{\"1\":\"792\",\"2\":\"-0.0024965286\"},{\"1\":\"793\",\"2\":\"-0.0827837906\"},{\"1\":\"794\",\"2\":\"-0.0836199987\"},{\"1\":\"795\",\"2\":\"-0.1446019021\"},{\"1\":\"796\",\"2\":\"-0.1568426332\"},{\"1\":\"797\",\"2\":\"0.1898732544\"},{\"1\":\"798\",\"2\":\"0.0086515682\"},{\"1\":\"799\",\"2\":\"0.5694447804\"},{\"1\":\"800\",\"2\":\"0.4018112734\"},{\"1\":\"801\",\"2\":\"0.2996471315\"},{\"1\":\"802\",\"2\":\"-0.2590688658\"},{\"1\":\"803\",\"2\":\"0.1806660958\"},{\"1\":\"804\",\"2\":\"-0.0499281522\"},{\"1\":\"805\",\"2\":\"-0.3011066653\"},{\"1\":\"806\",\"2\":\"0.4879657001\"},{\"1\":\"807\",\"2\":\"-0.0337111994\"},{\"1\":\"808\",\"2\":\"-0.1235805832\"},{\"1\":\"809\",\"2\":\"-0.0022594551\"},{\"1\":\"810\",\"2\":\"0.1762842688\"},{\"1\":\"811\",\"2\":\"-0.2203331608\"},{\"1\":\"812\",\"2\":\"-0.0893436291\"},{\"1\":\"813\",\"2\":\"0.1495957656\"},{\"1\":\"814\",\"2\":\"0.1448260736\"},{\"1\":\"815\",\"2\":\"-0.1309024435\"},{\"1\":\"816\",\"2\":\"0.3232907730\"},{\"1\":\"817\",\"2\":\"0.0251725233\"},{\"1\":\"818\",\"2\":\"0.1329361144\"},{\"1\":\"819\",\"2\":\"-0.4800769602\"},{\"1\":\"820\",\"2\":\"0.0865164879\"},{\"1\":\"821\",\"2\":\"0.2041597520\"},{\"1\":\"822\",\"2\":\"0.3418107251\"},{\"1\":\"823\",\"2\":\"-0.3467892675\"},{\"1\":\"824\",\"2\":\"0.0902733763\"},{\"1\":\"825\",\"2\":\"0.0850432457\"},{\"1\":\"826\",\"2\":\"0.0799252009\"},{\"1\":\"827\",\"2\":\"-0.6924762241\"},{\"1\":\"828\",\"2\":\"-0.1676464090\"},{\"1\":\"829\",\"2\":\"-0.1433350912\"},{\"1\":\"830\",\"2\":\"0.1060903685\"},{\"1\":\"831\",\"2\":\"0.0925586354\"},{\"1\":\"832\",\"2\":\"-0.1088868676\"},{\"1\":\"833\",\"2\":\"0.4922096374\"},{\"1\":\"834\",\"2\":\"-0.3714191023\"},{\"1\":\"835\",\"2\":\"0.5334112289\"},{\"1\":\"836\",\"2\":\"0.2309361498\"},{\"1\":\"837\",\"2\":\"-0.1215259466\"},{\"1\":\"838\",\"2\":\"0.2827810490\"},{\"1\":\"839\",\"2\":\"-0.1265698052\"},{\"1\":\"840\",\"2\":\"0.1360890300\"},{\"1\":\"841\",\"2\":\"-0.1526164361\"},{\"1\":\"842\",\"2\":\"-0.0764924741\"},{\"1\":\"843\",\"2\":\"-0.1668472941\"},{\"1\":\"844\",\"2\":\"0.0117391676\"},{\"1\":\"845\",\"2\":\"-0.0507514583\"},{\"1\":\"846\",\"2\":\"-0.0584789238\"},{\"1\":\"847\",\"2\":\"0.2827931445\"},{\"1\":\"848\",\"2\":\"-0.3091590989\"},{\"1\":\"849\",\"2\":\"0.2675825443\"},{\"1\":\"850\",\"2\":\"0.4459214497\"},{\"1\":\"851\",\"2\":\"0.1826086466\"},{\"1\":\"852\",\"2\":\"-0.3818253365\"},{\"1\":\"853\",\"2\":\"-0.1207405400\"},{\"1\":\"854\",\"2\":\"0.5050116037\"},{\"1\":\"855\",\"2\":\"-0.0782592358\"},{\"1\":\"856\",\"2\":\"0.2101462598\"},{\"1\":\"857\",\"2\":\"0.2526654636\"},{\"1\":\"858\",\"2\":\"0.2277663004\"},{\"1\":\"859\",\"2\":\"-0.2836922496\"},{\"1\":\"860\",\"2\":\"-0.4164791851\"},{\"1\":\"861\",\"2\":\"-0.1891999336\"},{\"1\":\"862\",\"2\":\"0.2633765065\"},{\"1\":\"863\",\"2\":\"-0.1192600405\"},{\"1\":\"864\",\"2\":\"-0.3399310713\"},{\"1\":\"865\",\"2\":\"-0.3296683713\"},{\"1\":\"866\",\"2\":\"0.0983387118\"},{\"1\":\"867\",\"2\":\"-0.4906001184\"},{\"1\":\"868\",\"2\":\"-0.1446075467\"},{\"1\":\"869\",\"2\":\"-0.0100683642\"},{\"1\":\"870\",\"2\":\"0.3412099777\"},{\"1\":\"871\",\"2\":\"-0.2546926835\"},{\"1\":\"872\",\"2\":\"0.1028318182\"},{\"1\":\"873\",\"2\":\"-0.1936744933\"},{\"1\":\"874\",\"2\":\"-0.0760497757\"},{\"1\":\"875\",\"2\":\"0.2092157062\"},{\"1\":\"876\",\"2\":\"-0.1414876923\"},{\"1\":\"877\",\"2\":\"0.0387050629\"},{\"1\":\"878\",\"2\":\"0.1167949605\"},{\"1\":\"879\",\"2\":\"0.0705067727\"},{\"1\":\"880\",\"2\":\"-0.1133114323\"},{\"1\":\"881\",\"2\":\"-0.0137196179\"},{\"1\":\"882\",\"2\":\"0.1353697459\"},{\"1\":\"883\",\"2\":\"-0.1493764323\"},{\"1\":\"884\",\"2\":\"-0.1992852316\"},{\"1\":\"885\",\"2\":\"0.3383941257\"},{\"1\":\"886\",\"2\":\"0.0820169306\"},{\"1\":\"887\",\"2\":\"0.1661860688\"},{\"1\":\"888\",\"2\":\"0.0218462377\"},{\"1\":\"889\",\"2\":\"-0.3255429708\"},{\"1\":\"890\",\"2\":\"-0.3580808985\"},{\"1\":\"891\",\"2\":\"-0.3145827588\"},{\"1\":\"892\",\"2\":\"0.0635219761\"},{\"1\":\"893\",\"2\":\"0.0996934173\"},{\"1\":\"894\",\"2\":\"-0.1783195524\"},{\"1\":\"895\",\"2\":\"0.1479854401\"},{\"1\":\"896\",\"2\":\"0.0247798200\"},{\"1\":\"897\",\"2\":\"0.2280541753\"},{\"1\":\"898\",\"2\":\"-0.3841154338\"},{\"1\":\"899\",\"2\":\"-0.1475725775\"},{\"1\":\"900\",\"2\":\"0.0954809285\"},{\"1\":\"901\",\"2\":\"-0.0764360281\"},{\"1\":\"902\",\"2\":\"-0.1294356523\"},{\"1\":\"903\",\"2\":\"-0.0497959072\"},{\"1\":\"904\",\"2\":\"-0.2709967245\"},{\"1\":\"905\",\"2\":\"0.2658972262\"},{\"1\":\"906\",\"2\":\"0.2383031669\"},{\"1\":\"907\",\"2\":\"-0.2347769010\"},{\"1\":\"908\",\"2\":\"-0.1999158147\"},{\"1\":\"909\",\"2\":\"0.1112519575\"},{\"1\":\"910\",\"2\":\"0.0896306976\"},{\"1\":\"911\",\"2\":\"-0.4442111341\"},{\"1\":\"912\",\"2\":\"0.1678092962\"},{\"1\":\"913\",\"2\":\"-0.0451778132\"},{\"1\":\"914\",\"2\":\"0.2633998913\"},{\"1\":\"915\",\"2\":\"-0.1450945955\"},{\"1\":\"916\",\"2\":\"-0.0446593158\"},{\"1\":\"917\",\"2\":\"0.1570789003\"},{\"1\":\"918\",\"2\":\"-0.0506014731\"},{\"1\":\"919\",\"2\":\"0.1097416222\"},{\"1\":\"920\",\"2\":\"0.1282922164\"},{\"1\":\"921\",\"2\":\"0.4077598817\"},{\"1\":\"922\",\"2\":\"-0.0089200901\"},{\"1\":\"923\",\"2\":\"0.1142048927\"},{\"1\":\"924\",\"2\":\"0.2375661427\"},{\"1\":\"925\",\"2\":\"-0.1912215089\"},{\"1\":\"926\",\"2\":\"-0.3652164868\"},{\"1\":\"927\",\"2\":\"-0.3789159454\"},{\"1\":\"928\",\"2\":\"0.2922131855\"},{\"1\":\"929\",\"2\":\"-0.0787019342\"},{\"1\":\"930\",\"2\":\"-0.0253725037\"},{\"1\":\"931\",\"2\":\"0.1388218256\"},{\"1\":\"932\",\"2\":\"0.1341908296\"},{\"1\":\"933\",\"2\":\"0.0041697510\"},{\"1\":\"934\",\"2\":\"-0.2033114484\"},{\"1\":\"935\",\"2\":\"0.1240732767\"},{\"1\":\"936\",\"2\":\"0.1100593329\"},{\"1\":\"937\",\"2\":\"0.1349149519\"},{\"1\":\"938\",\"2\":\"-0.0676965653\"},{\"1\":\"939\",\"2\":\"0.0406339054\"},{\"1\":\"940\",\"2\":\"0.0595522053\"},{\"1\":\"941\",\"2\":\"-0.1092368332\"},{\"1\":\"942\",\"2\":\"-0.0500345934\"},{\"1\":\"943\",\"2\":\"0.1610357691\"},{\"1\":\"944\",\"2\":\"0.2616153895\"},{\"1\":\"945\",\"2\":\"0.1579143020\"},{\"1\":\"946\",\"2\":\"-0.2733190767\"},{\"1\":\"947\",\"2\":\"-0.3192016592\"},{\"1\":\"948\",\"2\":\"0.1634387584\"},{\"1\":\"949\",\"2\":\"-0.1740885171\"},{\"1\":\"950\",\"2\":\"-0.0826209034\"},{\"1\":\"951\",\"2\":\"-0.0431925246\"},{\"1\":\"952\",\"2\":\"0.0422184269\"},{\"1\":\"953\",\"2\":\"-0.0911482902\"},{\"1\":\"954\",\"2\":\"0.0679296069\"},{\"1\":\"955\",\"2\":\"0.2194784062\"},{\"1\":\"956\",\"2\":\"-0.5419999000\"},{\"1\":\"957\",\"2\":\"-0.1718588978\"},{\"1\":\"958\",\"2\":\"0.5146364632\"},{\"1\":\"959\",\"2\":\"-0.4510080460\"},{\"1\":\"960\",\"2\":\"0.2491819353\"},{\"1\":\"961\",\"2\":\"-0.0359650099\"},{\"1\":\"962\",\"2\":\"-0.0733968110\"},{\"1\":\"963\",\"2\":\"0.2136604302\"},{\"1\":\"964\",\"2\":\"0.0142687574\"},{\"1\":\"965\",\"2\":\"-0.0629607410\"},{\"1\":\"966\",\"2\":\"-0.2267744625\"},{\"1\":\"967\",\"2\":\"0.1295541890\"},{\"1\":\"968\",\"2\":\"0.0830095749\"},{\"1\":\"969\",\"2\":\"0.2137789669\"},{\"1\":\"970\",\"2\":\"0.3428138522\"},{\"1\":\"971\",\"2\":\"-0.1039671903\"},{\"1\":\"972\",\"2\":\"-0.5039818663\"},{\"1\":\"973\",\"2\":\"0.2639127441\"},{\"1\":\"974\",\"2\":\"0.1534276466\"},{\"1\":\"975\",\"2\":\"-0.2358187340\"},{\"1\":\"976\",\"2\":\"-0.1745320218\"},{\"1\":\"977\",\"2\":\"-0.3085970574\"},{\"1\":\"978\",\"2\":\"0.1155096031\"},{\"1\":\"979\",\"2\":\"0.1748497325\"},{\"1\":\"980\",\"2\":\"0.0246733789\"},{\"1\":\"981\",\"2\":\"-0.5018473989\"},{\"1\":\"982\",\"2\":\"-0.2087488166\"},{\"1\":\"983\",\"2\":\"-0.2543628772\"},{\"1\":\"984\",\"2\":\"-0.2302386378\"},{\"1\":\"985\",\"2\":\"0.1022955806\"},{\"1\":\"986\",\"2\":\"-0.1201970451\"},{\"1\":\"987\",\"2\":\"-0.0845755498\"},{\"1\":\"988\",\"2\":\"-0.0511812547\"},{\"1\":\"989\",\"2\":\"0.0707373952\"},{\"1\":\"990\",\"2\":\"-0.0433183187\"},{\"1\":\"991\",\"2\":\"-0.2173318432\"},{\"1\":\"992\",\"2\":\"-0.0094184282\"},{\"1\":\"993\",\"2\":\"0.0995297237\"},{\"1\":\"994\",\"2\":\"0.0833950208\"},{\"1\":\"995\",\"2\":\"0.2149965890\"},{\"1\":\"996\",\"2\":\"0.1824143109\"},{\"1\":\"997\",\"2\":\"-0.1337166827\"},{\"1\":\"998\",\"2\":\"-0.2459306423\"},{\"1\":\"999\",\"2\":\"0.3137715483\"},{\"1\":\"1000\",\"2\":\"0.0518803795\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nAfter acquiring the bootstrap samples, we will visualize the distribution of the difference in means by plotting a histogram. We will also add a line to show the observed difference as compared to our null distribution.\r\n\r\n\r\ndist_plot_manual <- null_model_manual %>%\r\n                    ggplot() + \r\n                    geom_histogram(aes(x=diff), bins=100) +\r\n                    xlab(\"Difference in means\")+\r\n                    ggtitle(\"Distribution of bootstrap sampling under the null hypothesis\")+\r\n                    geom_vline(xintercept = obs_diff_means, color = \"red\", alpha = .3, lwd = 2) \r\ndist_plot_manual\r\n\r\n\r\n\r\n\r\nFrom the plot above, we see that the observed mean difference is very unlikely under the null hypothesis. We will quantify the likelihood of the observed difference to happen under the null hypothesis by getting the p value and storing it in the variable p_value.\r\n\r\n\r\np_value <- 2 * mean(null_model_manual$diff > obs_diff_means)\r\ncat(\"The P value is \",p_value)\r\n\r\n\r\nThe P value is  0\r\n\r\nBecause we obtained a p-value of 0, we will report the p-value as <0.001 as it is very unlikely to obtain a p-value of 0. As the p value we obtained is much smaller than our significance level, we have enough evidence to reject the null hypothesis. Therefore, we conclude that the fuel efficiency of gasoline cars is different to that of diesel cars in the city.\r\nHypothesis Testing for City MPG, Asymptotic Method (5% Significance Level)\r\nTo confirm the results that we obtained in the previous section, we will be repeating the hypothesis test, but this time, using the build in t.test() function. As our dataset is big, using the t distribution will be similar to a normal distribution, and hence wouldn’t alter our results by a significant amount.\r\n\r\n\r\nxc_data <- tidy_data %>% filter(Fuel_Type == \"Diesel\") %>% pull(as.numeric(City_MPG))\r\nyc_data <- tidy_data %>% filter(Fuel_Type == \"Gasoline or E85\") %>% pull(as.numeric(City_MPG))\r\ncity_test <- tidy(\r\n            t.test(x = xc_data, \r\n                   y = yc_data,\r\n                   alternative = \"two.sided\", conf.level = 0.9))\r\n\r\ncat(\"The P value is \", city_test$p.value)\r\n\r\n\r\nThe P value is  3.997089e-130\r\n\r\n\r\n\r\ncity_test %>% paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"estimate1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"estimate2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parameter\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"5.81619\",\"2\":\"21.22584\",\"3\":\"15.40965\",\"4\":\"26.98404\",\"5\":\"3.997089e-130\",\"6\":\"1439.726\",\"7\":\"5.461427\",\"8\":\"6.170953\",\"9\":\"Welch Two Sample t-test\",\"10\":\"two.sided\",\"_row\":\"t\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nFrom the test conducted above, we again obtained a p-value that is smaller than the significance level. Therefore, we have enough evidence to reject the null hypothesis and conclude that the city’s MPG means on diesel and gasoline are not the same.\r\nIn the previous method (Bootstrapping), we obtained a p-value that is exactly 0, but this is probably because R has rounded it up, which makes sense as the exact p-value is very small. Bootstrapping is still prone to sampling variation whereas the asymptotic method isn’t. On top of that, bootstrapping is expensive as it requires sampling a lot of times. In addition, we are able to calculated a more precise value which is very small in comparison. As our dataset satisfies all the assumptions for CLT, using the asymptotic theory would be preferrable. But, in conclusion, the results obtained through asymptotics agree with the ones obtained through bootstrapping.\r\nHypothesis Testing for Highway MPG, Asymptotic Method (5% Significance Level)\r\nSimilarly, we will repeat the same hypothesis as before, but for the HighwayMPG variable this time around. For the sake of a more precise value, we will be using the t.test() function as we did before.\r\n\r\n\r\nxh_data <- tidy_data %>% filter(Fuel_Type == \"Diesel\") %>% pull(as.numeric(Highway_MPG))\r\nyh_data <- tidy_data %>% filter(Fuel_Type == \"Gasoline or E85\") %>% pull(as.numeric(Highway_MPG))\r\nhway_test <- tidy(\r\n            t.test(x = xh_data, \r\n                   y = yh_data, \r\n                   alternative = \"two.sided\", conf.level = 0.9))\r\n\r\ncat(\"The P value is \", hway_test$p.value)\r\n\r\n\r\nThe P value is  2.834465e-73\r\n\r\n\r\n\r\nhway_test %>% paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"estimate1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"estimate2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parameter\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"5.522511\",\"2\":\"27.13412\",\"3\":\"21.61161\",\"4\":\"19.08213\",\"5\":\"2.834465e-73\",\"6\":\"1593.575\",\"7\":\"5.046202\",\"8\":\"5.998821\",\"9\":\"Welch Two Sample t-test\",\"10\":\"two.sided\",\"_row\":\"t\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nFrom the test conducted above, we obtained a p-value that is lower than our significance level. Therefore, we have enough evidence to reject the null hypothesis and conclude that the difference in Highway’s MPG means on diesel and gasoline are not the same.\r\nConfidence Intervals\r\nIn the previous section, we have proven through hypothesis testing that the MPG difference in means of diesel and gasoline based cars are different. But, to quantify how different these values are, we need to create a confidence interval that could estimate the actual difference in the efficiency of the cars.\r\n90% Confidence Interval for City MPG\r\nWe will use bootstrapping method to obtain a 90% confidence interval of the difference in means in City MPG, from 1000 bootstrap samples.\r\n\r\n\r\ncity_conf <- tidy_data %>%\r\n                specify(formula = City_MPG ~ Fuel_Type) %>%\r\n                generate(reps = 1000, type = \"bootstrap\") %>%\r\n                calculate(stat = \"diff in means\", order = c(\"Diesel\", \"Gasoline or E85\"))%>%\r\n                get_confidence_interval(level = 0.90, type = \"percentile\")\r\ncity_conf %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=F)\r\n\r\n\r\n\r\nlower_ci\r\n\r\n\r\nupper_ci\r\n\r\n\r\n5.427607\r\n\r\n\r\n6.161948\r\n\r\n\r\nAs such, we are 90% confident that the difference in means between diesel and gasoline MPG in the city is between 5.470094 and 6.158715. This means that if we retake a sample from our sample, we would have a 90% chance that the difference in means between diesel and gasoline MPG in the city of the sample, is captured by the confidence interval.\r\nRecall that from Section 4.1, we obtained a confidence interval of (5.461427,6.170953) by using the two-sample-t-test. This is very similar to the confidence interval that we obtained here, which supports our results.\r\n90% Confidence Interval for Highway MPG\r\nAgain, we will repeat the bootstrapping method to obtain a 90% confidence interval of the difference in means in Highway MPG, from 1000 bootstrap samples.\r\n\r\n\r\nhighway_conf <- tidy_data %>%\r\n                specify(formula = Highway_MPG ~ Fuel_Type) %>%\r\n                generate(reps = 1000, type = \"bootstrap\") %>%\r\n                calculate(stat = \"diff in means\", order = c(\"Diesel\", \"Gasoline or E85\"))%>%\r\n                get_confidence_interval(level = 0.90, type = \"percentile\")\r\nhighway_conf %>%  kbl() %>% \r\n  kable_paper(\"hover\", full_width=F)\r\n\r\n\r\n\r\nlower_ci\r\n\r\n\r\nupper_ci\r\n\r\n\r\n5.070112\r\n\r\n\r\n5.987309\r\n\r\n\r\nAs such, we are 90% confident that the difference in means between diesel and gasoline MPG on the highway is between 5.035987 and 6.028125. This means that if we retake a sample from our population, we would have a 90% chance that the difference in means between diesel and gasoline MPG on the highway of the sample, is captured by the confidence interval. ​ Recall that from section 4.2, we obtained a confidence interval of (5.046202,5.998821) by using two sample-t-test. This is again very similar to the confidence interval we obtained here, which supports our results.\r\nResults\r\nFrom the results of our hypothesis tests, we have reported that for both the City and Highway MPG, the mean of Diesel and Gasoline-based cars are different. In addition, from our confidence intervals, we are 90% confident that the difference between the means is a positive value, which suggests that the mean of Diesel MPG is higher than the mean of Gasoline MPG. As such, we can conclude that the efficiency of Diesel-based cars outperforms the efficiency of Gasoline-based cars in both the city and the highway, which aligns with the results obtained by the Universal Technical Institute.\r\nThese results were what we expected to find given our Preliminary Results, but our findings weren’t concrete before performing the hypothesis tests (as the dataset is a sample, not the population). The hypothesis tests and confidence intervals simply confirmed our initial observations. These findings would suggest buyers to purchase a diesel-based car over a gasoline-based car, but with that being said, our findings are very limited to the car brands and the year of manufacture between 1984-2017, as our findings were based on a sample. The investigation can be repeated using more brands and newer models to expand the scope of our claim.\r\nReferences\r\nBaures, L. (2019, July 16). Pickup Trucks: Gas vs Diesel. Trusted Auto Professionals. https://tap.fremontmotors.com/pickup-trucks-gas-vs-diesel/\r\nChevrolet, S. (2021, March 10). What Is the Difference Between Diesel and Gas? Sweeney Chevrolet. https://www.sweeneychevrolet.com/blog/what-is-the-difference-between-diesel-and-gas/\r\nGas vs. Diesel Engines: What’s the Difference? (2021). UTI Corporate. https://www.uti.edu/blog/diesel/gas-vs-diesel-engines\r\n\r\n\r\n\r\n",
    "preview": "https://raw.githubusercontent.com/Zibo-S/STAT201_GP_7/main/intro_pic_2.png",
    "last_modified": "2022-01-14T11:43:24-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-12-17-life-expectancy-analysis/",
    "title": "Life Expectancy Prediction Analysis",
    "description": "This project analyses World Health Organisation(WHO) data to predict life expectancy in different countries. Multiple linear regression model is used to draw insights. Different dimensionality reduction techniques were used to pick the best model with the minimal root mean squared error(RMSE).",
    "author": [
      {
        "name": "Blaise Appolinary",
        "url": "https://ca.linkedin.com/in/blaise-appolinary-038a42179"
      }
    ],
    "date": "2021-12-17",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nLoading necessary packages for the Analysis\r\nLoading Dataset from github\r\n\r\nExploratory Data Analysis\r\nData preview and cleaning\r\nVariable Corelation\r\nCategorical Variables\r\nContinuous Variables\r\n\r\n\r\nVariable Selection\r\nPreparing the data\r\nBackward Selection\r\nForward Selection\r\nLASSO Model Selection\r\nRidge Model Selection\r\nCross-Validation\r\n\r\nDiscussion\r\nResults and impacts\r\nAre the results what we expected?\r\nImprovements that could be made\r\nFuture questions/research\r\n\r\nReferences\r\n\r\nIntroduction\r\nLife expectancy is an estimate of how long a person would live on average. Throughout the years, there have been lot of studies on factors affecting life expectancy. However, these studies have not taken into account the possibility that human development index could have a significant effect. Additionally, past studies were conducted using multiple linear regressions based on world data for only one year. Therefore, there is reason to consider global data from 2000 to 2015 instead. This project relies heavily on the accuracy of the data which is provided by the Global Health Observatory (GHO) data repository under World Health Organization (WHO)\\(^{(1)}\\). Our goal is to determine the most significant variables to create an optimal linear regression model for predicting life expectancy. For instance, if current mortality rates in every age group remained constant throughout, then it would be an easily understood measure to which any person could directly relate \\(^{(2)}\\). In reality, life expectancy is affected by a variety of socioeconomic, genetic and environmental factors. Therefore, it makes for a good area of study to investigate via statistical methods to better understand the measure of life expectancy.\r\nLoading necessary packages for the Analysis\r\n\r\n\r\nlibrary(hrbrthemes)\r\nlibrary(kableExtra)\r\nlibrary(ggstar)\r\nlibrary(viridis)\r\nlibrary(ggExtra)\r\nlibrary(plotly)\r\nlibrary(ggstatsplot)\r\nlibrary(patchwork)\r\nlibrary(leaps)\r\nlibrary(gganimate)\r\nlibrary(tidyverse)\r\nlibrary(tidymodels)\r\nlibrary(corrr)\r\nlibrary(mltools)\r\nlibrary(ggplot2)\r\nlibrary(elasticnet)\r\nlibrary(plotly)\r\nlibrary(caret)\r\nlibrary(tidygeocoder)\r\nlibrary(glmnet)\r\nlibrary(GGally)\r\nlibrary(DT)\r\nlibrary(broom)\r\nlibrary(corrgram)\r\noptions(repr.plot.width = 8, repr.plot.height = 8)\r\nlibrary(knitr)\r\n\r\n\r\n\r\nLoading Dataset from github\r\n\r\n\r\ndata <- read.csv(\"https://raw.githubusercontent.com/zackhamza01/Life-Expectancy/main/Life%20Expectancy%20Data.csv\")\r\n\r\n\r\n\r\nExploratory Data Analysis\r\nTo begin with, we first performed some data cleaning and exploration. The exploration was very necessary for us to have a deeper understanding of the dataset before the process of gaining insights from it.\r\nData preview and cleaning\r\nTable 1\r\n\r\n\r\ndata %>% head(3) %>% rmarkdown::paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Country\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Year\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Status\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Life.expectancy\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Adult.Mortality\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"infant.deaths\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Alcohol\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"percentage.expenditure\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Hepatitis.B\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Measles\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"BMI\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"under.five.deaths\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Polio\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Total.expenditure\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Diphtheria\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"HIV.AIDS\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"GDP\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Population\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"thinness..1.19.years\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"thinness.5.9.years\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Income.composition.of.resources\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Schooling\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Afghanistan\",\"2\":\"2015\",\"3\":\"Developing\",\"4\":\"65.0\",\"5\":\"263\",\"6\":\"62\",\"7\":\"0.01\",\"8\":\"71.27962\",\"9\":\"65\",\"10\":\"1154\",\"11\":\"19.1\",\"12\":\"83\",\"13\":\"6\",\"14\":\"8.16\",\"15\":\"65\",\"16\":\"0.1\",\"17\":\"584.2592\",\"18\":\"33736494\",\"19\":\"17.2\",\"20\":\"17.3\",\"21\":\"0.479\",\"22\":\"10.1\",\"_rn_\":\"1\"},{\"1\":\"Afghanistan\",\"2\":\"2014\",\"3\":\"Developing\",\"4\":\"59.9\",\"5\":\"271\",\"6\":\"64\",\"7\":\"0.01\",\"8\":\"73.52358\",\"9\":\"62\",\"10\":\"492\",\"11\":\"18.6\",\"12\":\"86\",\"13\":\"58\",\"14\":\"8.18\",\"15\":\"62\",\"16\":\"0.1\",\"17\":\"612.6965\",\"18\":\"327582\",\"19\":\"17.5\",\"20\":\"17.5\",\"21\":\"0.476\",\"22\":\"10.0\",\"_rn_\":\"2\"},{\"1\":\"Afghanistan\",\"2\":\"2013\",\"3\":\"Developing\",\"4\":\"59.9\",\"5\":\"268\",\"6\":\"66\",\"7\":\"0.01\",\"8\":\"73.21924\",\"9\":\"64\",\"10\":\"430\",\"11\":\"18.1\",\"12\":\"89\",\"13\":\"62\",\"14\":\"8.13\",\"15\":\"64\",\"16\":\"0.1\",\"17\":\"631.7450\",\"18\":\"31731688\",\"19\":\"17.7\",\"20\":\"17.7\",\"21\":\"0.470\",\"22\":\"9.9\",\"_rn_\":\"3\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nThis dataset contains variables such as country, year, status, life expectancy, etc. The Adult.Mortality column represents the adult mortality rates of both genders, which is the probability of dying between 15 and 60 years per 1000 population. Infant.deaths showcases the number of infant deaths per 1000 population. The Alcohol column describes the total litres of consumption for pure alcohol, which is recorded per capita for ages 15 and older. The Hepatitis.B, Polio, and Diphteria variables demonstrate the percentage of immunization coverage among 1-year-olds for each of those diseases. The Measles column signifies the number of reported cases of the measles per 1000 population. thinness..1.19.years` represents the percentage of thinness present in children ranging from the age of 10 to 19 years old.\r\nLife expectancy ranges from 44 to 89. This means that the people in the country with the highest life expectancy lived almost twice as long as the ones in the country with the lowest life expectancy.\r\nThe dataframe has 1649 rows and 20 attributes.\r\nVariable Corelation\r\nCategorical Variables\r\nComparison of mean life expectancy rate between developed and developing countries\r\nTo get an understanding of how the development status of a country is correlated with life expectancy, we compared the mean life expectancy of developed and developing countries.\r\nTable 2\r\n\r\n\r\ndata %>%\r\n  filter(Life.expectancy>0)%>%\r\n  group_by(Status) %>%\r\n  summarize(mean_life_expectancy=mean(Life.expectancy)) %>% kbl() %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nStatus\r\n\r\n\r\nmean_life_expectancy\r\n\r\n\r\nDeveloped\r\n\r\n\r\n79.19785\r\n\r\n\r\nDeveloping\r\n\r\n\r\n67.11147\r\n\r\n\r\nIn the table above, we saw that on average, people in developed countries lived almost a decade longer than people in developing countries.\r\nTo better vizualize the correlation between the development status of a country and Life expectancy, we created a boxplot as shown below.\r\n\r\n\r\n#Plot showing life expectancy in different country status\r\nplt <- ggbetweenstats(\r\n  data = data,\r\n  x = Status, \r\n  y = Life.expectancy\r\n)\r\nplt <- plt + \r\n  # Add labels and title\r\n  labs(\r\n    x = \"Development Status\",\r\n    y = \"Life Expectancy\",\r\n    title = \"Life Expectancy Vs Development Status\"\r\n  ) + \r\n  # Customizations\r\n  theme(\r\n    # This is the new default font in the plot\r\n    text = element_text(family = \"Roboto\", size = 8, color = \"black\"),\r\n    plot.title = element_text(\r\n      family = \"Lobster Two\", \r\n      size = 20,\r\n      face = \"bold\",\r\n      color = \"#2a475e\"\r\n    ),\r\n    # Statistical annotations below the main title\r\n    plot.subtitle = element_text(\r\n      family = \"Roboto\", \r\n      size = 15, \r\n      face = \"bold\",\r\n      color=\"#1b2838\"\r\n    ),\r\n    plot.title.position = \"plot\", # slightly different from default\r\n    axis.text = element_text(size = 10, color = \"black\"),\r\n    axis.title = element_text(size = 12)\r\n  )+\r\n    theme(\r\n    axis.ticks = element_blank(),\r\n    axis.line = element_line(colour = \"grey50\"),\r\n    panel.grid = element_line(color = \"#b4aea9\"),\r\n    panel.grid.minor = element_blank(),\r\n    panel.grid.major.x = element_blank(),\r\n    panel.grid.major.y = element_line(linetype = \"dashed\"),\r\n    panel.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\"),\r\n    plot.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\")\r\n  )\r\nplt\r\n\r\n\r\n\r\n\r\nFigure 1: Box Plot showing development status and life expectancy\r\n\r\n\r\n\r\nAs we can see here, there is a stark difference in the life expectancy in developing and developed countries. To begin with, the interquartile range of life expectancy is lower in developed than developing countries.The mean and median are both much higher in developed countries. The minimum life expectancy is also much lower in developing countries. Thus, we can see that the status of the country could affect life expectancy.\r\nThe next categorical variable is Country. To show this, we created a map depicting the average life expectancy in each country.\r\n\r\n\r\nnew_data <- data #%>% na.omit()\r\nsummary_data <- new_data %>% \r\n    group_by(Country) %>% \r\n    summarize(mean=mean(Life.expectancy))\r\n\r\ng <- list(\r\nshowframe = TRUE,\r\nshowcoastlines = TRUE,\r\nprojection = list(type = 'Mercator')\r\n)\r\n\r\nplot <- plot_geo(summary_data, locationmode=\"country names\")%>%\r\n    add_trace(locations=~Country,\r\n             z=~mean,\r\n             color=~mean) %>%\r\n    layout(\r\n  title = with(summary_data, paste('Mean Life Expectancy')),\r\n  geo = g\r\n)\r\nplot\r\n\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4254543e4df0\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4254543e4df0\",\"attrs\":{\"4254543e4df0\":{\"locationmode\":\"country names\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"locations\":{},\"z\":{},\"color\":{},\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"mapType\":\"geo\",\"title\":\"Mean Life Expectancy\",\"geo\":{\"domain\":{\"x\":[0,1],\"y\":[0,1]},\"showframe\":true,\"showcoastlines\":true,\"projection\":{\"type\":\"Mercator\"}},\"scene\":{\"zaxis\":{\"title\":\"mean\"}},\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.5}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"colorbar\":{\"title\":\"mean\",\"ticklen\":2,\"len\":0.5,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666666\",\"rgba(70,19,97,1)\"],[\"0.0833333333333332\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666666\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":true,\"locationmode\":\"country names\",\"locations\":[\"Afghanistan\",\"Albania\",\"Algeria\",\"Angola\",\"Antigua and Barbuda\",\"Argentina\",\"Armenia\",\"Australia\",\"Austria\",\"Azerbaijan\",\"Bahamas\",\"Bahrain\",\"Bangladesh\",\"Barbados\",\"Belarus\",\"Belgium\",\"Belize\",\"Benin\",\"Bhutan\",\"Bolivia (Plurinational State of)\",\"Bosnia and Herzegovina\",\"Botswana\",\"Brazil\",\"Brunei Darussalam\",\"Bulgaria\",\"Burkina Faso\",\"Burundi\",\"CÃ´te d'Ivoire\",\"Cabo Verde\",\"Cambodia\",\"Cameroon\",\"Canada\",\"Central African Republic\",\"Chad\",\"Chile\",\"China\",\"Colombia\",\"Comoros\",\"Congo\",\"Costa Rica\",\"Croatia\",\"Cuba\",\"Cyprus\",\"Czechia\",\"Democratic People's Republic of Korea\",\"Democratic Republic of the Congo\",\"Denmark\",\"Djibouti\",\"Dominican Republic\",\"Ecuador\",\"Egypt\",\"El Salvador\",\"Equatorial Guinea\",\"Eritrea\",\"Estonia\",\"Ethiopia\",\"Fiji\",\"Finland\",\"France\",\"Gabon\",\"Gambia\",\"Georgia\",\"Germany\",\"Ghana\",\"Greece\",\"Grenada\",\"Guatemala\",\"Guinea\",\"Guinea-Bissau\",\"Guyana\",\"Haiti\",\"Honduras\",\"Hungary\",\"Iceland\",\"India\",\"Indonesia\",\"Iran (Islamic Republic of)\",\"Iraq\",\"Ireland\",\"Israel\",\"Italy\",\"Jamaica\",\"Japan\",\"Jordan\",\"Kazakhstan\",\"Kenya\",\"Kiribati\",\"Kuwait\",\"Kyrgyzstan\",\"Lao People's Democratic Republic\",\"Latvia\",\"Lebanon\",\"Lesotho\",\"Liberia\",\"Libya\",\"Lithuania\",\"Luxembourg\",\"Madagascar\",\"Malawi\",\"Malaysia\",\"Maldives\",\"Mali\",\"Malta\",\"Mauritania\",\"Mauritius\",\"Mexico\",\"Micronesia (Federated States of)\",\"Mongolia\",\"Montenegro\",\"Morocco\",\"Mozambique\",\"Myanmar\",\"Namibia\",\"Nepal\",\"Netherlands\",\"New Zealand\",\"Nicaragua\",\"Niger\",\"Nigeria\",\"Norway\",\"Oman\",\"Pakistan\",\"Panama\",\"Papua New Guinea\",\"Paraguay\",\"Peru\",\"Philippines\",\"Poland\",\"Portugal\",\"Qatar\",\"Republic of Korea\",\"Republic of Moldova\",\"Romania\",\"Russian Federation\",\"Rwanda\",\"Saint Lucia\",\"Saint Vincent and the Grenadines\",\"Samoa\",\"Sao Tome and Principe\",\"Saudi Arabia\",\"Senegal\",\"Serbia\",\"Seychelles\",\"Sierra Leone\",\"Singapore\",\"Slovakia\",\"Slovenia\",\"Solomon Islands\",\"Somalia\",\"South Africa\",\"South Sudan\",\"Spain\",\"Sri Lanka\",\"Sudan\",\"Suriname\",\"Swaziland\",\"Sweden\",\"Switzerland\",\"Syrian Arab Republic\",\"Tajikistan\",\"Thailand\",\"The former Yugoslav republic of Macedonia\",\"Timor-Leste\",\"Togo\",\"Tonga\",\"Trinidad and Tobago\",\"Tunisia\",\"Turkey\",\"Turkmenistan\",\"Uganda\",\"Ukraine\",\"United Arab Emirates\",\"United Kingdom of Great Britain and Northern Ireland\",\"United Republic of Tanzania\",\"United States of America\",\"Uruguay\",\"Uzbekistan\",\"Vanuatu\",\"Venezuela (Bolivarian Republic of)\",\"Viet Nam\",\"Yemen\",\"Zambia\",\"Zimbabwe\"],\"z\":[58.19375,75.15625,73.61875,49.01875,75.05625,75.15625,73.4,81.8125,81.48125,70.73125,74.2875,75.725,69.3,74.35625,69.90625,80.68125,69.26875,57.56875,66.1625,67.70625,75.96875,56.05,73.38125,76.4875,72.85,55.64375,55.5375,50.3875,72.51875,64.34375,54.01875,81.6875,48.5125,50.3875,79.45,74.2625,73.2875,61.58125,59.04375,78.59375,76.11875,77.975,79.675,76.76875,69.19375,55.6875,79.25625,60.75625,72.34375,74.725,71.5,71.74375,55.3125,60.6875,74.94375,59.1125,68.7125,80.7125,82.21875,62.24375,59.4625,73.50625,81.175,60.8625,81.21875,73.29375,71.73125,56.0125,55.36875,65.6375,59.86875,72.99375,73.825,82.44375,65.41875,67.55625,73.85625,70.35625,80.15,81.3,82.1875,74.29375,82.5375,72.9875,66.7625,57.48125,65.15,73.84375,69.08125,62.38125,73.73125,74.2,48.78125,57.525,72.4875,72.80625,80.78125,62.74375,49.89375,73.75625,75.5375,54.9375,80.3625,62.8,72.7125,75.71875,68.2,65.8875,74.5,72.15625,53.39375,64.2,60.4,66.48125,81.13125,81.3375,73.45,56.98125,51.35625,81.79375,74.84375,64.5,76.4875,61.68125,73.1125,73.6625,67.575,75.65,79.99375,77.03125,80.4875,69.98125,74.05,67.7625,59.3125,73.6,73.475,73.61875,65.1625,73.46875,62.56875,73.95625,72.375,46.1125,81.475,74.75,79.73125,67.7125,53.31875,57.5,53.875,82.06875,73.4,61.825,70.08125,51.325,82.51875,82.33125,70.85,66.65625,73.08125,74.1125,64.75625,56.6625,72.53125,71.06875,74.35625,73.9125,64.61875,55.70625,69.9375,75.7,80.79375,56.00625,78.0625,76.075,68.03125,71.3875,73.3875,74.775,63.8625,53.90625,50.4875],\"type\":\"choropleth\",\"marker\":{\"line\":{\"colorbar\":{\"title\":\"\",\"ticklen\":2},\"cmin\":46.1125,\"cmax\":82.5375,\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666666\",\"rgba(70,19,97,1)\"],[\"0.0833333333333332\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666666\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":false,\"color\":[58.19375,75.15625,73.61875,49.01875,75.05625,75.15625,73.4,81.8125,81.48125,70.73125,74.2875,75.725,69.3,74.35625,69.90625,80.68125,69.26875,57.56875,66.1625,67.70625,75.96875,56.05,73.38125,76.4875,72.85,55.64375,55.5375,50.3875,72.51875,64.34375,54.01875,81.6875,48.5125,50.3875,79.45,74.2625,73.2875,61.58125,59.04375,78.59375,76.11875,77.975,79.675,76.76875,69.19375,55.6875,79.25625,60.75625,72.34375,74.725,71.5,71.74375,55.3125,60.6875,74.94375,59.1125,68.7125,80.7125,82.21875,62.24375,59.4625,73.50625,81.175,60.8625,81.21875,73.29375,71.73125,56.0125,55.36875,65.6375,59.86875,72.99375,73.825,82.44375,65.41875,67.55625,73.85625,70.35625,80.15,81.3,82.1875,74.29375,82.5375,72.9875,66.7625,57.48125,65.15,73.84375,69.08125,62.38125,73.73125,74.2,48.78125,57.525,72.4875,72.80625,80.78125,62.74375,49.89375,73.75625,75.5375,54.9375,80.3625,62.8,72.7125,75.71875,68.2,65.8875,74.5,72.15625,53.39375,64.2,60.4,66.48125,81.13125,81.3375,73.45,56.98125,51.35625,81.79375,74.84375,64.5,76.4875,61.68125,73.1125,73.6625,67.575,75.65,79.99375,77.03125,80.4875,69.98125,74.05,67.7625,59.3125,73.6,73.475,73.61875,65.1625,73.46875,62.56875,73.95625,72.375,46.1125,81.475,74.75,79.73125,67.7125,53.31875,57.5,53.875,82.06875,73.4,61.825,70.08125,51.325,82.51875,82.33125,70.85,66.65625,73.08125,74.1125,64.75625,56.6625,72.53125,71.06875,74.35625,73.9125,64.61875,55.70625,69.9375,75.7,80.79375,56.00625,78.0625,76.075,68.03125,71.3875,73.3875,74.775,63.8625,53.90625,50.4875]}},\"geo\":\"geo\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nFigure 2: A geographic plot showing different\r\n\r\n\r\n\r\n#htmlwidgets::saveWidget(plot, \"plot2.html\")\r\n#IRdisplay::display_html(sprintf('<iframe src=\"plot2.html\" height=%d width=%d><\/iframe>', 600, 900))\r\n\r\n\r\n\r\nHere we see that sub-saharan african countries are amongst the lowest life expectancy regions while Canada, Europe and Australia amongst the highest.\r\nContinuous Variables\r\nTo demonstrate the correlation between continuous variables and life expectancy, we created a correlation map.\r\nHIV.AIDS VS life.expectancy\r\n\r\n\r\np<- data %>% \r\n  ggplot()+\r\n  geom_point(aes(HIV.AIDS, Life.expectancy, alpha=0.5,color=Status)) +\r\n  geom_smooth(aes(HIV.AIDS, Life.expectancy))+\r\n  labs(x=\"Deaths per 1000 births from AIDS\", Y=\"Life expectancy\")+\r\n  theme(legend.position = \"none\")\r\n\r\nggMarginal(p, type=\"histogram\", fill=\"slateblue\")\r\n\r\n\r\n\r\n\r\nIncome composition of resources vs life expectancy\r\n\r\n\r\np2<- data %>% \r\n  ggplot()+\r\n  geom_point(aes(Income.composition.of.resources, Life.expectancy,\r\n                 color=Country,\r\n                 fill=Status,alpha=0.01, size= GDP), shape=21)+\r\n  scale_size(range=c(.1, 6))+\r\n  \r\n   scale_fill_viridis(discrete=TRUE, guide=FALSE, option=\"A\") +\r\n    theme_ipsum() +\r\n    theme(legend.position=\"bottom\") +\r\n    ylab(\"Life Expectancy\") +\r\n    xlab(\"Income Composition\") +\r\n    theme(legend.position = \"none\")\r\nggMarginal(p2, type=\"density\", fill=\"grey\")\r\n\r\n\r\n\r\n\r\nIncome composition vs Adult Mortality\r\n\r\n\r\np3 <- data %>% \r\n  ggplot()+\r\n  geom_point(aes(Income.composition.of.resources, Adult.Mortality,\r\n                 color=Country,\r\n                 fill=Status,alpha=0.5, size= GDP), shape=21)+\r\n  scale_size(range=c(.1, 15))+\r\n  \r\n   scale_fill_viridis(discrete=TRUE, guide=FALSE, option=\"A\") +\r\n    theme_ipsum() +\r\n    theme(legend.position=\"bottom\") +\r\n    ylab(\"Adult Mortality\") +\r\n    xlab(\"Income Composition\") +\r\n    theme(legend.position = \"none\")\r\np3+\r\n  transition_time(Year)+\r\n  labs(title = \"Year: {frame_time}\")\r\n\r\n\r\n\r\n\r\nCorrelation matrix\r\n\r\n\r\ndata_num <- data %>% select(-Country, -Year, -Status)\r\n\r\ncorrgram(data_num, \r\n         order=NULL, \r\n         lower.panel=panel.shade, \r\n         upper.panel=panel.pie, \r\n         text.panel=panel.txt)\r\n\r\n\r\n\r\n\r\n(#fig:correlation matrix)Correlation Matrix\r\n\r\n\r\n\r\nObservations\r\nThe variables that life expectancy is most positively related are: schooling, and income composition of resources.\r\nThe variables most negatively associated with life expectancy are: adult mortality and HIV/AIDS.\r\nLife expectancy has a negligible relationship with Population, Total expenditure, under-five deaths and Measles.\r\nFrom the above observations, we would expect to see schooling, income composition of resources, adult mortality, and HIV/AIDS to have the largest impact in our linear model while Population, Total expenditure, under-five deaths and Measles are expected to have a smaller impact in the linear model.\r\nVariable Selection\r\nPreparing the data\r\nOur first step is to ensure all of our variables can be used in the regression and then splitting the dataset into testing and training sets. For this study, we will be using a proportion of 0.75. We will not be using the Country and Year categories in this model as our aim is to predict the life expectancy based on factors that are more general and not specific to a place or time. Furthermore, the Country variable has over 150 levels, which will make our model extremely large.\r\n\r\n\r\ndata <- data %>% \r\n    select(-Country) %>%\r\n    select(-Year) %>%\r\n    mutate(Status = if_else(Status == \"Developing\", 0, 1)) %>%\r\n    na.omit()\r\ndata$Status <- as.factor(data$Status)\r\n\r\n#splitting data into testing and training sets\r\nset.seed(123)\r\ninitial_split <- initial_split(data, prop = 0.75)\r\nexpectancy_train <- training(initial_split)\r\nexpectancy_test <- testing(initial_split)\r\n\r\n\r\nexpectancy_train %>% head(2) %>% kbl(caption = \"Table 3: First few contents of the training set\") %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nTable 1: Table 3: First few contents of the training set\r\n\r\n\r\n\r\n\r\nStatus\r\n\r\n\r\nLife.expectancy\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nHepatitis.B\r\n\r\n\r\nMeasles\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nPolio\r\n\r\n\r\nTotal.expenditure\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nGDP\r\n\r\n\r\nPopulation\r\n\r\n\r\nthinness..1.19.years\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nSchooling\r\n\r\n\r\n676\r\n\r\n\r\n1\r\n\r\n\r\n81.0\r\n\r\n\r\n54\r\n\r\n\r\n0\r\n\r\n\r\n9.04\r\n\r\n\r\n212.08593\r\n\r\n\r\n96\r\n\r\n\r\n0\r\n\r\n\r\n59.2\r\n\r\n\r\n0\r\n\r\n\r\n99\r\n\r\n\r\n7.46\r\n\r\n\r\n99\r\n\r\n\r\n0.1\r\n\r\n\r\n2797.967\r\n\r\n\r\n1143896\r\n\r\n\r\n0.9\r\n\r\n\r\n1.0\r\n\r\n\r\n0.850\r\n\r\n\r\n13.8\r\n\r\n\r\n799\r\n\r\n\r\n0\r\n\r\n\r\n74.4\r\n\r\n\r\n151\r\n\r\n\r\n8\r\n\r\n\r\n3.69\r\n\r\n\r\n18.26183\r\n\r\n\r\n82\r\n\r\n\r\n0\r\n\r\n\r\n45.8\r\n\r\n\r\n10\r\n\r\n\r\n97\r\n\r\n\r\n6.46\r\n\r\n\r\n87\r\n\r\n\r\n0.3\r\n\r\n\r\n244.469\r\n\r\n\r\n1328961\r\n\r\n\r\n1.5\r\n\r\n\r\n1.4\r\n\r\n\r\n0.679\r\n\r\n\r\n12.6\r\n\r\n\r\nexpectancy_test %>% head(2) %>% kbl(caption = \"Table 4: First few contents of the test set\") %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nTable 1: Table 4: First few contents of the test set\r\n\r\n\r\n\r\n\r\nStatus\r\n\r\n\r\nLife.expectancy\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nHepatitis.B\r\n\r\n\r\nMeasles\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nPolio\r\n\r\n\r\nTotal.expenditure\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nGDP\r\n\r\n\r\nPopulation\r\n\r\n\r\nthinness..1.19.years\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nSchooling\r\n\r\n\r\n3\r\n\r\n\r\n0\r\n\r\n\r\n59.9\r\n\r\n\r\n268\r\n\r\n\r\n66\r\n\r\n\r\n0.01\r\n\r\n\r\n73.21924\r\n\r\n\r\n64\r\n\r\n\r\n430\r\n\r\n\r\n18.1\r\n\r\n\r\n89\r\n\r\n\r\n62\r\n\r\n\r\n8.13\r\n\r\n\r\n64\r\n\r\n\r\n0.1\r\n\r\n\r\n631.7450\r\n\r\n\r\n31731688\r\n\r\n\r\n17.7\r\n\r\n\r\n17.7\r\n\r\n\r\n0.470\r\n\r\n\r\n9.9\r\n\r\n\r\n7\r\n\r\n\r\n0\r\n\r\n\r\n58.6\r\n\r\n\r\n281\r\n\r\n\r\n77\r\n\r\n\r\n0.01\r\n\r\n\r\n56.76222\r\n\r\n\r\n63\r\n\r\n\r\n2861\r\n\r\n\r\n16.2\r\n\r\n\r\n106\r\n\r\n\r\n63\r\n\r\n\r\n9.42\r\n\r\n\r\n63\r\n\r\n\r\n0.1\r\n\r\n\r\n445.8933\r\n\r\n\r\n284331\r\n\r\n\r\n18.6\r\n\r\n\r\n18.7\r\n\r\n\r\n0.434\r\n\r\n\r\n8.9\r\n\r\n\r\nBackward Selection\r\nWe will now be performing variable selection using regsubsets. Our nvmax is 19 as there are 19 remaining variables in the dataset.\r\n\r\n\r\n#Variable selection \r\n\r\nbackward_sel <- regsubsets(x=Life.expectancy ~.,data= expectancy_train, nvmax=19, method=\"backward\")\r\n\r\n#backward_sel\r\nback_summary <- summary(backward_sel)\r\n\r\nback_summary_df <- data.frame( \r\n   RSQ = back_summary$rsq,\r\n   RSS = back_summary$rss,\r\n   ADJ.R2 = back_summary$adjr2,\r\n   BIC = back_summary$bic\r\n)\r\nback_summary_df %>% head() %>% kbl(caption = \"Backward selection\") %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nTable 2: Backward selection\r\n\r\n\r\nRSQ\r\n\r\n\r\nRSS\r\n\r\n\r\nADJ.R2\r\n\r\n\r\nBIC\r\n\r\n\r\n0.5177821\r\n\r\n\r\n46475.58\r\n\r\n\r\n0.5173913\r\n\r\n\r\n-887.2486\r\n\r\n\r\n0.7279422\r\n\r\n\r\n26220.60\r\n\r\n\r\n0.7275009\r\n\r\n\r\n-1587.5926\r\n\r\n\r\n0.7898490\r\n\r\n\r\n20254.10\r\n\r\n\r\n0.7893372\r\n\r\n\r\n-1899.5934\r\n\r\n\r\n0.8105975\r\n\r\n\r\n18254.38\r\n\r\n\r\n0.8099821\r\n\r\n\r\n-2020.9589\r\n\r\n\r\n0.8145800\r\n\r\n\r\n17870.55\r\n\r\n\r\n0.8138263\r\n\r\n\r\n-2040.1052\r\n\r\n\r\n0.8249509\r\n\r\n\r\n16871.02\r\n\r\n\r\n0.8240963\r\n\r\n\r\n-2104.1260\r\n\r\n\r\n\r\n\r\n## Using Mallow's C_P to find the right number of inputs\r\nbackward_sel_candidate_models <- tibble(\r\n  n_input_variables = rep(1:19),\r\n  C_p =back_summary$cp\r\n)\r\ncat(\"The best number of predictors to be selected is \", backward_sel_candidate_models %>% filter(C_p==min(C_p)) %>% pull(n_input_variables))\r\n\r\n\r\nThe best number of predictors to be selected is  12\r\n\r\ncat(\"\\nTable 6\")\r\n\r\n\r\n\r\nTable 6\r\n\r\nbackward_sel_candidate_models %>% kbl(caption = \"Table 6\") %>%\r\n  kable_paper(\"hover\", full_width = F) %>% \r\n  row_spec(12, bold = T, color = \"white\", background = \"brown\")\r\n\r\n\r\n\r\nTable 3: Table 6\r\n\r\n\r\nn_input_variables\r\n\r\n\r\nC_p\r\n\r\n\r\n1\r\n\r\n\r\n2404.139354\r\n\r\n\r\n2\r\n\r\n\r\n821.437844\r\n\r\n\r\n3\r\n\r\n\r\n356.633125\r\n\r\n\r\n4\r\n\r\n\r\n202.179470\r\n\r\n\r\n5\r\n\r\n\r\n174.149690\r\n\r\n\r\n6\r\n\r\n\r\n97.948598\r\n\r\n\r\n7\r\n\r\n\r\n50.986642\r\n\r\n\r\n8\r\n\r\n\r\n19.934640\r\n\r\n\r\n9\r\n\r\n\r\n13.454595\r\n\r\n\r\n10\r\n\r\n\r\n11.985773\r\n\r\n\r\n11\r\n\r\n\r\n11.468809\r\n\r\n\r\n12\r\n\r\n\r\n9.988715\r\n\r\n\r\n13\r\n\r\n\r\n10.121462\r\n\r\n\r\n14\r\n\r\n\r\n11.148805\r\n\r\n\r\n15\r\n\r\n\r\n12.691486\r\n\r\n\r\n16\r\n\r\n\r\n14.287013\r\n\r\n\r\n17\r\n\r\n\r\n16.079369\r\n\r\n\r\n18\r\n\r\n\r\n18.017771\r\n\r\n\r\n19\r\n\r\n\r\n20.000000\r\n\r\n\r\n\r\n\r\nplot(back_summary$cp,\r\n    main = \"Cp for Backward Method using a Training Set\",\r\n  xlab = \"Number of Input Variables\", ylab = \"Cp\", type = \"b\", pch = 19,\r\n  col = \"red\")\r\n\r\n\r\n\r\n\r\nThe results of our backward selection tell us that the model with 12 variables is the best model, as it has the lowest \\(C_p\\) of 9.988715.\r\n\r\n\r\nback_summary %>% head(1) %>% kbl() %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n(Intercept)\r\n\r\n\r\nStatus1\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nHepatitis.B\r\n\r\n\r\nMeasles\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nPolio\r\n\r\n\r\nTotal.expenditure\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nGDP\r\n\r\n\r\nPopulation\r\n\r\n\r\nthinness..1.19.years\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nSchooling\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\n\r\nThe 12 variables include: Status, Adult.Mortality, infant.deaths, percentage.expenditure, BMI, under.five.deaths, Diphtheria, HIV.AIDS, thinness.5.9.years, Income.composition.of.resources, Schooling and Alcohol.\r\nObservations\r\nPolio and Hepatitis B are not included in this model while Diphtheria is. This suggests that Diphtheria affects life expectancy more than the other two diseases, which could be due to the fact that Diphtheria is more fatal in children (fatality rate is 5-10%, while Polio’s is 2-5% and Hepatitis B’ s is around 0.42 per 100000 population).\r\nThinness 5-9 years is selected, but not thinness 10-19 years. This could be due to the fact that thinness and malnutrition during childhood may lead to people dying earlier, and so it has a larger impact on life expectancy and was thus included in the model.\r\nWhile Status and percentage expenditure both impact life expectancy, GDP and total expenditure do not. This makes sense as GDP and total expenditure are both absolute measures, and do not consider population of a country, while percentage expenditure takes into account the differences between population and cost of living in different areas.\r\nForward Selection\r\nUsing the same methods, we will now be performing forward selection.\r\nTable 7\r\n\r\n\r\n### Forward selection\r\n\r\nforward_sel <- regsubsets(x=Life.expectancy ~.,data= expectancy_train, nvmax=19, method=\"forward\")\r\n\r\nforward_summary <- summary(forward_sel)\r\n\r\nforward_summary_df <- data.frame( \r\n   RSQ = forward_summary$rsq,\r\n   RSS = forward_summary$rss,\r\n   ADJ.R2 = forward_summary$adjr2,\r\n   BIC = forward_summary$bic\r\n)\r\nforward_summary_df %>% head() %>% kbl() %>% kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nRSQ\r\n\r\n\r\nRSS\r\n\r\n\r\nADJ.R2\r\n\r\n\r\nBIC\r\n\r\n\r\n0.5177821\r\n\r\n\r\n46475.58\r\n\r\n\r\n0.5173913\r\n\r\n\r\n-887.2486\r\n\r\n\r\n0.7279422\r\n\r\n\r\n26220.60\r\n\r\n\r\n0.7275009\r\n\r\n\r\n-1587.5926\r\n\r\n\r\n0.7898490\r\n\r\n\r\n20254.10\r\n\r\n\r\n0.7893372\r\n\r\n\r\n-1899.5934\r\n\r\n\r\n0.8105975\r\n\r\n\r\n18254.38\r\n\r\n\r\n0.8099821\r\n\r\n\r\n-2020.9589\r\n\r\n\r\n0.8161367\r\n\r\n\r\n17720.52\r\n\r\n\r\n0.8153893\r\n\r\n\r\n-2050.5256\r\n\r\n\r\n0.8216015\r\n\r\n\r\n17193.83\r\n\r\n\r\n0.8207306\r\n\r\n\r\n-2080.6997\r\n\r\n\r\nThe number of inputs with the minimal C_P is 12\r\n\r\n\r\n## Using Mallow's C_P to find the right number of inputs\r\nforward_sel_candidate_models <- tibble(\r\n  n_input_variables = rep(1:19),\r\n  C_p = forward_summary$cp\r\n)\r\n\r\nforward_sel_candidate_models %>% kbl %>% kable_paper(\"hover\", full_width=0) %>% row_spec(12, bold = T, color = \"white\", background = \"brown\")\r\n\r\n\r\n\r\nn_input_variables\r\n\r\n\r\nC_p\r\n\r\n\r\n1\r\n\r\n\r\n2404.139354\r\n\r\n\r\n2\r\n\r\n\r\n821.437844\r\n\r\n\r\n3\r\n\r\n\r\n356.633125\r\n\r\n\r\n4\r\n\r\n\r\n202.179470\r\n\r\n\r\n5\r\n\r\n\r\n162.411842\r\n\r\n\r\n6\r\n\r\n\r\n123.204489\r\n\r\n\r\n7\r\n\r\n\r\n106.087435\r\n\r\n\r\n8\r\n\r\n\r\n19.934640\r\n\r\n\r\n9\r\n\r\n\r\n13.454595\r\n\r\n\r\n10\r\n\r\n\r\n11.985773\r\n\r\n\r\n11\r\n\r\n\r\n11.468809\r\n\r\n\r\n12\r\n\r\n\r\n9.988715\r\n\r\n\r\n13\r\n\r\n\r\n10.121462\r\n\r\n\r\n14\r\n\r\n\r\n11.148805\r\n\r\n\r\n15\r\n\r\n\r\n12.691486\r\n\r\n\r\n16\r\n\r\n\r\n14.287013\r\n\r\n\r\n17\r\n\r\n\r\n16.079369\r\n\r\n\r\n18\r\n\r\n\r\n18.017771\r\n\r\n\r\n19\r\n\r\n\r\n20.000000\r\n\r\n\r\n\r\n\r\nplot(forward_summary$cp,\r\n    main = \"Cp for Forward Method using a Training Set\",\r\n  xlab = \"Number of Input Variables\", ylab = \"Cp\", type = \"b\", pch = 19,\r\n  col = \"red\")\r\n\r\n\r\n\r\n\r\nThe model size we get is the same for both forward and backward selection, and contains the same variables. Due to multicollinearity, we will be removing the Schooling and infant.deaths from our model. The covariates we will be using are listed below as stepwise_selection.\r\n\r\n\r\nstepwise_selection <- data %>%\r\n    select( -Hepatitis.B, -Measles, -Polio, -Total.expenditure, -GDP, \r\n           -Population, -thinness..1.19.years, -Schooling, -infant.deaths) %>%\r\n    names() \r\nstepwise_selection %>% kbl() %>% kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nx\r\n\r\n\r\nStatus\r\n\r\n\r\nLife.expectancy\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nBelow, we can find our model, and the summary of our model.\r\n\r\n\r\nMLR_expectancy <- lm(Life.expectancy ~ Status + Adult.Mortality + percentage.expenditure\r\n                     + BMI + under.five.deaths + Diphtheria + Alcohol + \r\n                     HIV.AIDS + thinness.5.9.years + Income.composition.of.resources, data = expectancy_train)\r\ntidy(MLR_expectancy, conf.int = TRUE) %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nterm\r\n\r\n\r\nestimate\r\n\r\n\r\nstd.error\r\n\r\n\r\nstatistic\r\n\r\n\r\np.value\r\n\r\n\r\nconf.low\r\n\r\n\r\nconf.high\r\n\r\n\r\n(Intercept)\r\n\r\n\r\n58.5126455\r\n\r\n\r\n0.7554403\r\n\r\n\r\n77.4550272\r\n\r\n\r\n0.0000000\r\n\r\n\r\n57.0305454\r\n\r\n\r\n59.9947456\r\n\r\n\r\nStatus1\r\n\r\n\r\n1.2412777\r\n\r\n\r\n0.4297390\r\n\r\n\r\n2.8884455\r\n\r\n\r\n0.0039396\r\n\r\n\r\n0.3981717\r\n\r\n\r\n2.0843837\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\n-0.0206131\r\n\r\n\r\n0.0011753\r\n\r\n\r\n-17.5392368\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.0229188\r\n\r\n\r\n-0.0183073\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\n0.0004885\r\n\r\n\r\n0.0000771\r\n\r\n\r\n6.3324696\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0003371\r\n\r\n\r\n0.0006398\r\n\r\n\r\nBMI\r\n\r\n\r\n0.0570020\r\n\r\n\r\n0.0074777\r\n\r\n\r\n7.6229339\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0423315\r\n\r\n\r\n0.0716725\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\n-0.0027101\r\n\r\n\r\n0.0007291\r\n\r\n\r\n-3.7169385\r\n\r\n\r\n0.0002108\r\n\r\n\r\n-0.0041405\r\n\r\n\r\n-0.0012796\r\n\r\n\r\nDiphtheria\r\n\r\n\r\n0.0274355\r\n\r\n\r\n0.0054988\r\n\r\n\r\n4.9893188\r\n\r\n\r\n0.0000007\r\n\r\n\r\n0.0166473\r\n\r\n\r\n0.0382236\r\n\r\n\r\nAlcohol\r\n\r\n\r\n-0.0119317\r\n\r\n\r\n0.0395812\r\n\r\n\r\n-0.3014486\r\n\r\n\r\n0.7631236\r\n\r\n\r\n-0.0895861\r\n\r\n\r\n0.0657227\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\n-0.4122371\r\n\r\n\r\n0.0211421\r\n\r\n\r\n-19.4983807\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.4537159\r\n\r\n\r\n-0.3707584\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\n-0.0340371\r\n\r\n\r\n0.0330401\r\n\r\n\r\n-1.0301765\r\n\r\n\r\n0.3031305\r\n\r\n\r\n-0.0988585\r\n\r\n\r\n0.0307843\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\n16.5937484\r\n\r\n\r\n0.8900820\r\n\r\n\r\n18.6429444\r\n\r\n\r\n0.0000000\r\n\r\n\r\n14.8474945\r\n\r\n\r\n18.3400023\r\n\r\n\r\n\r\n\r\nMLR_expectancy_2 <- lm(Life.expectancy ~ Status + Adult.Mortality + percentage.expenditure\r\n                    + BMI + under.five.deaths + Diphtheria + Alcohol + \r\n                    HIV.AIDS + thinness.5.9.years + Income.composition.of.resources + \r\n                      infant.deaths + Schooling, data = expectancy_train)\r\ntidy(MLR_expectancy_2, conf.int=TRUE) %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nterm\r\n\r\n\r\nestimate\r\n\r\n\r\nstd.error\r\n\r\n\r\nstatistic\r\n\r\n\r\np.value\r\n\r\n\r\nconf.low\r\n\r\n\r\nconf.high\r\n\r\n\r\n(Intercept)\r\n\r\n\r\n54.6706112\r\n\r\n\r\n0.7911543\r\n\r\n\r\n69.102340\r\n\r\n\r\n0.0000000\r\n\r\n\r\n53.1184413\r\n\r\n\r\n56.2227812\r\n\r\n\r\nStatus1\r\n\r\n\r\n0.7342522\r\n\r\n\r\n0.3916697\r\n\r\n\r\n1.874672\r\n\r\n\r\n0.0610761\r\n\r\n\r\n-0.0341668\r\n\r\n\r\n1.5026712\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\n-0.0177494\r\n\r\n\r\n0.0010812\r\n\r\n\r\n-16.415941\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.0198707\r\n\r\n\r\n-0.0156281\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\n0.0004508\r\n\r\n\r\n0.0000701\r\n\r\n\r\n6.431575\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0003133\r\n\r\n\r\n0.0005883\r\n\r\n\r\nBMI\r\n\r\n\r\n0.0339693\r\n\r\n\r\n0.0069625\r\n\r\n\r\n4.878866\r\n\r\n\r\n0.0000012\r\n\r\n\r\n0.0203095\r\n\r\n\r\n0.0476292\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\n-0.0749374\r\n\r\n\r\n0.0084056\r\n\r\n\r\n-8.915167\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.0914284\r\n\r\n\r\n-0.0584464\r\n\r\n\r\nDiphtheria\r\n\r\n\r\n0.0128051\r\n\r\n\r\n0.0050786\r\n\r\n\r\n2.521364\r\n\r\n\r\n0.0118163\r\n\r\n\r\n0.0028413\r\n\r\n\r\n0.0227689\r\n\r\n\r\nAlcohol\r\n\r\n\r\n-0.0814556\r\n\r\n\r\n0.0375585\r\n\r\n\r\n-2.168764\r\n\r\n\r\n0.0302928\r\n\r\n\r\n-0.1551419\r\n\r\n\r\n-0.0077693\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\n-0.4153210\r\n\r\n\r\n0.0191870\r\n\r\n\r\n-21.645997\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.4529641\r\n\r\n\r\n-0.3776780\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\n-0.0626015\r\n\r\n\r\n0.0301367\r\n\r\n\r\n-2.077252\r\n\r\n\r\n0.0379866\r\n\r\n\r\n-0.1217268\r\n\r\n\r\n-0.0034762\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\n9.2798242\r\n\r\n\r\n0.9431914\r\n\r\n\r\n9.838750\r\n\r\n\r\n0.0000000\r\n\r\n\r\n7.4293717\r\n\r\n\r\n11.1302768\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\n0.0986923\r\n\r\n\r\n0.0113129\r\n\r\n\r\n8.723857\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0764974\r\n\r\n\r\n0.1208871\r\n\r\n\r\nSchooling\r\n\r\n\r\n0.8770596\r\n\r\n\r\n0.0667411\r\n\r\n\r\n13.141222\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.7461199\r\n\r\n\r\n1.0079994\r\n\r\n\r\nAnalysing The Effect Of Multicollinearity\r\nFrom the correlation matrix above, we know that the pair of Schooling and Income.composition.of.resources as well as the pair under.five.deaths and infant.deaths are highly correlated. The first model MLR_expectancy adjusts for this by removing one variable each from both correlated pairs while MLR_expectancy_2 does not. The impact of not adjusting the model is a decrease in the magnitude of the coefficient estimate which is caused by the newly added correlated variable taking away some of its significance. In our models: \\(\\\\\\\\\\) Income.composition.of.resources : 16.6 (without) Income.composition.of.resources: 9.28 (with)under.five.deaths: -2.710e-03 (without)under.five.deaths: -7.494e-02 (with) Therefore, it is not ideal to include correlated covariates Schooling and infant.deaths in the model.\r\nBelow, we also do forward selection for interactive models, which we put a nvmax of 189 as those are the maximum number of interactions we can get.\r\n\r\n\r\nforward_int_sel <- regsubsets(x=Life.expectancy ~. ^2,data= expectancy_train, nvmax = 189, method=\"forward\")\r\n\r\n\r\nReordering variables and trying again:\r\n\r\nforward_int_summary <- summary(forward_int_sel)\r\n\r\nforward_int_sel_candidate_models <- tibble(\r\n  n_input_variables = rep(1:length(forward_int_summary$cp)),\r\n  C_p = forward_int_summary$cp\r\n)\r\nmin(forward_int_summary$cp) %>% kbl(caption = \"Min C_p\") %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nTable 4: Min C_p\r\n\r\n\r\nx\r\n\r\n\r\n105.696\r\n\r\n\r\nAs shown, the lowest \\(C_p\\) for the forward selection models with interaction are much higher than the ones for the additive models. This suggests that the models with interaction may not be as good as that without, and as there are an incredibly large number of variables, we will not be doing any interactive models.\r\nLASSO Model Selection\r\nWe will now be using LASSO to further see what model is the best when all the covariates are included. Below, we use cv.glmnet to find the smallest lambda to further create a model and do analysis.\r\n\r\n\r\nset.seed(123)\r\ncv_lambda_LASSO <- cv.glmnet(\r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 1,\r\n  lambda = exp(seq(-8, 3, 0.2)),\r\n  family = 'poisson'\r\n)\r\nlambda_min_MSE_LASSO <- round(cv_lambda_LASSO$lambda.min, 5)\r\n\r\nplot(cv_lambda_LASSO, main = \"Lambda selection by CV with LASSO\\n\\n\")\r\n\r\n\r\n\r\n\r\nFigure 3: TRUE\r\n\r\n\r\n\r\nplot(cv_lambda_LASSO$glmnet.fit, \"lambda\")\r\nabline(v = log(lambda_min_MSE_LASSO), col = \"red\", lwd = 3, lty = 2)\r\n\r\n\r\n\r\n\r\nFigure 4: TRUE\r\n\r\n\r\n\r\n\r\n\r\nlambda_min_MSE_LASSO %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nx\r\n\r\n\r\n0.00136\r\n\r\n\r\nThe smallest lambda we found from LASSO is 0.00136.\r\nRidge Model Selection\r\nWe will also be using ridge as a model selection method. Below, we perform ridge and find the smallest lambda for our models.\r\n\r\n\r\nset.seed(123)\r\n\r\ncv_lambda_RIDGE <- cv.glmnet(\r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 0,\r\n  lambda = exp(seq(-12, 10, 0.3)),\r\n  family = 'poisson'\r\n)\r\nlambda_min_MSE_RIDGE <- round(cv_lambda_RIDGE$lambda.min, 5)\r\nplot(cv_lambda_RIDGE, main = \"Lambda selection by CV with RIDGE\\n\\n\")\r\n\r\n\r\n\r\n\r\nFigure 5: TRUE\r\n\r\n\r\n\r\nplot(cv_lambda_RIDGE$glmnet.fit, \"lambda\")\r\n\r\nabline(v = log(lambda_min_MSE_RIDGE), col = \"red\", lwd = 3, lty = 2)\r\n\r\n\r\n\r\n\r\nFigure 6: TRUE\r\n\r\n\r\n\r\n\r\n\r\nlambda_min_MSE_RIDGE\r\n\r\n\r\n[1] 0.00335\r\n\r\nCross-Validation\r\nWe will now be performing cross-validation to test our predictive model. Below, we have a few different models. - model_5CV and model_holdout are the cross-validation with 5 folds and holdout models respectively built using the stepwise covariates found through the variable selection methods. - model_lasso_cv and model_lasso_holdout are the cross validation with 5 fold and holdout models built using lasso for the cross validation and the lambda found from LASSO for the holdout model. - model_ridge_cv and model_ridge_holdout are the cross validation with 5 fold and holdout models built using ridge for the cross validation and the lambda found from ridge for the holdout model. - Lastly, model_elastic is the cross validation done for 5-fold using the elastic method.\r\n\r\n\r\nset.seed(123)\r\nlambda <- 10^seq(-3, 3, length = 100)\r\n# define training control\r\ntrain_control <- trainControl(method=\"cv\", number = 5)\r\n\r\n# train the models\r\n#5 fold CV using stepwise covariates\r\nmodel_5CV <- train(Life.expectancy~., data = expectancy_train[,stepwise_selection], \r\n               trControl=train_control, method=\"lm\", preProcess = c(\"center\", \"scale\"))\r\n\r\n#stepwise covariates lm holdout\r\nmodel_holdout <- lm(Life.expectancy~., data = expectancy_train[,stepwise_selection]) \r\n\r\n#lasso with CV\r\nmodel_lasso_cv <- train(Life.expectancy~., data = expectancy_train[,-1], \r\n               trControl=train_control, method=\"glmnet\", preProcess = c(\"center\", \"scale\"),tuneGrid = expand.grid(alpha = 1, lambda = lambda))\r\n\r\n#ridge with CV\r\nmodel_ridge_cv <- train(Life.expectancy~., data = expectancy_train[,-1], \r\n               trControl=train_control, method=\"glmnet\", preProcess = c(\"center\", \"scale\"),tuneGrid = expand.grid(alpha = 0, lambda = lambda))\r\n\r\n#lasso holdout\r\nmodel_lasso_holdout <- glmnet( \r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 1,\r\n  lambda = lambda_min_MSE_LASSO\r\n)\r\n\r\n#ridge holdout\r\nmodel_ridge_holdout <- glmnet( \r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 0,\r\n  lambda = lambda_min_MSE_RIDGE\r\n)\r\n\r\n#elastic cv\r\nmodel_elastic <- train(\r\n  Life.expectancy ~., data = expectancy_train[,-1], method = \"glmnet\",\r\n  preProcess = c(\"center\", \"scale\"),\r\n  trControl = train_control,\r\n  tuneLength = 10\r\n  )\r\n\r\n\r\n\r\nIn order to test which model is the best, we will be finding the RMSE’s of the models and comparing.\r\n\r\n\r\nholdout.prediction <- predict(model_holdout, newdata = expectancy_test[,-2])\r\n\r\nholdout.rmse <- rmse(\r\n    preds = holdout.prediction,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nmodel.5CV.pred <- predict(model_5CV, newdata = expectancy_test[,-2])\r\n\r\nmodel.5CV.rmse <- rmse(\r\n    preds = model.5CV.pred,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nlasso.holdout.pred <- predict(model_lasso_holdout, newx = as.matrix(expectancy_test[,-c(1,2)]))\r\n\r\nlasso.cv.pred <- predict(model_lasso_cv, newx = as.matrix(expectancy_test[,-c(1,2)]))\r\n\r\nridge.holdout.pred <- predict(model_ridge_holdout, newx = as.matrix(expectancy_test[,-c(1,2)]))\r\n\r\nlasso.cv.pred <- predict(model_lasso_cv, model.matrix(Life.expectancy ~., expectancy_test)[,-c(1,2)])\r\nlasso.cv.rmse <- rmse(lasso.cv.pred,expectancy_test$Life.expectancy)\r\n\r\nridge.cv.pred <- predict(model_ridge_cv, model.matrix(Life.expectancy ~., expectancy_test)[,-c(1,2)])\r\nridge.cv.rmse <- rmse(ridge.cv.pred,expectancy_test$Life.expectancy)\r\n\r\nelastic.cv.pred <- predict(model_elastic, model.matrix(Life.expectancy ~., expectancy_test)[,-c(1,2)])\r\nelastic.cv.rmse <- rmse(elastic.cv.pred,expectancy_test$Life.expectancy)\r\n\r\nholdout.lasso.rmse <- rmse(\r\n    preds = lasso.holdout.pred,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nholdout.ridge.rmse <- rmse(\r\n    preds = ridge.holdout.pred,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nRMSE <- tibble(\r\n    Method = \"LM Hold-out\",\r\n    RMSE = holdout.rmse)\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"5 fold LM CV\",\r\n               RMSE = model.5CV.rmse))\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"LASSO CV\",\r\n               RMSE = lasso.cv.rmse))\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"RIDGE CV\",\r\n               RMSE = ridge.cv.rmse))\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"Elastic CV\",\r\n               RMSE = elastic.cv.rmse))\r\n\r\nRMSE <- rbind(RMSE, tibble(\r\n               Method = \"LASSO Hold-out\",\r\n               RMSE = holdout.lasso.rmse))\r\n\r\nRMSE <- rbind(RMSE, tibble(\r\n               Method = \"RIDGE Hold-out\",\r\n               RMSE = holdout.ridge.rmse))\r\nRMSE  %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nMethod\r\n\r\n\r\nRMSE\r\n\r\n\r\nLM Hold-out\r\n\r\n\r\n3.919471\r\n\r\n\r\n5 fold LM CV\r\n\r\n\r\n3.919471\r\n\r\n\r\nLASSO CV\r\n\r\n\r\n3.664512\r\n\r\n\r\nRIDGE CV\r\n\r\n\r\n3.720795\r\n\r\n\r\nElastic CV\r\n\r\n\r\n3.663028\r\n\r\n\r\nLASSO Hold-out\r\n\r\n\r\n3.667097\r\n\r\n\r\nRIDGE Hold-out\r\n\r\n\r\n3.663632\r\n\r\n\r\nWe can see that the model with the lowest RMSE is the elastic model with an RMSE of 3.663029. The coefficients for this model can be found below.\r\n\r\n\r\ncoef(model_elastic$finalModel, model_elastic$bestTune$lambda) \r\n\r\n\r\n19 x 1 sparse Matrix of class \"dgCMatrix\"\r\n                                          s1\r\n(Intercept)                      69.10258900\r\nAdult.Mortality                  -2.30326426\r\ninfant.deaths                    10.27596986\r\nAlcohol                          -0.28613317\r\npercentage.expenditure            0.62442166\r\nHepatitis.B                      -0.06411130\r\nMeasles                          -0.04012417\r\nBMI                               0.66222164\r\nunder.five.deaths               -10.55426961\r\nPolio                             0.27901943\r\nTotal.expenditure                 0.14502042\r\nDiphtheria                        0.18339641\r\nHIV.AIDS                         -2.68744580\r\nGDP                               0.19137946\r\nPopulation                        0.02274985\r\nthinness..1.19.years             -0.02926623\r\nthinness.5.9.years               -0.24398017\r\nIncome.composition.of.resources   1.74121425\r\nSchooling                         2.42970613\r\n\r\n\r\n\r\nmodel_elastic$bestTune %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\n\r\n\r\nalpha\r\n\r\n\r\nlambda\r\n\r\n\r\n11\r\n\r\n\r\n0.2\r\n\r\n\r\n0.0029358\r\n\r\n\r\nThis model is a convex combination of Ridge and LASSO. The equation to understand the alpha for this elastic model is \\(\\alpha \\times LASSO + (1-\\alpha) \\times RIDGE\\), which combines the L1 and L2 norms.\r\n\r\n\r\nggplot(varImp(model_elastic)) + ggtitle(\"Most important variables from elastic CV\") + labs(caption = \"Figure 10\") \r\n\r\n\r\n\r\n\r\nObservations\r\nThe most important variables we get from this are under five deaths, infant deaths, HIV/AIDS, Adult mortality, Income composition of variables, BMI and percentage expenditure.\r\nPopulation, thinness, Measles, Hepatitis B and total expenditure are less important.\r\nAlcohol and Polio are right in the middle of the variable importance graph.\r\nDiscussion\r\nResults and impacts\r\nIn our study we used variable selection methods (both forward and backward) to find that the best model is the one with 12 covariates. From there, we used those covariates to create cross-validation models with 5-fold and holdout models. Additionally, we performed LASSO and ridge and created 5-fold cross validation and hold-out models for the two. The last type of model we did was an elastic cross-validation model. We discovered by comparing RMSE that the best model is the elastic cross-validation, and thus found the coefficients for the specific model. Our findings help us see the best model in predicting life expectancy, thus also allowing us to see which factors affect life expectancy the most. Our analysis showed us that Under-five deaths, infant deaths, HIV/AIDS, Adult Mortality, Schooling and income composition of resources are the factors that affect life expectancy the most.\r\nAre the results what we expected?\r\nIt is unsurprising that a disease such as HIV/AIDS affect life expectancy. One could question why Measles was not equally as important, but a reason for this could be that there is a vaccine which is quite widespread, and so the disease is not as impactful anymore.\r\nSimilarly, infant deaths, under five deaths and adult mortality being the most important are also what we expected, as they directly involve life expectancy.\r\nOur variable selection methods suggest that Alcohol is an important aspect of our model, but the Important variables for our best model seem to suggest otherwise. We would expect Alcohol to be higher up on the important variables graph.\r\nImprovements that could be made\r\nThis study only takes into account additive models, and so, we are not able to explore the relationship between variables in the model. While we showed that the \\(C_p\\) is much higher with interactions, our model could be improved using interactions, so there is further room for improvement here.\r\nFuture questions/research\r\nOur results with this study hae allowed us to see the factors affecting life expectancy and the best way to predict life expectancy in any random country. In the future, this study could lead to questions about: - How can governments help in increasing life expectancy and what areas should they be focusing on specifically? - The data in this study predates Covid-19. How much does Covid-19 affect life expectancy and how much would it change our model? - As mentioned above, the data in this study is from 2000 - 2015. There have been multiple advancements in the medical field since then. Further, 15 years is also a long period of time. It would be interesting to explore how for different and shorter periods of time how life expectancy changes and how its changed over time.\r\nReferences\r\n\\(^{(1)}\\) World Health Organisation (WHO). (2018, February 10). Life expectancy (WHO). Kaggle. Retrieved November 6, 2021, from https://www.kaggle.com/kumarajarshi/life-expectancy-who.\r\n\\(^{(2)}\\) Tier 1-life expectancy and wellbeing-1.19 life expectancy at birth. Department of Health | Tier 1-Life expectancy and wellbeing-1.19 Life expectancy at birth. (n.d.). Retrieved November 6, 2021, from https://www1.health.gov.au/internet/publications/publishing.nsf/Content/oatsih-hpf-2012-toc~tier1~life-exp-wellb~119.\r\nNational Progress Report 2025 Goal: Reduce HBV Deaths. (2021, June 03). Retrieved from https://www.cdc.gov/hepatitis/policy/NPR/2021/NationalProgressReport-HepB-ReduceDeaths.htm\r\nClinical Features of Diphtheria. (2020, May 26). Retrieved from https://www.cdc.gov/diphtheria/clinicians.html\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-12-17-life-expectancy-analysis/life-expectancy-analysis_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2021-12-24T19:20:39-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-12-19-card-default-prediction/",
    "title": "Credit Card Default Prediction",
    "description": "This project uses the K-nearest Neighbour classification model to predict the likelihood of an individual in Taiwan to default on their next payment. The TidyModels package is used to build the model.",
    "author": [
      {
        "name": "Blaise Appolinary",
        "url": "https://ca.linkedin.com/in/blaise-appolinary-038a42179"
      },
      {
        "name": "Amogh Joshi",
        "url": {}
      }
    ],
    "date": "2021-12-17",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nMethods\r\nExploratory Data Analysis\r\nCorrelation network plot\r\n\r\nModelling\r\nTraining Vs Testing split\r\nSummary Statistics in Training set\r\n\r\nTraining\r\nFinding the best K for the model\r\n\r\nDiscussion\r\nRefferences\r\n\r\nIntroduction\r\nThe dataset we are using is an aggregate of credit card data from various individuals in Taiwan that includes variables such as education, age, whether or not they defaulted on a payment and others. Default on payment means that an individual did not pay their credit card bills. Our question for this data analytics project is: “How accurately can Education, and Age predict the likelihood of an individual defaulting on their next credit card payment?”\r\n Why did we choose these predictor variables over the numerous other variables in the data set? Our first objective was to eliminate those variables we felt did not contribute at all to the probability of default payments, such as sex. Next, we did some external research and found that of the remaining variables that we had access to in the dataset, age and education matched the best predictors of default probability from our external research (T. M. Alam et al., 2020). Thus, we will build our classification model on these two predictor models to determine the accuracy to which we can predict default probability. \r\n The dataset we will be using has 25 variables and 30002 records. The data set includes the variables we mentioned above and others such as the bill amounts each client has as well as the payments each client has made towards those bill amounts. Education is classified with numbers 1 (Graduate School), 2 (University), 3 (High School), and 4 (Others). Age is simply the numeric value of the individual’s age. The default payment variable is represented by 1’s (Yes, did default) and 0’s (No, did not default). \r\n We are interested in this question since credit card default is a real problem in the world, with credit card delinquency rates increasing by 0.180% year on year from 2017 to 2018, in Taiwan (CEIC, 2018). Using the models we create, we can determine the risk of lending credit to an individual with a high risk of default and therefore protect the creditors. \r\nMethods\r\nWe will be including the following columns: Education, Age and Default payment next month. We will conduct our data analysis using classification. Our classification will be done by creating a test set and a training set. Following this, we will begin to create a model that will tune the K nearest neighbors value we should use and a recipe that uses the straight line (“rectangular”) method to predict classifications. Following this we will fold the training set (most likely 10 times) to allow for a relatively accurate prediction of the K nearest neighbors value we should use. Using this, we will move forward with applying our model to our test set and predicting the classifications. \r\n We will create a bar chart that will depict the proportion of how many classifications were correctly predicted next to another bar that depicts the proportion of classifications that were incorrectly predicted. \r\nExpected outcomes and significance:   We expect to find that there is a correlation between the variables education, age and the classification of whether the individual defaulted. We expect to find that we will be able to get a fairly accurate accuracy. We define fairly accurate as an accuracy above 70%. Findings like this can allow credit card companies to apply higher late/default rates to customers who are more likely to default on payments based on our model and classification. Future questions would be: \r\n\r\n How can we make our predictions more accurate? \r\n\r\n\r\n Is it ethical to change rates/interest on individuals who have been classified by a model to be more likely to default? \r\n\r\nExploratory Data Analysis\r\n\r\n\r\ncredit<- read_excel(\"credit_card.xls\", skip = 1) %>% rename(default_payment_next_month= \"default payment next month\")\r\ncredit %>% head() %>%  rmarkdown::paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LIMIT_BAL\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SEX\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"EDUCATION\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"MARRIAGE\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AGE\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_0\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_2\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_3\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_4\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_5\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_6\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BILL_AMT1\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BILL_AMT2\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BILL_AMT3\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BILL_AMT4\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BILL_AMT5\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BILL_AMT6\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_AMT1\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_AMT2\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_AMT3\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_AMT4\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_AMT5\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PAY_AMT6\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"default_payment_next_month\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"20000\",\"3\":\"2\",\"4\":\"2\",\"5\":\"1\",\"6\":\"24\",\"7\":\"2\",\"8\":\"2\",\"9\":\"-1\",\"10\":\"-1\",\"11\":\"-2\",\"12\":\"-2\",\"13\":\"3913\",\"14\":\"3102\",\"15\":\"689\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"689\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"1\"},{\"1\":\"2\",\"2\":\"120000\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"26\",\"7\":\"-1\",\"8\":\"2\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"2\",\"13\":\"2682\",\"14\":\"1725\",\"15\":\"2682\",\"16\":\"3272\",\"17\":\"3455\",\"18\":\"3261\",\"19\":\"0\",\"20\":\"1000\",\"21\":\"1000\",\"22\":\"1000\",\"23\":\"0\",\"24\":\"2000\",\"25\":\"1\"},{\"1\":\"3\",\"2\":\"90000\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"34\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"29239\",\"14\":\"14027\",\"15\":\"13559\",\"16\":\"14331\",\"17\":\"14948\",\"18\":\"15549\",\"19\":\"1518\",\"20\":\"1500\",\"21\":\"1000\",\"22\":\"1000\",\"23\":\"1000\",\"24\":\"5000\",\"25\":\"0\"},{\"1\":\"4\",\"2\":\"50000\",\"3\":\"2\",\"4\":\"2\",\"5\":\"1\",\"6\":\"37\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"46990\",\"14\":\"48233\",\"15\":\"49291\",\"16\":\"28314\",\"17\":\"28959\",\"18\":\"29547\",\"19\":\"2000\",\"20\":\"2019\",\"21\":\"1200\",\"22\":\"1100\",\"23\":\"1069\",\"24\":\"1000\",\"25\":\"0\"},{\"1\":\"5\",\"2\":\"50000\",\"3\":\"1\",\"4\":\"2\",\"5\":\"1\",\"6\":\"57\",\"7\":\"-1\",\"8\":\"0\",\"9\":\"-1\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"8617\",\"14\":\"5670\",\"15\":\"35835\",\"16\":\"20940\",\"17\":\"19146\",\"18\":\"19131\",\"19\":\"2000\",\"20\":\"36681\",\"21\":\"10000\",\"22\":\"9000\",\"23\":\"689\",\"24\":\"679\",\"25\":\"0\"},{\"1\":\"6\",\"2\":\"50000\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\",\"6\":\"37\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"64400\",\"14\":\"57069\",\"15\":\"57608\",\"16\":\"19394\",\"17\":\"19619\",\"18\":\"20024\",\"19\":\"2500\",\"20\":\"1815\",\"21\":\"657\",\"22\":\"1000\",\"23\":\"1000\",\"24\":\"800\",\"25\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nCorrelation network plot\r\n\r\n\r\nnew_data <- credit %>% select(EDUCATION, AGE, default_payment_next_month)\r\ncor <- corrr::correlate(credit %>% select(-ID)) %>% \r\n  stretch()\r\ngraph_from_cor <- cor %>%  filter(abs(r) > 0.3) %>%\r\n  graph_from_data_frame(directed = FALSE)\r\nggraph(graph_from_cor) +\r\n  geom_edge_link()+\r\n  geom_node_point(color = \"brown\", size = 5) +\r\n  geom_node_text(aes(label = name), repel = TRUE) +\r\n  theme_graph() +\r\n  labs(title = \"Correlations Network Plot\")\r\n\r\n\r\n\r\n\r\nFigure 1: Correlation plot between different variables\r\n\r\n\r\n\r\nModelling\r\nTraining Vs Testing split\r\n Once we read the file into our Jupyter Notebook we made sure that the data was clean. To make sure it was clean we double checked that there were no N/A values, there were none. We identified our variable that would be our classifier for our prediction and converted it into a factor to ensure we would be able to classify it. The next step was to split the large data set into our training and test set. We did this because we want to make sure that we do not use the testing dataset at all until the very end once we have created our models, recipes and found the most accurate K nearest neighbors value. We split the data sets as 75% training and 25% training. We set the strata equal to our classification variable, “default_payment_next_month”. Next, we finalized the split of the data into two different data sets; credit_train and credit_test. \r\n\r\n\r\nset.seed(1234)\r\ntidied_credit_card <- credit %>% \r\n                    select(EDUCATION, AGE, default_payment_next_month) %>%\r\n                    mutate(default_payment_next_month = as_factor(default_payment_next_month)) %>%\r\n                    filter(EDUCATION == c(1,2,3,4))\r\ncredit_split <- initial_split(tidied_credit_card, prop = 0.75, strata = default_payment_next_month)\r\ncredit_train <- training(credit_split)\r\ncredit_test <- testing(credit_split)\r\ncredit_train %>% head %>% kbl() %>% \r\n  kable_paper(\"hover\",full_width=F)\r\n\r\n\r\n\r\nEDUCATION\r\n\r\n\r\nAGE\r\n\r\n\r\ndefault_payment_next_month\r\n\r\n\r\n1\r\n\r\n\r\n23\r\n\r\n\r\n0\r\n\r\n\r\n1\r\n\r\n\r\n32\r\n\r\n\r\n0\r\n\r\n\r\n2\r\n\r\n\r\n54\r\n\r\n\r\n0\r\n\r\n\r\n2\r\n\r\n\r\n22\r\n\r\n\r\n0\r\n\r\n\r\n1\r\n\r\n\r\n30\r\n\r\n\r\n0\r\n\r\n\r\n2\r\n\r\n\r\n39\r\n\r\n\r\n0\r\n\r\n\r\nSummary Statistics in Training set\r\n\r\n\r\nskim_without_charts(credit_train)\r\n\r\n\r\n\r\nTable 1: Data summary\r\n\r\n\r\n\r\n\r\n\r\n\r\nName\r\n\r\n\r\ncredit_train\r\n\r\n\r\nNumber of rows\r\n\r\n\r\n5523\r\n\r\n\r\nNumber of columns\r\n\r\n\r\n3\r\n\r\n\r\n_______________________\r\n\r\n\r\n\r\n\r\nColumn type frequency:\r\n\r\n\r\n\r\n\r\nfactor\r\n\r\n\r\n1\r\n\r\n\r\nnumeric\r\n\r\n\r\n2\r\n\r\n\r\n________________________\r\n\r\n\r\n\r\n\r\nGroup variables\r\n\r\n\r\nNone\r\n\r\nVariable type: factor\r\n\r\nskim_variable\r\n\r\n\r\nn_missing\r\n\r\n\r\ncomplete_rate\r\n\r\n\r\nordered\r\n\r\n\r\nn_unique\r\n\r\n\r\ntop_counts\r\n\r\n\r\ndefault_payment_next_month\r\n\r\n\r\n0\r\n\r\n\r\n1\r\n\r\n\r\nFALSE\r\n\r\n\r\n2\r\n\r\n\r\n0: 4305, 1: 1218\r\n\r\nVariable type: numeric\r\n\r\nskim_variable\r\n\r\n\r\nn_missing\r\n\r\n\r\ncomplete_rate\r\n\r\n\r\nmean\r\n\r\n\r\nsd\r\n\r\n\r\np0\r\n\r\n\r\np25\r\n\r\n\r\np50\r\n\r\n\r\np75\r\n\r\n\r\np100\r\n\r\n\r\nEDUCATION\r\n\r\n\r\n0\r\n\r\n\r\n1\r\n\r\n\r\n1.81\r\n\r\n\r\n0.71\r\n\r\n\r\n1\r\n\r\n\r\n1\r\n\r\n\r\n2\r\n\r\n\r\n2\r\n\r\n\r\n4\r\n\r\n\r\nAGE\r\n\r\n\r\n0\r\n\r\n\r\n1\r\n\r\n\r\n35.47\r\n\r\n\r\n9.16\r\n\r\n\r\n21\r\n\r\n\r\n28\r\n\r\n\r\n34\r\n\r\n\r\n42\r\n\r\n\r\n75\r\n\r\n\r\n In order to get a sense for the training dataset and to understand it more thoroughly, we did some preliminary data analysis. We firstly noticed that the dataset had more choices for education than what was stated on the website, so rather than there just being 4 choices, there were 6. Therefore, since we did not know what the extra choices referred to (and with the help of a TA who advised us to do the same), we filtered out said choices. The impact of this filtering was very minor since it only affected about 20 data samples. \r\n\r\n\r\ncredit_summarize <- credit_train %>%\r\n                    group_by(EDUCATION, AGE, default_payment_next_month) %>%\r\n                    summarize(n = n()) \r\ncredit_summarize %>% data.table()\r\n\r\n\r\n     EDUCATION AGE default_payment_next_month  n\r\n  1:         1  21                          0  2\r\n  2:         1  22                          0 18\r\n  3:         1  22                          1  6\r\n  4:         1  23                          0 47\r\n  5:         1  23                          1 12\r\n ---                                            \r\n281:         4  44                          1  1\r\n282:         4  48                          0  1\r\n283:         4  49                          0  1\r\n284:         4  50                          0  1\r\n285:         4  52                          0  1\r\n\r\n Next, we graphed the filtered data to understand how the data was balanced. We wanted to see if there was an obvious correlation between the variables, and as such, grouped the observations and graphed them using a barchart. We did separate graphs for education and age in order to isolate so we can gain a better understanding of how the variable impacts risk of credit default. \r\n\r\n\r\ncredit_education_graph <- ggplot(credit_summarize, aes(x = EDUCATION, y = n, fill = default_payment_next_month)) +\r\n                geom_bar(stat = \"identity\", position = \"fill\") +\r\n                labs(x = \"Education\", y = \"Default Payment\", title = \"Education VS Default Payment\", fill = \"Defaulted on Payment\") +\r\n                theme(text = element_text(size=20))\r\ncredit_education_graph\r\n\r\n\r\n\r\n\r\nFigure 2:  Distrubution of Default Payment for Education. This graph shows the distribution between each education level and the number of default payments 1 (Yes) and 0 (No) in the training data set. The graph shows that Education levels 2 and 3 have the highest default rate.\r\n\r\n\r\n\r\n\r\n\r\nset.seed(1234)\r\ncredit_sex_graph <- ggplot(credit_summarize, aes(x = AGE, y = n, fill = default_payment_next_month)) +\r\n                geom_bar(stat = \"identity\", position = \"fill\") +\r\n                labs(x = \"Age\", y = \"Default Payment\", title = \"Default Payment vs Age\", fill = \"Defaulted on Payment\") +\r\n                theme(text = element_text(size=20))\r\ncredit_sex_graph\r\n\r\n\r\n\r\n\r\nFigure 3: Figure 2: Distrubution of Default Payment for Age. This graph shows the distribution between each age and the number of default payments 1 (Yes) and 0 (No) in the training data set. The graph shows that older ages around 60+ have a higher rate of default payment, which could be attributed to smaller amounts of data points from the age range.\r\n\r\n\r\n\r\nTraining\r\nThe next step of our analysis was building our recipe, model and workflow. For our model we used the rectangular method of prediction and tuned our neighbors function. We used tune instead of placing an arbitrary number because we are trying to determine, with the tune function, what the most accurate K nearest neighbors value is. Next, for our recipe, we identified the variable we are trying to predict (default_payment_next_month) and our predictor variables (EDUCATION and AGE). We are building the recipe on our training data set, because as we previously mentioned, we do not want to touch the test set at all until the final analysis/prediction/classification. For our recipe, we also scaled and centered all of our predictor variables. Following the recipe, we created our vfold function. We created the vfold function so that we can get a better K nearest neighbors value estimate by splitting the data multiple ways and averaging the results. We decided to fold the data set 5 times, anymore than this and we found we were waiting for significant amounts of time for the Jupyter Notebook to run. To effectively use our vfold function, we decided to create a tible with the sequences 1 through 200 for K nearest values 1 through 200. We will use this in our workflow to find the most accurate K nearest neighbors value. Lastly, we were putting the model, recipe and vfold functions all together into our workflow. We added the recipe, then the model. Following this, we added a tune_grid function which included our vfold function as well as the grid tibble we previously mentioned. To conclude our workflow, we are collecting the metrics with; collect_metrics().\r\n\r\n\r\nset.seed(1234)\r\nknn_spec <- nearest_neighbor(weight_func = \"rectangular\", neighbors = tune()) %>%\r\n      set_engine(\"kknn\") %>%\r\n      set_mode(\"classification\")\r\ncredit_recipe <- recipe(default_payment_next_month ~ EDUCATION + AGE, data = credit_train) %>%\r\n                step_scale(all_predictors()) %>%\r\n                step_center(all_predictors())\r\ncredit_vfold <- vfold_cv(credit_train, v = 5, strata = default_payment_next_month)\r\ngridvals = tibble(neighbors = seq(1,50))\r\n\r\ncredit_fit <- workflow() %>%\r\n      add_recipe(credit_recipe) %>%\r\n      add_model(knn_spec) %>%\r\n      tune_grid(resamples = credit_vfold, grid = 100) %>%\r\n        collect_metrics()\r\ncredit_fit %>% data.table()\r\n\r\n\r\n    neighbors  .metric .estimator      mean n      std_err\r\n 1:         1 accuracy     binary 0.7778381 5 0.0010189829\r\n 2:         1  roc_auc     binary 0.5013076 5 0.0014980903\r\n 3:         2 accuracy     binary 0.7785622 5 0.0004796293\r\n 4:         2  roc_auc     binary 0.5011568 5 0.0015609007\r\n 5:         3 accuracy     binary 0.7782004 5 0.0011382331\r\n 6:         3  roc_auc     binary 0.5031854 5 0.0005344724\r\n 7:         4 accuracy     binary 0.7780192 5 0.0011214818\r\n 8:         4  roc_auc     binary 0.5044075 5 0.0015017582\r\n 9:         5 accuracy     binary 0.7771139 5 0.0010459038\r\n10:         5  roc_auc     binary 0.5061534 5 0.0012881664\r\n11:         6 accuracy     binary 0.7780191 5 0.0010543830\r\n12:         6  roc_auc     binary 0.5039148 5 0.0010771440\r\n13:         7 accuracy     binary 0.7772949 5 0.0010336610\r\n14:         7  roc_auc     binary 0.5049822 5 0.0039082790\r\n15:         8 accuracy     binary 0.7778384 5 0.0007697558\r\n16:         8  roc_auc     binary 0.5031737 5 0.0016971696\r\n17:         9 accuracy     binary 0.7782000 5 0.0007712707\r\n18:         9  roc_auc     binary 0.5020524 5 0.0026117206\r\n19:        10 accuracy     binary 0.7782000 5 0.0007712707\r\n20:        10  roc_auc     binary 0.5042900 5 0.0018335397\r\n21:        11 accuracy     binary 0.7787437 5 0.0005887663\r\n22:        11  roc_auc     binary 0.5074889 5 0.0043046895\r\n23:        12 accuracy     binary 0.7789247 5 0.0005055621\r\n24:        12  roc_auc     binary 0.5098753 5 0.0028675090\r\n25:        13 accuracy     binary 0.7791057 5 0.0002574148\r\n26:        13  roc_auc     binary 0.5093868 5 0.0040229852\r\n27:        14 accuracy     binary 0.7791057 5 0.0002574148\r\n28:        14  roc_auc     binary 0.5106601 5 0.0029876314\r\n29:        15 accuracy     binary 0.7794678 5 0.0001728811\r\n30:        15  roc_auc     binary 0.5136957 5 0.0031531812\r\n    neighbors  .metric .estimator      mean n      std_err\r\n                  .config\r\n 1: Preprocessor1_Model01\r\n 2: Preprocessor1_Model01\r\n 3: Preprocessor1_Model02\r\n 4: Preprocessor1_Model02\r\n 5: Preprocessor1_Model03\r\n 6: Preprocessor1_Model03\r\n 7: Preprocessor1_Model04\r\n 8: Preprocessor1_Model04\r\n 9: Preprocessor1_Model05\r\n10: Preprocessor1_Model05\r\n11: Preprocessor1_Model06\r\n12: Preprocessor1_Model06\r\n13: Preprocessor1_Model07\r\n14: Preprocessor1_Model07\r\n15: Preprocessor1_Model08\r\n16: Preprocessor1_Model08\r\n17: Preprocessor1_Model09\r\n18: Preprocessor1_Model09\r\n19: Preprocessor1_Model10\r\n20: Preprocessor1_Model10\r\n21: Preprocessor1_Model11\r\n22: Preprocessor1_Model11\r\n23: Preprocessor1_Model12\r\n24: Preprocessor1_Model12\r\n25: Preprocessor1_Model13\r\n26: Preprocessor1_Model13\r\n27: Preprocessor1_Model14\r\n28: Preprocessor1_Model14\r\n29: Preprocessor1_Model15\r\n30: Preprocessor1_Model15\r\n                  .config\r\n\r\nFinding the best K for the model\r\nAfter graphing our findings to find the best K value, we decided on the best K as 15. We chose the K value with the highest accuracy.\r\n\r\n\r\nset.seed(1234)\r\naccuracies <- credit_fit %>% \r\n      filter(.metric == \"accuracy\")\r\n\r\naccuracy_versus_k <- ggplot(accuracies, aes(x = neighbors, y = mean))+\r\n      geom_point() +\r\n      geom_line() +\r\n      labs(x = \"Number of Neighbors\", y = \"Accuracy Estimate\", title = \"K Vs Accuracy\") +\r\n      scale_x_continuous(breaks = seq(0, 20, by = 1)) +\r\n        theme(text = element_text(size=20))\r\naccuracy_versus_k\r\n\r\n\r\n\r\n\r\nFigure 4: The graph shows that the K with the highest accuracy estimate is 15, which is the K we chose. Although we tuned with grid = 100, the K values only went up to 15. We asked a TA on how to fix this, but they didn’t know so we stuck with the choice of K = 15.\r\n\r\n\r\n\r\n Following this, we took our new K value and built out our new model spec with the K value set to 15. We used the same recipe as before and then added the recipe and new model to a workflow and fit the training data. Next, we began predicting our test set with this final model and binded the columns so that we would be able to see the predicted class and the true class of the test data set. Next we made a confusion matrix which included the true classifier values as well as the predicted classifier values from our dataset. With these predictions we were able to predict the accuracy of our model which was 77.9%. \r\n\r\n\r\nset.seed(1234)\r\nknn_final <- nearest_neighbor(weight_func = \"rectangular\", neighbors = 15) %>%\r\n      set_engine(\"kknn\") %>%\r\n      set_mode(\"classification\")\r\ncredit_final = workflow() %>%\r\n      add_recipe(credit_recipe) %>%\r\n      add_model(knn_final) %>%\r\n      fit(data = credit_train)\r\n\r\n\r\n\r\n\r\n\r\nset.seed(1234)\r\ncredit_predictions = predict(credit_final, credit_test) %>%\r\n      bind_cols(credit_test)\r\ncredit_metrics <- credit_predictions %>%\r\n        metrics(truth = default_payment_next_month, estimate = .pred_class) \r\ncredit_conf_mat <- credit_predictions %>%\r\n        conf_mat(truth = default_payment_next_month, estimate = .pred_class) \r\n#credit_predictions\r\n#credit_metrics\r\ncredit_conf_mat \r\n\r\n\r\n          Truth\r\nPrediction    0    1\r\n         0 1434  406\r\n         1    2    0\r\n\r\nAccuracy\r\n\r\n\r\naccuracy <- slice(credit_metrics, 1) %>% pull(3)\r\naccuracy\r\n\r\n\r\n[1] 0.7785016\r\n\r\nMetric confusion matrix\r\nThe prediction, metrics, and confusion matrix’s results on the testing set, producing an accuracy of about 78%.\r\n\r\n\r\nctable <- as.table(matrix(c(1436, 406, 0, 0), nrow = 2, byrow = TRUE))\r\nfourfoldplot(ctable, color = c(\"#CC6666\", \"#99CC99\"),\r\n             conf.level = 0, margin = 1, main = \"Confusion Matrix\")\r\n\r\n\r\n\r\n\r\nFigure 5: Confusion Matrix Graph. This graph shows the finding of our confusion matrix, which proportionally shows correctly classified vs incorrectly classified.\r\n\r\n\r\n\r\nAccuracy Pie Chart\r\n\r\n\r\ndf <- data.frame(\r\n  group = c(\"Percent Correct\", \"Percent Incorrect\"),\r\n  value = c(accuracy * 100, 100 - (accuracy * 100))\r\n  )\r\nbp<- ggplot(df, aes(x=\"\", y=value, fill=group))+\r\ngeom_bar(width = 1, stat = \"identity\") +\r\nggtitle(\"Accuracy Pie Chart\") +\r\nlabs(fill = \"Percent Correct and Incorrect\")\r\n\r\npie <- bp + coord_polar(\"y\", start=0)\r\npie <- pie + scale_fill_manual(values=c(\"#99CC99\", \"#CC6666\")) + theme(text = element_text(size=20))\r\npie\r\n\r\n\r\n\r\n\r\nFigure 6:  Summary Pie Chart Of Our Finding. This pie chart summarizes the accuracy of our findings, which is correct about 78% of the time.\r\n\r\n\r\n\r\nDiscussion\r\n​  Our final accuracy from our tuned model was 77.9%. From the final graphs that we plotted, we found that our classification analysis had a fairly high accuracy with the predictor values that we chose. Although the accuracy is fairly high, there is most definitely room for improvement. If you reference the pie chart, on average, our model correctly predicts the likelihood of credit card default approximately 3 out 4 times. With this fairly high accuracy, it is safe to say that the education level an individual has and their age does play a role in their likelihood to default.  ​  The accuracy we achieved from our model exceeded what was predicted; as stated in our introduction, we thought that the model would be about 70% accurate, however, it was closer to a 77.9% accuracy rate. Since the accuracy was higher than 50% (based on randomly selecting credit risk), it can be confidently stated that there is a correlation between an individual’s education and age, and their credit default risk.  ​  The impact of the findings within this report are of great consequence to the financial industry. Given that our model was able to predict credit card default fairly accurately, banks and other financial institutions can both use our model, and build on it to improve it, to further mitigate their risk. As lending money to individuals has its inherent risk, it is absolutely imperative that these financial institutions mitigate as much risk as possible to ensure secure cash flows and revenue from their credit card business.  ​  Due to the onset of COVID-19, the economic realities are much different than in 2016, the year in which the data set was donated. Due to this, a potential further question that would be very interesting to investigate is if the created model is still relevant today? Since unemployment rates at the height of lockdowns was about 4.1%, the highest it has been in over 6 years (Reuters, 2020). While we have not shown that credit card default and unemployment are correlated, the two variables have been linked in other articles (Bai, 2016). As such, investigating if the model holds in times of economic depression would be a question to investigate in the future. \r\n However, one of the questions that we feel is most critical in investigating is whether or not using predictive modelling to determine the risk of an individual in defaulting is ethical. The availability of credit has been linked to increased economic output, and the ability to achieve a higher quality of life (Proctor & Anand, 2017, 322-346). As such, if the predictive model is not entirely accurate or has inherent biases present (such as giving different risk scores for different races, sex, etc.), it could lead to a negative feedback loop for individuals already experiencing economic hardship with no escape from poverty through credit. As such, more research needs to be conducted into the ethical realities of using a model to judge a person’s credit risk.\r\nRefferences\r\n​  Alam, Talha Mahboob, et al. “An Investigation of Credit Card Default Prediction in the Imbalanced Datasets.” IEEE Xplore, IEEE, 26 Oct. 2020, ieeexplore.ieee.org/document/9239944?fbclid=IwAR3zMjKdc4EdLV5A4r5RRW_BFy1VnOY9QQewm8qRdsYTlPFBCMurTpU6DA0.  ​  Bai, H. (2016). Unemployment and Credit Risk. Supply and Demand eJournal. https://www.semanticscholar.org/paper/Unemployment-and-Credit-Risk-Bai/375a7d56701fe8ec018feb308669e7baa9322cbd#paper-header CEIC. (2018, May). Taiwan: Credit CARD STATISTICS: CEIC. Retrieved March 12, 2021, from https://www.ceicdata.com/en/taiwan/credit-card-statistics  ​  Proctor, J., & Anand, P. (2017, September 6). Is credit associated with a higher quality of life? A capability approach. Progress in Development Studies, 17(4), 322 - 346. https://journals-sagepub-com.ezproxy.library.ubc.ca/doi/full/10.1177/1464993417716359?utm_source=summon&utm_medium=discovery-provider  ​  Reuters Staff. (2020, May 22). Taiwan jobless rate spikes to six year high on virus impact. Reuters. https://www.reuters.com/article/healthcoronavirus-taiwan-unemployment-idUSL4N2C90Z4 \r\n\r\n\r\n\r\n",
    "preview": "posts/2021-12-19-card-default-prediction/card-default-prediction_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-01-14T12:10:13-08:00",
    "input_file": "card-default-prediction.knit.md"
  }
]
