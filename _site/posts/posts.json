[
  {
    "path": "posts/2021-12-17-life-expectancy-analysis/",
    "title": "Life Expectancy Analysis",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Blaise Appolinary",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-12-17",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nLoading necessary packages for the Analysis\r\nLoading Dataset from github\r\n\r\nExploratory Data Analysis\r\nData preview and cleaning\r\nVariable Corelation\r\nCategorical Variables\r\nContinuous Variables\r\n\r\n\r\nVariable Selection\r\nPreparing the data\r\nBackward Selection\r\nForward Selection\r\nLASSO Model Selection\r\nRidge Model Selection\r\nCross-Validation\r\n\r\nDiscussion\r\nResults and impacts\r\nAre the results what we expected?\r\nImprovements that could be made\r\nFuture questions/research\r\n\r\nReferences\r\n\r\nIntroduction\r\nLife expectancy is an estimate of how long a person would live on average. Throughout the years, there have been lot of studies on factors affecting life expectancy. However, these studies have not taken into account the possibility that human development index could have a significant effect. Additionally, past studies were conducted using multiple linear regressions based on world data for only one year. Therefore, there is reason to consider global data from 2000 to 2015 instead. This project relies heavily on the accuracy of the data which is provided by the Global Health Observatory (GHO) data repository under World Health Organization (WHO)\\(^{(1)}\\). Our goal is to determine the most significant variables to create an optimal linear regression model for predicting life expectancy. For instance, if current mortality rates in every age group remained constant throughout, then it would be an easily understood measure to which any person could directly relate \\(^{(2)}\\). In reality, life expectancy is affected by a variety of socioeconomic, genetic and environmental factors. Therefore, it makes for a good area of study to investigate via statistical methods to better understand the measure of life expectancy.\r\nLoading necessary packages for the Analysis\r\n\r\n\r\nShow code\r\n\r\nlibrary(hrbrthemes)\r\nlibrary(kableExtra)\r\nlibrary(ggstar)\r\nlibrary(viridis)\r\nlibrary(ggExtra)\r\nlibrary(plotly)\r\nlibrary(ggstatsplot)\r\nlibrary(patchwork)\r\nlibrary(leaps)\r\nlibrary(gganimate)\r\nlibrary(tidyverse)\r\nlibrary(tidymodels)\r\nlibrary(corrr)\r\nlibrary(mltools)\r\nlibrary(ggplot2)\r\nlibrary(elasticnet)\r\nlibrary(plotly)\r\nlibrary(caret)\r\nlibrary(tidygeocoder)\r\nlibrary(glmnet)\r\nlibrary(GGally)\r\nlibrary(DT)\r\nlibrary(broom)\r\nlibrary(corrgram)\r\noptions(repr.plot.width = 8, repr.plot.height = 8)\r\nlibrary(knitr)\r\n\r\n\r\n\r\nLoading Dataset from github\r\n\r\n\r\nShow code\r\n\r\ndata <- read.csv(\"https://raw.githubusercontent.com/zackhamza01/Life-Expectancy/main/Life%20Expectancy%20Data.csv\")\r\n\r\n\r\n\r\nExploratory Data Analysis\r\nTo begin with, we first performed some data cleaning and exploration. The exploration was very necessary for us to have a deeper understanding of the dataset before the process of gaining insights from it.\r\nData preview and cleaning\r\nTable 1\r\n\r\n\r\nShow code\r\n\r\ndata %>% head(3) %>% rmarkdown::paged_table()\r\n\r\n\r\n\r\n\r\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Country\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Year\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Status\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Life.expectancy\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Adult.Mortality\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"infant.deaths\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Alcohol\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"percentage.expenditure\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Hepatitis.B\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Measles\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"BMI\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"under.five.deaths\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Polio\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Total.expenditure\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Diphtheria\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"HIV.AIDS\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"GDP\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Population\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"thinness..1.19.years\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"thinness.5.9.years\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Income.composition.of.resources\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Schooling\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Afghanistan\",\"2\":\"2015\",\"3\":\"Developing\",\"4\":\"65.0\",\"5\":\"263\",\"6\":\"62\",\"7\":\"0.01\",\"8\":\"71.27962\",\"9\":\"65\",\"10\":\"1154\",\"11\":\"19.1\",\"12\":\"83\",\"13\":\"6\",\"14\":\"8.16\",\"15\":\"65\",\"16\":\"0.1\",\"17\":\"584.2592\",\"18\":\"33736494\",\"19\":\"17.2\",\"20\":\"17.3\",\"21\":\"0.479\",\"22\":\"10.1\",\"_rn_\":\"1\"},{\"1\":\"Afghanistan\",\"2\":\"2014\",\"3\":\"Developing\",\"4\":\"59.9\",\"5\":\"271\",\"6\":\"64\",\"7\":\"0.01\",\"8\":\"73.52358\",\"9\":\"62\",\"10\":\"492\",\"11\":\"18.6\",\"12\":\"86\",\"13\":\"58\",\"14\":\"8.18\",\"15\":\"62\",\"16\":\"0.1\",\"17\":\"612.6965\",\"18\":\"327582\",\"19\":\"17.5\",\"20\":\"17.5\",\"21\":\"0.476\",\"22\":\"10.0\",\"_rn_\":\"2\"},{\"1\":\"Afghanistan\",\"2\":\"2013\",\"3\":\"Developing\",\"4\":\"59.9\",\"5\":\"268\",\"6\":\"66\",\"7\":\"0.01\",\"8\":\"73.21924\",\"9\":\"64\",\"10\":\"430\",\"11\":\"18.1\",\"12\":\"89\",\"13\":\"62\",\"14\":\"8.13\",\"15\":\"64\",\"16\":\"0.1\",\"17\":\"631.7450\",\"18\":\"31731688\",\"19\":\"17.7\",\"20\":\"17.7\",\"21\":\"0.470\",\"22\":\"9.9\",\"_rn_\":\"3\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\r\n  \r\n\r\nThis dataset contains variables such as country, year, status, life expectancy, etc. The Adult.Mortality column represents the adult mortality rates of both genders, which is the probability of dying between 15 and 60 years per 1000 population. Infant.deaths showcases the number of infant deaths per 1000 population. The Alcohol column describes the total litres of consumption for pure alcohol, which is recorded per capita for ages 15 and older. The Hepatitis.B, Polio, and Diphteria variables demonstrate the percentage of immunization coverage among 1-year-olds for each of those diseases. The Measles column signifies the number of reported cases of the measles per 1000 population. thinness..1.19.years` represents the percentage of thinness present in children ranging from the age of 10 to 19 years old.\r\nLife expectancy ranges from 44 to 89. This means that the people in the country with the highest life expectancy lived almost twice as long as the ones in the country with the lowest life expectancy.\r\nThe dataframe has 1649 rows and 20 attributes.\r\nVariable Corelation\r\nCategorical Variables\r\nComparison of mean life expectancy rate between developed and developing countries\r\nTo get an understanding of how the development status of a country is correlated with life expectancy, we compared the mean life expectancy of developed and developing countries.\r\nTable 2\r\n\r\n\r\nShow code\r\n\r\ndata %>%\r\n  filter(Life.expectancy>0)%>%\r\n  group_by(Status) %>%\r\n  summarize(mean_life_expectancy=mean(Life.expectancy)) %>% kbl() %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nStatus\r\n\r\n\r\nmean_life_expectancy\r\n\r\n\r\nDeveloped\r\n\r\n\r\n79.19785\r\n\r\n\r\nDeveloping\r\n\r\n\r\n67.11147\r\n\r\n\r\nIn the table above, we saw that on average, people in developed countries lived almost a decade longer than people in developing countries.\r\nTo better vizualize the correlation between the development status of a country and Life expectancy, we created a boxplot as shown below.\r\n\r\n\r\nShow code\r\n\r\n#Plot showing life expectancy in different country status\r\nplt <- ggbetweenstats(\r\n  data = data,\r\n  x = Status, \r\n  y = Life.expectancy\r\n)\r\nplt <- plt + \r\n  # Add labels and title\r\n  labs(\r\n    x = \"Development Status\",\r\n    y = \"Life Expectancy\",\r\n    title = \"Life Expectancy Vs Development Status\"\r\n  ) + \r\n  # Customizations\r\n  theme(\r\n    # This is the new default font in the plot\r\n    text = element_text(family = \"Roboto\", size = 8, color = \"black\"),\r\n    plot.title = element_text(\r\n      family = \"Lobster Two\", \r\n      size = 20,\r\n      face = \"bold\",\r\n      color = \"#2a475e\"\r\n    ),\r\n    # Statistical annotations below the main title\r\n    plot.subtitle = element_text(\r\n      family = \"Roboto\", \r\n      size = 15, \r\n      face = \"bold\",\r\n      color=\"#1b2838\"\r\n    ),\r\n    plot.title.position = \"plot\", # slightly different from default\r\n    axis.text = element_text(size = 10, color = \"black\"),\r\n    axis.title = element_text(size = 12)\r\n  )+\r\n    theme(\r\n    axis.ticks = element_blank(),\r\n    axis.line = element_line(colour = \"grey50\"),\r\n    panel.grid = element_line(color = \"#b4aea9\"),\r\n    panel.grid.minor = element_blank(),\r\n    panel.grid.major.x = element_blank(),\r\n    panel.grid.major.y = element_line(linetype = \"dashed\"),\r\n    panel.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\"),\r\n    plot.background = element_rect(fill = \"#fbf9f4\", color = \"#fbf9f4\")\r\n  )\r\nplt\r\n\r\n\r\n\r\n\r\nFigure 1: Box Plot showing development status and life expectancy\r\n\r\n\r\n\r\nAs we can see here, there is a stark difference in the life expectancy in developing and developed countries. To begin with, the interquartile range of life expectancy is lower in developed than developing countries.The mean and median are both much higher in developed countries. The minimum life expectancy is also much lower in developing countries. Thus, we can see that the status of the country could affect life expectancy.\r\nThe next categorical variable is Country. To show this, we created a map depicting the average life expectancy in each country.\r\n\r\n\r\nShow code\r\n\r\nnew_data <- data #%>% na.omit()\r\nsummary_data <- new_data %>% \r\n    group_by(Country) %>% \r\n    summarize(mean=mean(Life.expectancy))\r\n\r\ng <- list(\r\nshowframe = TRUE,\r\nshowcoastlines = TRUE,\r\nprojection = list(type = 'Mercator')\r\n)\r\n\r\nplot <- plot_geo(summary_data, locationmode=\"country names\")%>%\r\n    add_trace(locations=~Country,\r\n             z=~mean,\r\n             color=~mean) %>%\r\n    layout(\r\n  title = with(summary_data, paste('Mean Life Expectancy')),\r\n  geo = g\r\n)\r\nplot\r\n\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"30403f872ef8\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"30403f872ef8\",\"attrs\":{\"30403f872ef8\":{\"locationmode\":\"country names\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"locations\":{},\"z\":{},\"color\":{},\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"mapType\":\"geo\",\"title\":\"Mean Life Expectancy\",\"geo\":{\"domain\":{\"x\":[0,1],\"y\":[0,1]},\"showframe\":true,\"showcoastlines\":true,\"projection\":{\"type\":\"Mercator\"}},\"scene\":{\"zaxis\":{\"title\":\"mean\"}},\"hovermode\":\"closest\",\"showlegend\":false,\"legend\":{\"yanchor\":\"top\",\"y\":0.5}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"colorbar\":{\"title\":\"mean\",\"ticklen\":2,\"len\":0.5,\"lenmode\":\"fraction\",\"y\":1,\"yanchor\":\"top\"},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666666\",\"rgba(70,19,97,1)\"],[\"0.0833333333333332\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666666\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":true,\"locationmode\":\"country names\",\"locations\":[\"Afghanistan\",\"Albania\",\"Algeria\",\"Angola\",\"Antigua and Barbuda\",\"Argentina\",\"Armenia\",\"Australia\",\"Austria\",\"Azerbaijan\",\"Bahamas\",\"Bahrain\",\"Bangladesh\",\"Barbados\",\"Belarus\",\"Belgium\",\"Belize\",\"Benin\",\"Bhutan\",\"Bolivia (Plurinational State of)\",\"Bosnia and Herzegovina\",\"Botswana\",\"Brazil\",\"Brunei Darussalam\",\"Bulgaria\",\"Burkina Faso\",\"Burundi\",\"CÃ´te d'Ivoire\",\"Cabo Verde\",\"Cambodia\",\"Cameroon\",\"Canada\",\"Central African Republic\",\"Chad\",\"Chile\",\"China\",\"Colombia\",\"Comoros\",\"Congo\",\"Costa Rica\",\"Croatia\",\"Cuba\",\"Cyprus\",\"Czechia\",\"Democratic People's Republic of Korea\",\"Democratic Republic of the Congo\",\"Denmark\",\"Djibouti\",\"Dominican Republic\",\"Ecuador\",\"Egypt\",\"El Salvador\",\"Equatorial Guinea\",\"Eritrea\",\"Estonia\",\"Ethiopia\",\"Fiji\",\"Finland\",\"France\",\"Gabon\",\"Gambia\",\"Georgia\",\"Germany\",\"Ghana\",\"Greece\",\"Grenada\",\"Guatemala\",\"Guinea\",\"Guinea-Bissau\",\"Guyana\",\"Haiti\",\"Honduras\",\"Hungary\",\"Iceland\",\"India\",\"Indonesia\",\"Iran (Islamic Republic of)\",\"Iraq\",\"Ireland\",\"Israel\",\"Italy\",\"Jamaica\",\"Japan\",\"Jordan\",\"Kazakhstan\",\"Kenya\",\"Kiribati\",\"Kuwait\",\"Kyrgyzstan\",\"Lao People's Democratic Republic\",\"Latvia\",\"Lebanon\",\"Lesotho\",\"Liberia\",\"Libya\",\"Lithuania\",\"Luxembourg\",\"Madagascar\",\"Malawi\",\"Malaysia\",\"Maldives\",\"Mali\",\"Malta\",\"Mauritania\",\"Mauritius\",\"Mexico\",\"Micronesia (Federated States of)\",\"Mongolia\",\"Montenegro\",\"Morocco\",\"Mozambique\",\"Myanmar\",\"Namibia\",\"Nepal\",\"Netherlands\",\"New Zealand\",\"Nicaragua\",\"Niger\",\"Nigeria\",\"Norway\",\"Oman\",\"Pakistan\",\"Panama\",\"Papua New Guinea\",\"Paraguay\",\"Peru\",\"Philippines\",\"Poland\",\"Portugal\",\"Qatar\",\"Republic of Korea\",\"Republic of Moldova\",\"Romania\",\"Russian Federation\",\"Rwanda\",\"Saint Lucia\",\"Saint Vincent and the Grenadines\",\"Samoa\",\"Sao Tome and Principe\",\"Saudi Arabia\",\"Senegal\",\"Serbia\",\"Seychelles\",\"Sierra Leone\",\"Singapore\",\"Slovakia\",\"Slovenia\",\"Solomon Islands\",\"Somalia\",\"South Africa\",\"South Sudan\",\"Spain\",\"Sri Lanka\",\"Sudan\",\"Suriname\",\"Swaziland\",\"Sweden\",\"Switzerland\",\"Syrian Arab Republic\",\"Tajikistan\",\"Thailand\",\"The former Yugoslav republic of Macedonia\",\"Timor-Leste\",\"Togo\",\"Tonga\",\"Trinidad and Tobago\",\"Tunisia\",\"Turkey\",\"Turkmenistan\",\"Uganda\",\"Ukraine\",\"United Arab Emirates\",\"United Kingdom of Great Britain and Northern Ireland\",\"United Republic of Tanzania\",\"United States of America\",\"Uruguay\",\"Uzbekistan\",\"Vanuatu\",\"Venezuela (Bolivarian Republic of)\",\"Viet Nam\",\"Yemen\",\"Zambia\",\"Zimbabwe\"],\"z\":[58.19375,75.15625,73.61875,49.01875,75.05625,75.15625,73.4,81.8125,81.48125,70.73125,74.2875,75.725,69.3,74.35625,69.90625,80.68125,69.26875,57.56875,66.1625,67.70625,75.96875,56.05,73.38125,76.4875,72.85,55.64375,55.5375,50.3875,72.51875,64.34375,54.01875,81.6875,48.5125,50.3875,79.45,74.2625,73.2875,61.58125,59.04375,78.59375,76.11875,77.975,79.675,76.76875,69.19375,55.6875,79.25625,60.75625,72.34375,74.725,71.5,71.74375,55.3125,60.6875,74.94375,59.1125,68.7125,80.7125,82.21875,62.24375,59.4625,73.50625,81.175,60.8625,81.21875,73.29375,71.73125,56.0125,55.36875,65.6375,59.86875,72.99375,73.825,82.44375,65.41875,67.55625,73.85625,70.35625,80.15,81.3,82.1875,74.29375,82.5375,72.9875,66.7625,57.48125,65.15,73.84375,69.08125,62.38125,73.73125,74.2,48.78125,57.525,72.4875,72.80625,80.78125,62.74375,49.89375,73.75625,75.5375,54.9375,80.3625,62.8,72.7125,75.71875,68.2,65.8875,74.5,72.15625,53.39375,64.2,60.4,66.48125,81.13125,81.3375,73.45,56.98125,51.35625,81.79375,74.84375,64.5,76.4875,61.68125,73.1125,73.6625,67.575,75.65,79.99375,77.03125,80.4875,69.98125,74.05,67.7625,59.3125,73.6,73.475,73.61875,65.1625,73.46875,62.56875,73.95625,72.375,46.1125,81.475,74.75,79.73125,67.7125,53.31875,57.5,53.875,82.06875,73.4,61.825,70.08125,51.325,82.51875,82.33125,70.85,66.65625,73.08125,74.1125,64.75625,56.6625,72.53125,71.06875,74.35625,73.9125,64.61875,55.70625,69.9375,75.7,80.79375,56.00625,78.0625,76.075,68.03125,71.3875,73.3875,74.775,63.8625,53.90625,50.4875],\"type\":\"choropleth\",\"marker\":{\"line\":{\"colorbar\":{\"title\":\"\",\"ticklen\":2},\"cmin\":46.1125,\"cmax\":82.5375,\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666666\",\"rgba(70,19,97,1)\"],[\"0.0833333333333332\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666666\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":false,\"color\":[58.19375,75.15625,73.61875,49.01875,75.05625,75.15625,73.4,81.8125,81.48125,70.73125,74.2875,75.725,69.3,74.35625,69.90625,80.68125,69.26875,57.56875,66.1625,67.70625,75.96875,56.05,73.38125,76.4875,72.85,55.64375,55.5375,50.3875,72.51875,64.34375,54.01875,81.6875,48.5125,50.3875,79.45,74.2625,73.2875,61.58125,59.04375,78.59375,76.11875,77.975,79.675,76.76875,69.19375,55.6875,79.25625,60.75625,72.34375,74.725,71.5,71.74375,55.3125,60.6875,74.94375,59.1125,68.7125,80.7125,82.21875,62.24375,59.4625,73.50625,81.175,60.8625,81.21875,73.29375,71.73125,56.0125,55.36875,65.6375,59.86875,72.99375,73.825,82.44375,65.41875,67.55625,73.85625,70.35625,80.15,81.3,82.1875,74.29375,82.5375,72.9875,66.7625,57.48125,65.15,73.84375,69.08125,62.38125,73.73125,74.2,48.78125,57.525,72.4875,72.80625,80.78125,62.74375,49.89375,73.75625,75.5375,54.9375,80.3625,62.8,72.7125,75.71875,68.2,65.8875,74.5,72.15625,53.39375,64.2,60.4,66.48125,81.13125,81.3375,73.45,56.98125,51.35625,81.79375,74.84375,64.5,76.4875,61.68125,73.1125,73.6625,67.575,75.65,79.99375,77.03125,80.4875,69.98125,74.05,67.7625,59.3125,73.6,73.475,73.61875,65.1625,73.46875,62.56875,73.95625,72.375,46.1125,81.475,74.75,79.73125,67.7125,53.31875,57.5,53.875,82.06875,73.4,61.825,70.08125,51.325,82.51875,82.33125,70.85,66.65625,73.08125,74.1125,64.75625,56.6625,72.53125,71.06875,74.35625,73.9125,64.61875,55.70625,69.9375,75.7,80.79375,56.00625,78.0625,76.075,68.03125,71.3875,73.3875,74.775,63.8625,53.90625,50.4875]}},\"geo\":\"geo\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nFigure 2: A geographic plot showing different\r\n\r\n\r\n\r\nShow code\r\n\r\n#htmlwidgets::saveWidget(plot, \"plot2.html\")\r\n#IRdisplay::display_html(sprintf('<iframe src=\"plot2.html\" height=%d width=%d><\/iframe>', 600, 900))\r\n\r\n\r\n\r\nHere we see that sub-saharan african countries are amongst the lowest life expectancy regions while Canada, Europe and Australia amongst the highest.\r\nContinuous Variables\r\nTo demonstrate the correlation between continuous variables and life expectancy, we created a correlation map.\r\nHIV.AIDS VS life.expectancy\r\n\r\n\r\nShow code\r\n\r\np<- data %>% \r\n  ggplot()+\r\n  geom_point(aes(HIV.AIDS, Life.expectancy, alpha=0.5,color=Status)) +\r\n  geom_smooth(aes(HIV.AIDS, Life.expectancy))+\r\n  labs(x=\"Deaths per 1000 births from AIDS\", Y=\"Life expectancy\")+\r\n  theme(legend.position = \"none\")\r\n\r\nggMarginal(p, type=\"histogram\", fill=\"slateblue\")\r\n\r\n\r\n\r\n\r\nIncome composition of resources vs life expectancy\r\n\r\n\r\nShow code\r\n\r\np2<- data %>% \r\n  ggplot()+\r\n  geom_point(aes(Income.composition.of.resources, Life.expectancy,\r\n                 color=Country,\r\n                 fill=Status,alpha=0.01, size= GDP), shape=21)+\r\n  scale_size(range=c(.1, 6))+\r\n  \r\n   scale_fill_viridis(discrete=TRUE, guide=FALSE, option=\"A\") +\r\n    theme_ipsum() +\r\n    theme(legend.position=\"bottom\") +\r\n    ylab(\"Life Expectancy\") +\r\n    xlab(\"Income Composition\") +\r\n    theme(legend.position = \"none\")\r\nggMarginal(p2, type=\"density\", fill=\"grey\")\r\n\r\n\r\n\r\n\r\nIncome composition vs Adult Mortality\r\n\r\n\r\nShow code\r\n\r\np3 <- data %>% \r\n  ggplot()+\r\n  geom_point(aes(Income.composition.of.resources, Adult.Mortality,\r\n                 color=Country,\r\n                 fill=Status,alpha=0.5, size= GDP), shape=21)+\r\n  scale_size(range=c(.1, 15))+\r\n  \r\n   scale_fill_viridis(discrete=TRUE, guide=FALSE, option=\"A\") +\r\n    theme_ipsum() +\r\n    theme(legend.position=\"bottom\") +\r\n    ylab(\"Adult Mortality\") +\r\n    xlab(\"Income Composition\") +\r\n    theme(legend.position = \"none\")\r\np3+\r\n  transition_time(Year)+\r\n  labs(title = \"Year: {frame_time}\")\r\n\r\n\r\n\r\n\r\nCorrelation matrix\r\n\r\n\r\nShow code\r\n\r\ndata_num <- data %>% select(-Country, -Year, -Status)\r\n\r\ncorrgram(data_num, \r\n         order=NULL, \r\n         lower.panel=panel.shade, \r\n         upper.panel=panel.pie, \r\n         text.panel=panel.txt)\r\n\r\n\r\n\r\n\r\n(#fig:correlation matrix)Correlation Matrix\r\n\r\n\r\n\r\nObservations\r\nThe variables that life expectancy is most positively related are: schooling, and income composition of resources.\r\nThe variables most negatively associated with life expectancy are: adult mortality and HIV/AIDS.\r\nLife expectancy has a negligible relationship with Population, Total expenditure, under-five deaths and Measles.\r\nFrom the above observations, we would expect to see schooling, income composition of resources, adult mortality, and HIV/AIDS to have the largest impact in our linear model while Population, Total expenditure, under-five deaths and Measles are expected to have a smaller impact in the linear model.\r\nVariable Selection\r\nPreparing the data\r\nOur first step is to ensure all of our variables can be used in the regression and then splitting the dataset into testing and training sets. For this study, we will be using a proportion of 0.75. We will not be using the Country and Year categories in this model as our aim is to predict the life expectancy based on factors that are more general and not specific to a place or time. Furthermore, the Country variable has over 150 levels, which will make our model extremely large.\r\n\r\n\r\nShow code\r\n\r\ndata <- data %>% \r\n    select(-Country) %>%\r\n    select(-Year) %>%\r\n    mutate(Status = if_else(Status == \"Developing\", 0, 1)) %>%\r\n    na.omit()\r\ndata$Status <- as.factor(data$Status)\r\n\r\n#splitting data into testing and training sets\r\nset.seed(123)\r\ninitial_split <- initial_split(data, prop = 0.75)\r\nexpectancy_train <- training(initial_split)\r\nexpectancy_test <- testing(initial_split)\r\n\r\n\r\nexpectancy_train %>% head(2) %>% kbl(caption = \"Table 3: First few contents of the training set\") %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nTable 1: Table 3: First few contents of the training set\r\n\r\n\r\n\r\n\r\nStatus\r\n\r\n\r\nLife.expectancy\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nHepatitis.B\r\n\r\n\r\nMeasles\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nPolio\r\n\r\n\r\nTotal.expenditure\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nGDP\r\n\r\n\r\nPopulation\r\n\r\n\r\nthinness..1.19.years\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nSchooling\r\n\r\n\r\n676\r\n\r\n\r\n1\r\n\r\n\r\n81.0\r\n\r\n\r\n54\r\n\r\n\r\n0\r\n\r\n\r\n9.04\r\n\r\n\r\n212.08593\r\n\r\n\r\n96\r\n\r\n\r\n0\r\n\r\n\r\n59.2\r\n\r\n\r\n0\r\n\r\n\r\n99\r\n\r\n\r\n7.46\r\n\r\n\r\n99\r\n\r\n\r\n0.1\r\n\r\n\r\n2797.967\r\n\r\n\r\n1143896\r\n\r\n\r\n0.9\r\n\r\n\r\n1.0\r\n\r\n\r\n0.850\r\n\r\n\r\n13.8\r\n\r\n\r\n799\r\n\r\n\r\n0\r\n\r\n\r\n74.4\r\n\r\n\r\n151\r\n\r\n\r\n8\r\n\r\n\r\n3.69\r\n\r\n\r\n18.26183\r\n\r\n\r\n82\r\n\r\n\r\n0\r\n\r\n\r\n45.8\r\n\r\n\r\n10\r\n\r\n\r\n97\r\n\r\n\r\n6.46\r\n\r\n\r\n87\r\n\r\n\r\n0.3\r\n\r\n\r\n244.469\r\n\r\n\r\n1328961\r\n\r\n\r\n1.5\r\n\r\n\r\n1.4\r\n\r\n\r\n0.679\r\n\r\n\r\n12.6\r\n\r\n\r\nShow code\r\n\r\nexpectancy_test %>% head(2) %>% kbl(caption = \"Table 4: First few contents of the test set\") %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nTable 1: Table 4: First few contents of the test set\r\n\r\n\r\n\r\n\r\nStatus\r\n\r\n\r\nLife.expectancy\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nHepatitis.B\r\n\r\n\r\nMeasles\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nPolio\r\n\r\n\r\nTotal.expenditure\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nGDP\r\n\r\n\r\nPopulation\r\n\r\n\r\nthinness..1.19.years\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nSchooling\r\n\r\n\r\n3\r\n\r\n\r\n0\r\n\r\n\r\n59.9\r\n\r\n\r\n268\r\n\r\n\r\n66\r\n\r\n\r\n0.01\r\n\r\n\r\n73.21924\r\n\r\n\r\n64\r\n\r\n\r\n430\r\n\r\n\r\n18.1\r\n\r\n\r\n89\r\n\r\n\r\n62\r\n\r\n\r\n8.13\r\n\r\n\r\n64\r\n\r\n\r\n0.1\r\n\r\n\r\n631.7450\r\n\r\n\r\n31731688\r\n\r\n\r\n17.7\r\n\r\n\r\n17.7\r\n\r\n\r\n0.470\r\n\r\n\r\n9.9\r\n\r\n\r\n7\r\n\r\n\r\n0\r\n\r\n\r\n58.6\r\n\r\n\r\n281\r\n\r\n\r\n77\r\n\r\n\r\n0.01\r\n\r\n\r\n56.76222\r\n\r\n\r\n63\r\n\r\n\r\n2861\r\n\r\n\r\n16.2\r\n\r\n\r\n106\r\n\r\n\r\n63\r\n\r\n\r\n9.42\r\n\r\n\r\n63\r\n\r\n\r\n0.1\r\n\r\n\r\n445.8933\r\n\r\n\r\n284331\r\n\r\n\r\n18.6\r\n\r\n\r\n18.7\r\n\r\n\r\n0.434\r\n\r\n\r\n8.9\r\n\r\n\r\nBackward Selection\r\nWe will now be performing variable selection using regsubsets. Our nvmax is 19 as there are 19 remaining variables in the dataset.\r\n\r\n\r\nShow code\r\n\r\n#Variable selection \r\n\r\nbackward_sel <- regsubsets(x=Life.expectancy ~.,data= expectancy_train, nvmax=19, method=\"backward\")\r\n\r\n#backward_sel\r\nback_summary <- summary(backward_sel)\r\n\r\nback_summary_df <- data.frame( \r\n   RSQ = back_summary$rsq,\r\n   RSS = back_summary$rss,\r\n   ADJ.R2 = back_summary$adjr2,\r\n   BIC = back_summary$bic\r\n)\r\nback_summary_df %>% head() %>% kbl(caption = \"Backward selection\") %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\nTable 2: Backward selection\r\n\r\n\r\nRSQ\r\n\r\n\r\nRSS\r\n\r\n\r\nADJ.R2\r\n\r\n\r\nBIC\r\n\r\n\r\n0.5177821\r\n\r\n\r\n46475.58\r\n\r\n\r\n0.5173913\r\n\r\n\r\n-887.2486\r\n\r\n\r\n0.7279422\r\n\r\n\r\n26220.60\r\n\r\n\r\n0.7275009\r\n\r\n\r\n-1587.5926\r\n\r\n\r\n0.7898490\r\n\r\n\r\n20254.10\r\n\r\n\r\n0.7893372\r\n\r\n\r\n-1899.5934\r\n\r\n\r\n0.8105975\r\n\r\n\r\n18254.38\r\n\r\n\r\n0.8099821\r\n\r\n\r\n-2020.9589\r\n\r\n\r\n0.8145800\r\n\r\n\r\n17870.55\r\n\r\n\r\n0.8138263\r\n\r\n\r\n-2040.1052\r\n\r\n\r\n0.8249509\r\n\r\n\r\n16871.02\r\n\r\n\r\n0.8240963\r\n\r\n\r\n-2104.1260\r\n\r\n\r\n\r\n\r\nShow code\r\n\r\n## Using Mallow's C_P to find the right number of inputs\r\nbackward_sel_candidate_models <- tibble(\r\n  n_input_variables = rep(1:19),\r\n  C_p =back_summary$cp\r\n)\r\ncat(\"The best number of predictors to be selected is \", backward_sel_candidate_models %>% filter(C_p==min(C_p)) %>% pull(n_input_variables))\r\n\r\n\r\nThe best number of predictors to be selected is  12\r\n\r\nShow code\r\n\r\ncat(\"\\nTable 6\")\r\n\r\n\r\n\r\nTable 6\r\n\r\nShow code\r\n\r\nbackward_sel_candidate_models %>% kbl(caption = \"Table 6\") %>%\r\n  kable_paper(\"hover\", full_width = F) %>% \r\n  row_spec(12, bold = T, color = \"white\", background = \"brown\")\r\n\r\n\r\n\r\nTable 3: Table 6\r\n\r\n\r\nn_input_variables\r\n\r\n\r\nC_p\r\n\r\n\r\n1\r\n\r\n\r\n2404.139354\r\n\r\n\r\n2\r\n\r\n\r\n821.437844\r\n\r\n\r\n3\r\n\r\n\r\n356.633125\r\n\r\n\r\n4\r\n\r\n\r\n202.179470\r\n\r\n\r\n5\r\n\r\n\r\n174.149690\r\n\r\n\r\n6\r\n\r\n\r\n97.948598\r\n\r\n\r\n7\r\n\r\n\r\n50.986642\r\n\r\n\r\n8\r\n\r\n\r\n19.934640\r\n\r\n\r\n9\r\n\r\n\r\n13.454595\r\n\r\n\r\n10\r\n\r\n\r\n11.985773\r\n\r\n\r\n11\r\n\r\n\r\n11.468809\r\n\r\n\r\n12\r\n\r\n\r\n9.988715\r\n\r\n\r\n13\r\n\r\n\r\n10.121462\r\n\r\n\r\n14\r\n\r\n\r\n11.148805\r\n\r\n\r\n15\r\n\r\n\r\n12.691486\r\n\r\n\r\n16\r\n\r\n\r\n14.287013\r\n\r\n\r\n17\r\n\r\n\r\n16.079369\r\n\r\n\r\n18\r\n\r\n\r\n18.017771\r\n\r\n\r\n19\r\n\r\n\r\n20.000000\r\n\r\n\r\n\r\n\r\nShow code\r\n\r\nplot(back_summary$cp,\r\n    main = \"Cp for Backward Method using a Training Set\",\r\n  xlab = \"Number of Input Variables\", ylab = \"Cp\", type = \"b\", pch = 19,\r\n  col = \"red\")\r\n\r\n\r\n\r\n\r\nThe results of our backward selection tell us that the model with 12 variables is the best model, as it has the lowest \\(C_p\\) of 9.988715.\r\n\r\n\r\nShow code\r\n\r\nback_summary %>% head(1) %>% kbl() %>%\r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n(Intercept)\r\n\r\n\r\nStatus1\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nHepatitis.B\r\n\r\n\r\nMeasles\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nPolio\r\n\r\n\r\nTotal.expenditure\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nGDP\r\n\r\n\r\nPopulation\r\n\r\n\r\nthinness..1.19.years\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nSchooling\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nFALSE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\nTRUE\r\n\r\n\r\n\r\nThe 12 variables include: Status, Adult.Mortality, infant.deaths, percentage.expenditure, BMI, under.five.deaths, Diphtheria, HIV.AIDS, thinness.5.9.years, Income.composition.of.resources, Schooling and Alcohol.\r\nObservations\r\nPolio and Hepatitis B are not included in this model while Diphtheria is. This suggests that Diphtheria affects life expectancy more than the other two diseases, which could be due to the fact that Diphtheria is more fatal in children (fatality rate is 5-10%, while Polio’s is 2-5% and Hepatitis B’ s is around 0.42 per 100000 population).\r\nThinness 5-9 years is selected, but not thinness 10-19 years. This could be due to the fact that thinness and malnutrition during childhood may lead to people dying earlier, and so it has a larger impact on life expectancy and was thus included in the model.\r\nWhile Status and percentage expenditure both impact life expectancy, GDP and total expenditure do not. This makes sense as GDP and total expenditure are both absolute measures, and do not consider population of a country, while percentage expenditure takes into account the differences between population and cost of living in different areas.\r\nForward Selection\r\nUsing the same methods, we will now be performing forward selection.\r\nTable 7\r\n\r\n\r\nShow code\r\n\r\n### Forward selection\r\n\r\nforward_sel <- regsubsets(x=Life.expectancy ~.,data= expectancy_train, nvmax=19, method=\"forward\")\r\n\r\nforward_summary <- summary(forward_sel)\r\n\r\nforward_summary_df <- data.frame( \r\n   RSQ = forward_summary$rsq,\r\n   RSS = forward_summary$rss,\r\n   ADJ.R2 = forward_summary$adjr2,\r\n   BIC = forward_summary$bic\r\n)\r\nforward_summary_df %>% head() %>% kbl() %>% kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nRSQ\r\n\r\n\r\nRSS\r\n\r\n\r\nADJ.R2\r\n\r\n\r\nBIC\r\n\r\n\r\n0.5177821\r\n\r\n\r\n46475.58\r\n\r\n\r\n0.5173913\r\n\r\n\r\n-887.2486\r\n\r\n\r\n0.7279422\r\n\r\n\r\n26220.60\r\n\r\n\r\n0.7275009\r\n\r\n\r\n-1587.5926\r\n\r\n\r\n0.7898490\r\n\r\n\r\n20254.10\r\n\r\n\r\n0.7893372\r\n\r\n\r\n-1899.5934\r\n\r\n\r\n0.8105975\r\n\r\n\r\n18254.38\r\n\r\n\r\n0.8099821\r\n\r\n\r\n-2020.9589\r\n\r\n\r\n0.8161367\r\n\r\n\r\n17720.52\r\n\r\n\r\n0.8153893\r\n\r\n\r\n-2050.5256\r\n\r\n\r\n0.8216015\r\n\r\n\r\n17193.83\r\n\r\n\r\n0.8207306\r\n\r\n\r\n-2080.6997\r\n\r\n\r\nThe number of inputs with the minimal C_P is 12\r\n\r\n\r\nShow code\r\n\r\n## Using Mallow's C_P to find the right number of inputs\r\nforward_sel_candidate_models <- tibble(\r\n  n_input_variables = rep(1:19),\r\n  C_p = forward_summary$cp\r\n)\r\n\r\nforward_sel_candidate_models %>% kbl %>% kable_paper(\"hover\", full_width=0) %>% row_spec(12, bold = T, color = \"white\", background = \"brown\")\r\n\r\n\r\n\r\nn_input_variables\r\n\r\n\r\nC_p\r\n\r\n\r\n1\r\n\r\n\r\n2404.139354\r\n\r\n\r\n2\r\n\r\n\r\n821.437844\r\n\r\n\r\n3\r\n\r\n\r\n356.633125\r\n\r\n\r\n4\r\n\r\n\r\n202.179470\r\n\r\n\r\n5\r\n\r\n\r\n162.411842\r\n\r\n\r\n6\r\n\r\n\r\n123.204489\r\n\r\n\r\n7\r\n\r\n\r\n106.087435\r\n\r\n\r\n8\r\n\r\n\r\n19.934640\r\n\r\n\r\n9\r\n\r\n\r\n13.454595\r\n\r\n\r\n10\r\n\r\n\r\n11.985773\r\n\r\n\r\n11\r\n\r\n\r\n11.468809\r\n\r\n\r\n12\r\n\r\n\r\n9.988715\r\n\r\n\r\n13\r\n\r\n\r\n10.121462\r\n\r\n\r\n14\r\n\r\n\r\n11.148805\r\n\r\n\r\n15\r\n\r\n\r\n12.691486\r\n\r\n\r\n16\r\n\r\n\r\n14.287013\r\n\r\n\r\n17\r\n\r\n\r\n16.079369\r\n\r\n\r\n18\r\n\r\n\r\n18.017771\r\n\r\n\r\n19\r\n\r\n\r\n20.000000\r\n\r\n\r\n\r\n\r\nShow code\r\n\r\nplot(forward_summary$cp,\r\n    main = \"Cp for Forward Method using a Training Set\",\r\n  xlab = \"Number of Input Variables\", ylab = \"Cp\", type = \"b\", pch = 19,\r\n  col = \"red\")\r\n\r\n\r\n\r\n\r\nThe model size we get is the same for both forward and backward selection, and contains the same variables. Due to multicollinearity, we will be removing the Schooling and infant.deaths from our model. The covariates we will be using are listed below as stepwise_selection.\r\n\r\n\r\nShow code\r\n\r\nstepwise_selection <- data %>%\r\n    select( -Hepatitis.B, -Measles, -Polio, -Total.expenditure, -GDP, \r\n           -Population, -thinness..1.19.years, -Schooling, -infant.deaths) %>%\r\n    names() \r\nstepwise_selection %>% kbl() %>% kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nx\r\n\r\n\r\nStatus\r\n\r\n\r\nLife.expectancy\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\nAlcohol\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\nBMI\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\nDiphtheria\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\nBelow, we can find our model, and the summary of our model.\r\n\r\n\r\nShow code\r\n\r\nMLR_expectancy <- lm(Life.expectancy ~ Status + Adult.Mortality + percentage.expenditure\r\n                     + BMI + under.five.deaths + Diphtheria + Alcohol + \r\n                     HIV.AIDS + thinness.5.9.years + Income.composition.of.resources, data = expectancy_train)\r\ntidy(MLR_expectancy, conf.int = TRUE) %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nterm\r\n\r\n\r\nestimate\r\n\r\n\r\nstd.error\r\n\r\n\r\nstatistic\r\n\r\n\r\np.value\r\n\r\n\r\nconf.low\r\n\r\n\r\nconf.high\r\n\r\n\r\n(Intercept)\r\n\r\n\r\n58.5126455\r\n\r\n\r\n0.7554403\r\n\r\n\r\n77.4550272\r\n\r\n\r\n0.0000000\r\n\r\n\r\n57.0305454\r\n\r\n\r\n59.9947456\r\n\r\n\r\nStatus1\r\n\r\n\r\n1.2412777\r\n\r\n\r\n0.4297390\r\n\r\n\r\n2.8884455\r\n\r\n\r\n0.0039396\r\n\r\n\r\n0.3981717\r\n\r\n\r\n2.0843837\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\n-0.0206131\r\n\r\n\r\n0.0011753\r\n\r\n\r\n-17.5392368\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.0229188\r\n\r\n\r\n-0.0183073\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\n0.0004885\r\n\r\n\r\n0.0000771\r\n\r\n\r\n6.3324696\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0003371\r\n\r\n\r\n0.0006398\r\n\r\n\r\nBMI\r\n\r\n\r\n0.0570020\r\n\r\n\r\n0.0074777\r\n\r\n\r\n7.6229339\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0423315\r\n\r\n\r\n0.0716725\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\n-0.0027101\r\n\r\n\r\n0.0007291\r\n\r\n\r\n-3.7169385\r\n\r\n\r\n0.0002108\r\n\r\n\r\n-0.0041405\r\n\r\n\r\n-0.0012796\r\n\r\n\r\nDiphtheria\r\n\r\n\r\n0.0274355\r\n\r\n\r\n0.0054988\r\n\r\n\r\n4.9893188\r\n\r\n\r\n0.0000007\r\n\r\n\r\n0.0166473\r\n\r\n\r\n0.0382236\r\n\r\n\r\nAlcohol\r\n\r\n\r\n-0.0119317\r\n\r\n\r\n0.0395812\r\n\r\n\r\n-0.3014486\r\n\r\n\r\n0.7631236\r\n\r\n\r\n-0.0895861\r\n\r\n\r\n0.0657227\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\n-0.4122371\r\n\r\n\r\n0.0211421\r\n\r\n\r\n-19.4983807\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.4537159\r\n\r\n\r\n-0.3707584\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\n-0.0340371\r\n\r\n\r\n0.0330401\r\n\r\n\r\n-1.0301765\r\n\r\n\r\n0.3031305\r\n\r\n\r\n-0.0988585\r\n\r\n\r\n0.0307843\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\n16.5937484\r\n\r\n\r\n0.8900820\r\n\r\n\r\n18.6429444\r\n\r\n\r\n0.0000000\r\n\r\n\r\n14.8474945\r\n\r\n\r\n18.3400023\r\n\r\n\r\n\r\n\r\nShow code\r\n\r\nMLR_expectancy_2 <- lm(Life.expectancy ~ Status + Adult.Mortality + percentage.expenditure\r\n                    + BMI + under.five.deaths + Diphtheria + Alcohol + \r\n                    HIV.AIDS + thinness.5.9.years + Income.composition.of.resources + \r\n                      infant.deaths + Schooling, data = expectancy_train)\r\ntidy(MLR_expectancy_2, conf.int=TRUE) %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nterm\r\n\r\n\r\nestimate\r\n\r\n\r\nstd.error\r\n\r\n\r\nstatistic\r\n\r\n\r\np.value\r\n\r\n\r\nconf.low\r\n\r\n\r\nconf.high\r\n\r\n\r\n(Intercept)\r\n\r\n\r\n54.6706112\r\n\r\n\r\n0.7911543\r\n\r\n\r\n69.102340\r\n\r\n\r\n0.0000000\r\n\r\n\r\n53.1184413\r\n\r\n\r\n56.2227812\r\n\r\n\r\nStatus1\r\n\r\n\r\n0.7342522\r\n\r\n\r\n0.3916697\r\n\r\n\r\n1.874672\r\n\r\n\r\n0.0610761\r\n\r\n\r\n-0.0341668\r\n\r\n\r\n1.5026712\r\n\r\n\r\nAdult.Mortality\r\n\r\n\r\n-0.0177494\r\n\r\n\r\n0.0010812\r\n\r\n\r\n-16.415941\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.0198707\r\n\r\n\r\n-0.0156281\r\n\r\n\r\npercentage.expenditure\r\n\r\n\r\n0.0004508\r\n\r\n\r\n0.0000701\r\n\r\n\r\n6.431575\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0003133\r\n\r\n\r\n0.0005883\r\n\r\n\r\nBMI\r\n\r\n\r\n0.0339693\r\n\r\n\r\n0.0069625\r\n\r\n\r\n4.878866\r\n\r\n\r\n0.0000012\r\n\r\n\r\n0.0203095\r\n\r\n\r\n0.0476292\r\n\r\n\r\nunder.five.deaths\r\n\r\n\r\n-0.0749374\r\n\r\n\r\n0.0084056\r\n\r\n\r\n-8.915167\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.0914284\r\n\r\n\r\n-0.0584464\r\n\r\n\r\nDiphtheria\r\n\r\n\r\n0.0128051\r\n\r\n\r\n0.0050786\r\n\r\n\r\n2.521364\r\n\r\n\r\n0.0118163\r\n\r\n\r\n0.0028413\r\n\r\n\r\n0.0227689\r\n\r\n\r\nAlcohol\r\n\r\n\r\n-0.0814556\r\n\r\n\r\n0.0375585\r\n\r\n\r\n-2.168764\r\n\r\n\r\n0.0302928\r\n\r\n\r\n-0.1551419\r\n\r\n\r\n-0.0077693\r\n\r\n\r\nHIV.AIDS\r\n\r\n\r\n-0.4153210\r\n\r\n\r\n0.0191870\r\n\r\n\r\n-21.645997\r\n\r\n\r\n0.0000000\r\n\r\n\r\n-0.4529641\r\n\r\n\r\n-0.3776780\r\n\r\n\r\nthinness.5.9.years\r\n\r\n\r\n-0.0626015\r\n\r\n\r\n0.0301367\r\n\r\n\r\n-2.077252\r\n\r\n\r\n0.0379866\r\n\r\n\r\n-0.1217268\r\n\r\n\r\n-0.0034762\r\n\r\n\r\nIncome.composition.of.resources\r\n\r\n\r\n9.2798242\r\n\r\n\r\n0.9431914\r\n\r\n\r\n9.838750\r\n\r\n\r\n0.0000000\r\n\r\n\r\n7.4293717\r\n\r\n\r\n11.1302768\r\n\r\n\r\ninfant.deaths\r\n\r\n\r\n0.0986923\r\n\r\n\r\n0.0113129\r\n\r\n\r\n8.723857\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.0764974\r\n\r\n\r\n0.1208871\r\n\r\n\r\nSchooling\r\n\r\n\r\n0.8770596\r\n\r\n\r\n0.0667411\r\n\r\n\r\n13.141222\r\n\r\n\r\n0.0000000\r\n\r\n\r\n0.7461199\r\n\r\n\r\n1.0079994\r\n\r\n\r\nAnalysing The Effect Of Multicollinearity\r\nFrom the correlation matrix above, we know that the pair of Schooling and Income.composition.of.resources as well as the pair under.five.deaths and infant.deaths are highly correlated. The first model MLR_expectancy adjusts for this by removing one variable each from both correlated pairs while MLR_expectancy_2 does not. The impact of not adjusting the model is a decrease in the magnitude of the coefficient estimate which is caused by the newly added correlated variable taking away some of its significance. In our models: \\(\\\\\\\\\\) Income.composition.of.resources : 16.6 (without) Income.composition.of.resources: 9.28 (with)under.five.deaths: -2.710e-03 (without)under.five.deaths: -7.494e-02 (with) Therefore, it is not ideal to include correlated covariates Schooling and infant.deaths in the model.\r\nBelow, we also do forward selection for interactive models, which we put a nvmax of 189 as those are the maximum number of interactions we can get.\r\n\r\n\r\nShow code\r\n\r\nforward_int_sel <- regsubsets(x=Life.expectancy ~. ^2,data= expectancy_train, nvmax = 189, method=\"forward\")\r\n\r\n\r\nReordering variables and trying again:\r\n\r\nShow code\r\n\r\nforward_int_summary <- summary(forward_int_sel)\r\n\r\nforward_int_sel_candidate_models <- tibble(\r\n  n_input_variables = rep(1:length(forward_int_summary$cp)),\r\n  C_p = forward_int_summary$cp\r\n)\r\nmin(forward_int_summary$cp) %>% kbl(caption = \"Min C_p\") %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nTable 4: Min C_p\r\n\r\n\r\nx\r\n\r\n\r\n105.696\r\n\r\n\r\nAs shown, the lowest \\(C_p\\) for the forward selection models with interaction are much higher than the ones for the additive models. This suggests that the models with interaction may not be as good as that without, and as there are an incredibly large number of variables, we will not be doing any interactive models.\r\nLASSO Model Selection\r\nWe will now be using LASSO to further see what model is the best when all the covariates are included. Below, we use cv.glmnet to find the smallest lambda to further create a model and do analysis.\r\n\r\n\r\nShow code\r\n\r\nset.seed(123)\r\ncv_lambda_LASSO <- cv.glmnet(\r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 1,\r\n  lambda = exp(seq(-8, 3, 0.2)),\r\n  family = 'poisson'\r\n)\r\nlambda_min_MSE_LASSO <- round(cv_lambda_LASSO$lambda.min, 5)\r\n\r\nplot(cv_lambda_LASSO, main = \"Lambda selection by CV with LASSO\\n\\n\")\r\n\r\n\r\n\r\n\r\nFigure 3: TRUE\r\n\r\n\r\n\r\nShow code\r\n\r\nplot(cv_lambda_LASSO$glmnet.fit, \"lambda\")\r\nabline(v = log(lambda_min_MSE_LASSO), col = \"red\", lwd = 3, lty = 2)\r\n\r\n\r\n\r\n\r\nFigure 4: TRUE\r\n\r\n\r\n\r\n\r\n\r\nShow code\r\n\r\nlambda_min_MSE_LASSO %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nx\r\n\r\n\r\n0.00136\r\n\r\n\r\nThe smallest lambda we found from LASSO is 0.00136.\r\nRidge Model Selection\r\nWe will also be using ridge as a model selection method. Below, we perform ridge and find the smallest lambda for our models.\r\n\r\n\r\nShow code\r\n\r\nset.seed(123)\r\n\r\ncv_lambda_RIDGE <- cv.glmnet(\r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 0,\r\n  lambda = exp(seq(-12, 10, 0.3)),\r\n  family = 'poisson'\r\n)\r\nlambda_min_MSE_RIDGE <- round(cv_lambda_RIDGE$lambda.min, 5)\r\nplot(cv_lambda_RIDGE, main = \"Lambda selection by CV with RIDGE\\n\\n\")\r\n\r\n\r\n\r\n\r\nFigure 5: TRUE\r\n\r\n\r\n\r\nShow code\r\n\r\nplot(cv_lambda_RIDGE$glmnet.fit, \"lambda\")\r\n\r\nabline(v = log(lambda_min_MSE_RIDGE), col = \"red\", lwd = 3, lty = 2)\r\n\r\n\r\n\r\n\r\nFigure 6: TRUE\r\n\r\n\r\n\r\n\r\n\r\nShow code\r\n\r\nlambda_min_MSE_RIDGE\r\n\r\n\r\n[1] 0.00335\r\n\r\nCross-Validation\r\nWe will now be performing cross-validation to test our predictive model. Below, we have a few different models. - model_5CV and model_holdout are the cross-validation with 5 folds and holdout models respectively built using the stepwise covariates found through the variable selection methods. - model_lasso_cv and model_lasso_holdout are the cross validation with 5 fold and holdout models built using lasso for the cross validation and the lambda found from LASSO for the holdout model. - model_ridge_cv and model_ridge_holdout are the cross validation with 5 fold and holdout models built using ridge for the cross validation and the lambda found from ridge for the holdout model. - Lastly, model_elastic is the cross validation done for 5-fold using the elastic method.\r\n\r\n\r\nShow code\r\n\r\nset.seed(123)\r\nlambda <- 10^seq(-3, 3, length = 100)\r\n# define training control\r\ntrain_control <- trainControl(method=\"cv\", number = 5)\r\n\r\n# train the models\r\n#5 fold CV using stepwise covariates\r\nmodel_5CV <- train(Life.expectancy~., data = expectancy_train[,stepwise_selection], \r\n               trControl=train_control, method=\"lm\", preProcess = c(\"center\", \"scale\"))\r\n\r\n#stepwise covariates lm holdout\r\nmodel_holdout <- lm(Life.expectancy~., data = expectancy_train[,stepwise_selection]) \r\n\r\n#lasso with CV\r\nmodel_lasso_cv <- train(Life.expectancy~., data = expectancy_train[,-1], \r\n               trControl=train_control, method=\"glmnet\", preProcess = c(\"center\", \"scale\"),tuneGrid = expand.grid(alpha = 1, lambda = lambda))\r\n\r\n#ridge with CV\r\nmodel_ridge_cv <- train(Life.expectancy~., data = expectancy_train[,-1], \r\n               trControl=train_control, method=\"glmnet\", preProcess = c(\"center\", \"scale\"),tuneGrid = expand.grid(alpha = 0, lambda = lambda))\r\n\r\n#lasso holdout\r\nmodel_lasso_holdout <- glmnet( \r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 1,\r\n  lambda = lambda_min_MSE_LASSO\r\n)\r\n\r\n#ridge holdout\r\nmodel_ridge_holdout <- glmnet( \r\n  x = as.matrix(expectancy_train[,-c(1,2)]), y = as.matrix(expectancy_train[,2]),\r\n  alpha = 0,\r\n  lambda = lambda_min_MSE_RIDGE\r\n)\r\n\r\n#elastic cv\r\nmodel_elastic <- train(\r\n  Life.expectancy ~., data = expectancy_train[,-1], method = \"glmnet\",\r\n  preProcess = c(\"center\", \"scale\"),\r\n  trControl = train_control,\r\n  tuneLength = 10\r\n  )\r\n\r\n\r\n\r\nIn order to test which model is the best, we will be finding the RMSE’s of the models and comparing.\r\n\r\n\r\nShow code\r\n\r\nholdout.prediction <- predict(model_holdout, newdata = expectancy_test[,-2])\r\n\r\nholdout.rmse <- rmse(\r\n    preds = holdout.prediction,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nmodel.5CV.pred <- predict(model_5CV, newdata = expectancy_test[,-2])\r\n\r\nmodel.5CV.rmse <- rmse(\r\n    preds = model.5CV.pred,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nlasso.holdout.pred <- predict(model_lasso_holdout, newx = as.matrix(expectancy_test[,-c(1,2)]))\r\n\r\nlasso.cv.pred <- predict(model_lasso_cv, newx = as.matrix(expectancy_test[,-c(1,2)]))\r\n\r\nridge.holdout.pred <- predict(model_ridge_holdout, newx = as.matrix(expectancy_test[,-c(1,2)]))\r\n\r\nlasso.cv.pred <- predict(model_lasso_cv, model.matrix(Life.expectancy ~., expectancy_test)[,-c(1,2)])\r\nlasso.cv.rmse <- rmse(lasso.cv.pred,expectancy_test$Life.expectancy)\r\n\r\nridge.cv.pred <- predict(model_ridge_cv, model.matrix(Life.expectancy ~., expectancy_test)[,-c(1,2)])\r\nridge.cv.rmse <- rmse(ridge.cv.pred,expectancy_test$Life.expectancy)\r\n\r\nelastic.cv.pred <- predict(model_elastic, model.matrix(Life.expectancy ~., expectancy_test)[,-c(1,2)])\r\nelastic.cv.rmse <- rmse(elastic.cv.pred,expectancy_test$Life.expectancy)\r\n\r\nholdout.lasso.rmse <- rmse(\r\n    preds = lasso.holdout.pred,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nholdout.ridge.rmse <- rmse(\r\n    preds = ridge.holdout.pred,\r\n    actuals = expectancy_test$Life.expectancy)\r\n\r\nRMSE <- tibble(\r\n    Method = \"LM Hold-out\",\r\n    RMSE = holdout.rmse)\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"5 fold LM CV\",\r\n               RMSE = model.5CV.rmse))\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"LASSO CV\",\r\n               RMSE = lasso.cv.rmse))\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"RIDGE CV\",\r\n               RMSE = ridge.cv.rmse))\r\n\r\nRMSE <- rbind(RMSE,tibble(\r\n               Method = \"Elastic CV\",\r\n               RMSE = elastic.cv.rmse))\r\n\r\nRMSE <- rbind(RMSE, tibble(\r\n               Method = \"LASSO Hold-out\",\r\n               RMSE = holdout.lasso.rmse))\r\n\r\nRMSE <- rbind(RMSE, tibble(\r\n               Method = \"RIDGE Hold-out\",\r\n               RMSE = holdout.ridge.rmse))\r\nRMSE  %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\nMethod\r\n\r\n\r\nRMSE\r\n\r\n\r\nLM Hold-out\r\n\r\n\r\n3.919471\r\n\r\n\r\n5 fold LM CV\r\n\r\n\r\n3.919471\r\n\r\n\r\nLASSO CV\r\n\r\n\r\n3.664512\r\n\r\n\r\nRIDGE CV\r\n\r\n\r\n3.720795\r\n\r\n\r\nElastic CV\r\n\r\n\r\n3.663028\r\n\r\n\r\nLASSO Hold-out\r\n\r\n\r\n3.667097\r\n\r\n\r\nRIDGE Hold-out\r\n\r\n\r\n3.663632\r\n\r\n\r\nWe can see that the model with the lowest RMSE is the elastic model with an RMSE of 3.663029. The coefficients for this model can be found below.\r\n\r\n\r\nShow code\r\n\r\ncoef(model_elastic$finalModel, model_elastic$bestTune$lambda) \r\n\r\n\r\n19 x 1 sparse Matrix of class \"dgCMatrix\"\r\n                                          s1\r\n(Intercept)                      69.10258900\r\nAdult.Mortality                  -2.30326426\r\ninfant.deaths                    10.27596986\r\nAlcohol                          -0.28613317\r\npercentage.expenditure            0.62442166\r\nHepatitis.B                      -0.06411130\r\nMeasles                          -0.04012417\r\nBMI                               0.66222164\r\nunder.five.deaths               -10.55426961\r\nPolio                             0.27901943\r\nTotal.expenditure                 0.14502042\r\nDiphtheria                        0.18339641\r\nHIV.AIDS                         -2.68744580\r\nGDP                               0.19137946\r\nPopulation                        0.02274985\r\nthinness..1.19.years             -0.02926623\r\nthinness.5.9.years               -0.24398017\r\nIncome.composition.of.resources   1.74121425\r\nSchooling                         2.42970613\r\n\r\n\r\n\r\nShow code\r\n\r\nmodel_elastic$bestTune %>% kbl() %>% \r\n  kable_paper(\"hover\", full_width=0)\r\n\r\n\r\n\r\n\r\n\r\nalpha\r\n\r\n\r\nlambda\r\n\r\n\r\n11\r\n\r\n\r\n0.2\r\n\r\n\r\n0.0029358\r\n\r\n\r\nThis model is a convex combination of Ridge and LASSO. The equation to understand the alpha for this elastic model is \\(\\alpha \\times LASSO + (1-\\alpha) \\times RIDGE\\), which combines the L1 and L2 norms.\r\n\r\n\r\nShow code\r\n\r\nggplot(varImp(model_elastic)) + ggtitle(\"Most important variables from elastic CV\") + labs(caption = \"Figure 10\") \r\n\r\n\r\n\r\n\r\nObservations\r\nThe most important variables we get from this are under five deaths, infant deaths, HIV/AIDS, Adult mortality, Income composition of variables, BMI and percentage expenditure.\r\nPopulation, thinness, Measles, Hepatitis B and total expenditure are less important.\r\nAlcohol and Polio are right in the middle of the variable importance graph.\r\nDiscussion\r\nResults and impacts\r\nIn our study we used variable selection methods (both forward and backward) to find that the best model is the one with 12 covariates. From there, we used those covariates to create cross-validation models with 5-fold and holdout models. Additionally, we performed LASSO and ridge and created 5-fold cross validation and hold-out models for the two. The last type of model we did was an elastic cross-validation model. We discovered by comparing RMSE that the best model is the elastic cross-validation, and thus found the coefficients for the specific model. Our findings help us see the best model in predicting life expectancy, thus also allowing us to see which factors affect life expectancy the most. Our analysis showed us that Under-five deaths, infant deaths, HIV/AIDS, Adult Mortality, Schooling and income composition of resources are the factors that affect life expectancy the most.\r\nAre the results what we expected?\r\nIt is unsurprising that a disease such as HIV/AIDS affect life expectancy. One could question why Measles was not equally as important, but a reason for this could be that there is a vaccine which is quite widespread, and so the disease is not as impactful anymore.\r\nSimilarly, infant deaths, under five deaths and adult mortality being the most important are also what we expected, as they directly involve life expectancy.\r\nOur variable selection methods suggest that Alcohol is an important aspect of our model, but the Important variables for our best model seem to suggest otherwise. We would expect Alcohol to be higher up on the important variables graph.\r\nImprovements that could be made\r\nThis study only takes into account additive models, and so, we are not able to explore the relationship between variables in the model. While we showed that the \\(C_p\\) is much higher with interactions, our model could be improved using interactions, so there is further room for improvement here.\r\nFuture questions/research\r\nOur results with this study hae allowed us to see the factors affecting life expectancy and the best way to predict life expectancy in any random country. In the future, this study could lead to questions about: - How can governments help in increasing life expectancy and what areas should they be focusing on specifically? - The data in this study predates Covid-19. How much does Covid-19 affect life expectancy and how much would it change our model? - As mentioned above, the data in this study is from 2000 - 2015. There have been multiple advancements in the medical field since then. Further, 15 years is also a long period of time. It would be interesting to explore how for different and shorter periods of time how life expectancy changes and how its changed over time.\r\nReferences\r\n\\(^{(1)}\\) World Health Organisation (WHO). (2018, February 10). Life expectancy (WHO). Kaggle. Retrieved November 6, 2021, from https://www.kaggle.com/kumarajarshi/life-expectancy-who.\r\n\\(^{(2)}\\) Tier 1-life expectancy and wellbeing-1.19 life expectancy at birth. Department of Health | Tier 1-Life expectancy and wellbeing-1.19 Life expectancy at birth. (n.d.). Retrieved November 6, 2021, from https://www1.health.gov.au/internet/publications/publishing.nsf/Content/oatsih-hpf-2012-toc~tier1~life-exp-wellb~119.\r\nNational Progress Report 2025 Goal: Reduce HBV Deaths. (2021, June 03). Retrieved from https://www.cdc.gov/hepatitis/policy/NPR/2021/NationalProgressReport-HepB-ReduceDeaths.htm\r\nClinical Features of Diphtheria. (2020, May 26). Retrieved from https://www.cdc.gov/diphtheria/clinicians.html\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-12-17-life-expectancy-analysis/life-expectancy-analysis_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2021-12-19T00:12:15-08:00",
    "input_file": "life-expectancy-analysis.knit.md"
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to My New Blog",
    "description": "Welcome to our new blog, My New Blog. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Nora Jones",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-12-17",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-12-17T12:25:46-08:00",
    "input_file": {}
  }
]
